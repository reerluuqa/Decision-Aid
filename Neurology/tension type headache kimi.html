<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Tension-Type Headache Algorithm - BMJ Best Practice</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            transition: all 0.3s ease;
        }

        body.dark-mode {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: #e0e0e0;
        }

        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            min-height: 100vh;
            padding: 20px;
        }

        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-right: 20px;
            position: sticky;
            top: 20px;
            height: fit-content;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        body.dark-mode .sidebar {
            background: rgba(30, 30, 40, 0.95);
            color: #e0e0e0;
        }

        .sidebar h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .progress-item {
            padding: 12px 15px;
            margin: 8px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
        }

        .progress-item:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateX(5px);
        }

        .progress-item.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .progress-item i {
            width: 20px;
            text-align: center;
        }

        .main-content {
            flex: 1;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            backdrop-filter: blur(10px);
        }

        body.dark-mode .header {
            background: rgba(30, 30, 40, 0.95);
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        body.dark-mode .header p {
            color: #aaa;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            margin-bottom: 30px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        body.dark-mode .card {
            background: rgba(30, 30, 40, 0.95);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .assessment-card .card-header {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }

        .diagnosis-card .card-header {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
        }

        .treatment-card .card-header {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
        }

        .followup-card .card-header {
            background: linear-gradient(45deg, #e67e22, #d35400);
        }

        .card-header {
            padding: 20px 25px;
            color: white;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .card-header i {
            font-size: 1.8em;
            width: 40px;
            text-align: center;
        }

        .card-header h2 {
            font-size: 1.5em;
            font-weight: 600;
        }

        .expand-icon {
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }

        .card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .card-content.expanded {
            max-height: 3000px;
        }

        .card-body {
            padding: 25px;
        }

        .subsection {
            margin-bottom: 25px;
            border-left: 4px solid #e0e0e0;
            padding-left: 20px;
        }

        .subsection h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        body.dark-mode .subsection h3 {
            color: #a8b2ff;
        }

        .subsection h3 i {
            color: #667eea;
        }

        body.dark-mode .subsection h3 i {
            color: #a8b2ff;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-item {
            background: rgba(102, 126, 234, 0.05);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        body.dark-mode .info-item {
            background: rgba(160, 170, 255, 0.1);
        }

        .info-item h4 {
            color: #667eea;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        body.dark-mode .info-item h4 {
            color: #a8b2ff;
        }

        .info-item p {
            font-size: 0.95em;
            line-height: 1.5;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin-left: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .badge-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
        }

        .badge-warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
        }

        .badge-success {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            color: white;
        }

        .badge-info {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }

        .treatment-algorithm {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }

        .treatment-step {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(46, 204, 113, 0.1);
            border-radius: 10px;
            border-left: 5px solid #2ecc71;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #2ecc71;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .criteria-list {
            background: rgba(155, 89, 182, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        body.dark-mode .criteria-list {
            background: rgba(180, 150, 220, 0.1);
        }

        .criteria-list h4 {
            color: #9b59b6;
            margin-bottom: 15px;
        }

        body.dark-mode .criteria-list h4 {
            color: #c9b3e0;
        }

        .criteria-list ul {
            list-style: none;
            padding-left: 0;
        }

        .criteria-list li {
            padding: 8px 0;
            padding-left: 30px;
            position: relative;
        }

        .criteria-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #2ecc71;
            font-weight: bold;
            font-size: 1.2em;
        }

        .red-flags {
            background: rgba(231, 76, 60, 0.1);
            border-left: 5px solid #e74c3c;
            padding: 20px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .red-flags h4 {
            color: #e74c3c;
            margin-bottom: 10px;
        }

        .red-flags ul {
            list-style: none;
            padding-left: 0;
        }

        .red-flags li {
            padding: 5px 0;
            padding-left: 25px;
            position: relative;
        }

        .red-flags li:before {
            content: "⚠️";
            position: absolute;
            left: 0;
        }

        .medication-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        body.dark-mode .medication-table {
            background: #2a2a2a;
        }

        .medication-table th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
        }

        .medication-table td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }

        body.dark-mode .medication-table td {
            border-bottom: 1px solid #444;
        }

        .medication-table tr:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        body.dark-mode .medication-table tr:hover {
            background: rgba(160, 170, 255, 0.1);
        }

        .toolbar {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: flex;
            gap: 10px;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        body.dark-mode .toolbar {
            background: rgba(30, 30, 40, 0.95);
        }

        .toolbar button {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toolbar button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .search-box {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
            z-index: 1001;
            width: 300px;
            backdrop-filter: blur(10px);
        }

        body.dark-mode .search-box {
            background: rgba(30, 30, 40, 0.95);
        }

        .search-box input {
            width: 100%;
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 5px;
        }

        .highlight {
            background: yellow;
            color: black;
            padding: 2px 4px;
            border-radius: 3px;
        }

        body.dark-mode .highlight {
            background: #ffeb3b;
            color: #333;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                padding: 10px;
            }
            
            .sidebar {
                width: 100%;
                position: relative;
                top: 0;
                margin-bottom: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .toolbar {
                position: relative;
                top: 0;
                right: 0;
                margin-bottom: 20px;
                justify-content: center;
            }
            
            .search-box {
                position: relative;
                top: 0;
                right: 0;
                width: 100%;
                margin-bottom: 20px;
            }
            
            .progress-item {
                padding: 10px;
            }
        }

        body.print-mode {
            background: white !important;
        }

        body.print-mode .card {
            background: white !important;
            box-shadow: none !important;
            border: 1px solid #ddd !important;
            page-break-inside: avoid;
        }

        body.print-mode .card-content {
            max-height: none !important;
        }

        body.print-mode .card-header {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        body.print-mode .toolbar,
        body.print-mode .sidebar,
        body.print-mode .search-box {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="toolbar">
        <button onclick="toggleTheme()" title="Toggle Dark Mode">
            <i class="fas fa-moon"></i> Theme
        </button>
        <button onclick="toggleSearch()" title="Search">
            <i class="fas fa-search"></i> Search
        </button>
        <button onclick="window.print()" title="Print">
            <i class="fas fa-print"></i> Print
        </button>
        <button onclick="expandAll()" title="Expand All">
            <i class="fas fa-expand"></i> All
        </button>
        <button onclick="collapseAll()" title="Collapse All">
            <i class="fas fa-compress"></i> None
        </button>
    </div>

    <div class="search-box" id="searchBox">
        <input onkeyup="searchContent(this.value)" placeholder="Search algorithm..." type="text"/>
    </div>

    <div class="container">
        <aside class="sidebar">
            <h2><i class="fas fa-route"></i> Algorithm Progress</h2>
            <div class="progress-item active" onclick="scrollToSection('assessment')">
                <i class="fas fa-stethoscope"></i> Assessment
            </div>
            <div class="progress-item" onclick="scrollToSection('diagnosis')">
                <i class="fas fa-search"></i> Diagnosis
            </div>
            <div class="progress-item" onclick="scrollToSection('treatment')">
                <i class="fas fa-pills"></i> Treatment
            </div>
            <div class="progress-item" onclick="scrollToSection('followup')">
                <i class="fas fa-calendar-check"></i> Follow-up
            </div>
        </aside>

        <main class="main-content">
            <div class="header">
                <h1>Tension-Type Headache Management</h1>
                <p>Interactive Clinical Decision Support Algorithm - BMJ Best Practice (April 2025)</p>
            </div>

            <!-- Assessment Card -->
            <div class="card assessment-card" data-section="assessment">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-header-content">
                        <i class="fas fa-stethoscope"></i>
                        <h2>Assessment</h2>
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-body">
                        <div class="subsection">
                            <h3><i class="fas fa-clipboard-list"></i> History Taking</h3>
                            <div class="info-grid">
                                <div class="info-item">
                                    <h4>Headache Characteristics</h4>
                                    <p>Bilateral, non-pulsatile, pressure-like pain (mild-moderate). Dull, "tight band" sensation. Not aggravated by routine physical activity.</p>
                                </div>
                                <div class="info-item">
                                    <h4>Associated Symptoms</h4>
                                    <p>Pericranial tenderness common. <strong>No</strong> significant nausea/vomiting. Max 1 of: photophobia, phonophobia, mild nausea.</p>
                                </div>
                                <div class="info-item">
                                    <h4>Frequency Pattern</h4>
                                    <p>Episodic (&lt;15 days/month) or Chronic (≥15 days/month). Worsens as day progresses.</p>
                                </div>
                                <div class="info-item">
                                    <h4>Common Triggers</h4>
                                    <p>Stress/mental tension, missed meals, lack of sleep, fatigue, dehydration, poor posture, eye strain.</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-user-md"></i> Physical Examination</h3>
                            <div class="info-grid">
                                <div class="info-item">
                                    <h4>Neurological Exam</h4>
                                    <p><strong>Must be normal</strong> in TTH. Abnormal findings require investigation for secondary causes.</p>
                                    <span class="badge badge-danger">Critical</span>
                                </div>
                                <div class="info-item">
                                    <h4>Pericranial Tenderness</h4>
                                    <p>Common but not essential. Check: sternocleidomastoid, trapezius, temporalis, masseter, lateral pterygoid.</p>
                                </div>
                                <div class="info-item">
                                    <h4>Vital Signs</h4>
                                    <p>Check BP. Hypertension can cause headache. Consider fundoscopy for papilledema.</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-exclamation-triangle"></i> Red Flags <span class="badge badge-danger">Urgent Referral</span></h3>
                            <div class="red-flags">
                                <h4>Features Suggesting Secondary Headache:</h4>
                                <ul>
                                    <li>Thunderclap onset (worst headache of life)</li>
                                    <li>New focal neurological deficits</li>
                                    <li>Altered consciousness or confusion</li>
                                    <li>Papilledema on fundoscopy</li>
                                    <li>Fever with neck stiffness</li>
                                    <li>New headache after age 50 years</li>
                                    <li>Headache with exertion/sexual activity</li>
                                    <li>Progressively worsening pattern</li>
                                    <li>History of cancer, immunosuppression, or recent head trauma</li>
                                    <li>Pregnancy/postpartum with severe headache</li>
                                    <li>Potential carbon monoxide exposure</li>
                                </ul>
                            </div>
                            <p><strong>Action:</strong> Immediate emergency referral and neuroimaging if any red flags present.</p>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-shield-alt"></i> Risk Factors</h3>
                            <div class="info-grid">
                                <div class="info-item">
                                    <h4>Strong Risk Factors</h4>
                                    <p>• Mental tension/stress <span class="badge badge-warning">Common</span><br/>
                                    • Missing meals<br/>
                                    • Fatigue/lack of sleep<br/>
                                    • Analgesic overuse <span class="badge badge-danger">Medication Overuse</span></p>
                                </div>
                                <div class="info-item">
                                    <h4>Demographics</h4>
                                    <p>• Female sex (1.2:1 ratio)<br/>
                                    • Age 20-39 years (peak prevalence)<br/>
                                    • Lower socioeconomic status (chronic TTH)</p>
                                </div>
                                <div class="info-item">
                                    <h4>Comorbidities</h4>
                                    <p>• Anxiety and depression <span class="badge badge-warning">Common</span><br/>
                                    • Sleep disorders (insomnia, sleep apnea)<br/>
                                    • Somatization disorders</p>
                                </div>
                                <div class="info-item">
                                    <h4>Genetic Factors</h4>
                                    <p>• First-degree relatives of chronic TTH patients have 2.1-3.9x increased risk<br/>
                                    • Shared predisposition with migraine</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-book"></i> Headache Diary</h3>
                            <p><strong>Essential for diagnosis and monitoring:</strong></p>
                            <ul style="margin-left: 20px; line-height: 1.6;">
                                <li>Date and time of each headache</li>
                                <li>Duration and intensity (0-10 scale)</li>
                                <li>Pain characteristics (location, quality)</li>
                                <li>Associated symptoms</li>
                                <li>Possible triggers</li>
                                <li>Medication taken and response</li>
                                <li>Impact on daily activities</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Diagnosis Card -->
            <div class="card diagnosis-card" data-section="diagnosis">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-header-content">
                        <i class="fas fa-search"></i>
                        <h2>Diagnosis</h2>
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-body">
                        <div class="subsection">
                            <h3><i class="fas fa-layer-group"></i> ICHD-3 Classification <span class="badge badge-info">Key</span></h3>
                            
                            <div class="criteria-list">
                                <h4>Core Diagnostic Criteria (All Types):</h4>
                                <ul>
                                    <li>At least 2 of: bilateral location, pressing/tightening quality, mild-moderate intensity, NOT aggravated by routine activity</li>
                                    <li>Both of: no nausea/vomiting, ≤1 of photophobia/phonophobia</li>
                                    <li>Not better accounted for by another diagnosis</li>
                                </ul>
                            </div>

                            <div class="info-grid">
                                <div class="info-item">
                                    <h4>2.1 Infrequent Episodic TTH <span class="badge badge-success">Stable</span></h4>
                                    <p><strong>Frequency:</strong> &lt;1 day/month (&lt;12 days/year)<br/>
                                    <strong>Duration:</strong> 30 minutes to 7 days<br/>
                                    <strong>Treatment:</strong> Usually self-managed</p>
                                </div>
                                <div class="info-item">
                                    <h4>2.2 Frequent Episodic TTH <span class="badge badge-warning">Caution</span></h4>
                                    <p><strong>Frequency:</strong> 1-14 days/month (≥12 and &lt;180 days/year)<br/>
                                    <strong>Duration:</strong> 30 minutes to 7 days<br/>
                                    <strong>Risk:</strong> May progress to chronic form</p>
                                </div>
                                <div class="info-item">
                                    <h4>2.3 Chronic TTH <span class="badge badge-warning">High Burden</span></h4>
                                    <p><strong>Frequency:</strong> ≥15 days/month (≥180 days/year)<br/>
                                    <strong>Duration:</strong> Hours to days or continuous<br/>
                                    <strong>Impact:</strong> Significant disability</p>
                                </div>
                                <div class="info-item">
                                    <h4>Subtypes <span class="badge badge-info">Exam</span></h4>
                                    <p>• Associated with pericranial tenderness<br/>
                                    • Not associated with pericranial tenderness<br/>
                                    • Presence of tenderness is NOT essential for diagnosis</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-not-equal"></i> Differential Diagnosis</h3>
                            
                            <div class="red-flags">
                                <h4>Migraine vs TTH</h4>
                                <p><strong>Migraine features:</strong> Unilateral, pulsating, moderate-severe intensity, aggravated by activity, nausea/vomiting, photophobia + phonophobia (both)</p>
                                <p><strong>TTH features:</strong> Bilateral, non-pulsatile, mild-moderate, NOT aggravated, no nausea, max 1 of photophobia/phonophobia</p>
                                <p><strong>Note:</strong> Up to 32% of migraine misdiagnosed as TTH. Patients can have both conditions.</p>
                            </div>

                            <div class="info-grid">
                                <div class="info-item">
                                    <h4>Medication Overuse Headache <span class="badge badge-danger">Common</span></h4>
                                    <p>Use of analgesics ≥15 days/month (simple) or ≥10 days/month (combinations) with worsening headache pattern.</p>
                                </div>
                                <div class="info-item">
                                    <h4>Giant Cell Arteritis</h4>
                                    <p>Age &gt;50, new headache, scalp tenderness, jaw claudication. Check ESR/CRP.</p>
                                </div>
                                <div class="info-item">
                                    <h4>Temporomandibular Disorder</h4>
                                    <p>Pain with jaw movement, clicking, bruxism, limited mouth opening.</p>
                                </div>
                                <div class="info-item">
                                    <h4>Sinusitis</h4>
                                    <p>Vertex/frontal pressure, nasal symptoms. CT sinus if refractory.</p>
                                </div>
                                <div class="info-item">
                                    <h4>Intracranial Pathology</h4>
                                    <p>Tumor, subdural hematoma, IIH, infection. Requires neuroimaging if red flags.</p>
                                </div>
                                <div class="info-item">
                                    <h4>Sleep Apnea</h4>
                                    <p>Morning headaches, daytime sleepiness, snoring. Polysomnography if suspected.</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-vial"></i> Investigations <span class="badge badge-info">Selective</span></h3>
                            <p><strong>Do NOT routinely test all TTH patients:</strong></p>
                            <div class="info-grid">
                                <div class="info-item">
                                    <h4>First-line <span class="badge badge-success">Clinical</span></h4>
                                    <p>Thorough history and examination. Headache diary. No labs/imaging needed for typical episodic TTH.</p>
                                </div>
                                <div class="info-item">
                                    <h4>Consider if Red Flags/Refractory</h4>
                                    <p>• MRI brain (tumor, bleed, IIH)<br/>
                                    • CT sinus (sphenoid sinusitis)<br/>
                                    • Lumbar puncture (infection, IIH)<br/>
                                    • Polysomnography (sleep apnea)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Treatment Card -->
            <div class="card treatment-card" data-section="treatment">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-header-content">
                        <i class="fas fa-pills"></i>
                        <h2>Treatment</h2>
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-body">
                        <div class="subsection">
                            <h3><i class="fas fa-bolt"></i> Acute Attack Treatment</h3>
                            
                            <div class="treatment-algorithm">
                                <div class="treatment-step">
                                    <div class="step-number">1</div>
                                    <div>
                                        <h4>Simple Analgesics <span class="badge badge-success">First-line</span></h4>
                                        <table class="medication-table">
                                            <thead>
                                                <tr>
                                                    <th>Medication</th>
                                                    <th>Dose</th>
                                                    <th>Max Daily</th>
                                                    <th>Notes</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Paracetamol</td>
                                                    <td>500-1000 mg PO/PR q4-6h PRN</td>
                                                    <td>4000 mg</td>
                                                    <td>First-line in pregnancy<span class="badge badge-warning">Pregnancy</span></td>
                                                </tr>
                                                <tr>
                                                    <td>Ibuprofen</td>
                                                    <td>400-800 mg PO q4-6h PRN</td>
                                                    <td>2400 mg</td>
                                                    <td>Avoid 3rd trimester<span class="badge badge-danger">Pregnancy</span></td>
                                                </tr>
                                                <tr>
                                                    <td>Naproxen</td>
                                                    <td>250-500 mg PO BID PRN</td>
                                                    <td>1250 mg</td>
                                                    <td>Compatible with breastfeeding</td>
                                                </tr>
                                                <tr>
                                                    <td>Aspirin</td>
                                                    <td>300-900 mg PO q4-6h PRN</td>
                                                    <td>4000 mg</td>
                                                    <td>Avoid in children/pregnancy</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p><strong>Key Points:</strong> Treat early at onset. Use adequate dose. Limit to ≤2 days/week to prevent overuse.</p>
                                    </div>
                                </div>

                                <div class="treatment-step">
                                    <div class="step-number">2</div>
                                    <div>
                                        <h4>Combination Analgesics <span class="badge badge-warning">Second-line</span></h4>
                                        <p>Caffeine combinations (e.g., paracetamol + caffeine) can improve efficacy. <strong>Caution:</strong> Risk of medication-overuse headache with frequent use.</p>
                                        <p><span class="badge badge-danger">Avoid</span> Combinations with codeine or barbiturates (high overuse risk)</p>
                                    </div>
                                </div>

                                <div class="treatment-step">
                                    <div class="step-number">3</div>
                                    <div>
                                        <h4>What NOT to Use <span class="badge badge-danger">Never</span></h4>
                                        <p><strong>Opioids</strong> are never recommended for TTH. If needed, reconsider diagnosis (likely migraine or secondary headache).</p>
                                    </div>
                                </div>
                            </div>

                            <div class="info-item" style="margin-top: 20px;">
                                <h4>Pregnancy &amp; Breastfeeding</h4>
                                <p>• <strong>First-line:</strong> Non-pharmacological<br/>
                                • <strong>Second-line:</strong> Paracetamol (lowest effective dose, shortest duration)<br/>
                                • <strong>Avoid:</strong> NSAIDs (especially 3rd trimester, avoid ≥20 weeks), aspirin, opioids, barbiturates<br/>
                                • <strong>Preferred NSAID if needed:</strong> Ibuprofen (short half-life, low milk excretion)</p>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-shield-alt"></i> Preventive Treatment <span class="badge badge-warning">Consider if &gt;7-9 headache days/month</span></h3>
                            
                            <div class="treatment-algorithm">
                                <div class="treatment-step">
                                    <div class="step-number">1</div>
                                    <div>
                                        <h4>Tricyclic Antidepressants <span class="badge badge-success">First-line</span></h4>
                                        <p><strong>Amitriptyline:</strong> 10 mg PO QHS initially, increase by 10 mg/day weekly, max 100 mg/day</p>
                                        <p><strong>Doxepin:</strong> Alternative if amitriptyline not tolerated</p>
                                        <p><strong>Notes:</strong> Start low, go slow. Doses lower than for depression but analgesic effect is dose-dependent.</p>
                                    </div>
                                </div>

                                <div class="treatment-step">
                                    <div class="step-number">2</div>
                                    <div>
                                        <h4>Other Antidepressants <span class="badge badge-warning">Second-line</span></h4>
                                        <p><strong>Venlafaxine:</strong> 75 mg/day (divided), max 150 mg/day <span class="badge badge-danger">Avoid pregnancy</span></p>
                                        <p><strong>Mirtazapine:</strong> 15-30 mg/day QHS <span class="badge badge-danger">Category C pregnancy</span></p>
                                        <p><strong>SSRIs:</strong> Little evidence for effectiveness</p>
                                    </div>
                                </div>

                                <div class="treatment-step">
                                    <div class="step-number">3</div>
                                    <div>
                                        <h4>Muscle Relaxants <span class="badge badge-warning">Third-line</span></h4>
                                        <p><strong>Tizanidine:</strong> 4 mg PO q6-8h initially, titrate, max 18 mg/day</p>
                                        <p>Use 3-6 months then discontinue. Reassess need.</p>
                                    </div>
                                </div>

                                <div class="treatment-step">
                                    <div class="step-number">+</div>
                                    <div>
                                        <h4>Trigger Point Injections <span class="badge badge-info">Adjunct</span></h4>
                                        <p>Local anesthetic injections at pericranial myofascial trigger points may reduce painful days in chronic TTH.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="info-item" style="margin-top: 20px;">
                                <h4>Duration &amp; Monitoring</h4>
                                <p>• Optimal length not established<br/>
                                • Review every 6 months<br/>
                                • If excellent response (50-75% reduction), consider pausing after 3-6 months<br/>
                                • Consider comorbidities, patient preferences, lifestyle</p>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-leaf"></i> Non-Pharmacological Therapies <span class="badge badge-success">Evidence-based</span></h3>
                            
                            <div class="info-grid">
                                <div class="info-item">
                                    <h4><i class="fas fa-lightbulb"></i> Trigger Identification</h4>
                                    <p>Encourage headache diary to identify and avoid triggers: stress, irregular meals, caffeine withdrawal, dehydration, sleep issues, poor posture.</p>
                                </div>
                                <div class="info-item">
                                    <h4><i class="fas fa-brain"></i> Behavioral Therapies</h4>
                                    <p>• <strong>Relaxation training:</strong> Evidence for TTH reduction<br/>
                                    • <strong>EMG biofeedback:</strong> Effective<br/>
                                    • <strong>CBT:</strong> Shown to reduce TTH<br/>
                                    • <strong>Brief mindfulness:</strong> May help chronic TTH</p>
                                </div>
                                <div class="info-item">
                                    <h4><i class="fas fa-spa"></i> Physical Measures</h4>
                                    <p>• <strong>Physiotherapy:</strong> Weak evidence<br/>
                                    • <strong>Acupuncture:</strong> Safe in pregnancy, mixed evidence<br/>
                                    • <strong>Spinal manipulation:</strong> Weak evidence<br/>
                                    • <strong>Massage:</strong> Trigger point-focused may help</p>
                                </div>
                                <div class="info-item">
                                    <h4><i class="fas fa-heart"></i> Lifestyle Measures</h4>
                                    <p>• Regular sleep schedule<br/>
                                    • Adequate hydration<br/>
                                    • Stress management techniques<br/>
                                    • Regular exercise<br/>
                                    • Ergonomic workstation</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-exclamation-circle"></i> Treatment Failure</h3>
                            <div class="red-flags">
                                <p><strong>If standard treatments fail, reconsider diagnosis:</strong></p>
                                <ul>
                                    <li>Is it actually migraine? (more severe, disabling attacks)</li>
                                    <li>Is there medication overuse? (need withdrawal)</li>
                                    <li>Are there untreated comorbidities? (depression, anxiety, sleep disorder)</li>
                                    <li>Are there missed red flags? (secondary causes)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Follow-up Card -->
            <div class="card followup-card" data-section="followup">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-header-content">
                        <i class="fas fa-calendar-check"></i>
                        <h2>Follow-up</h2>
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-body">
                        <div class="subsection">
                            <h3><i class="fas fa-chart-line"></i> Monitoring</h3>
                            
                            <div class="info-grid">
                                <div class="info-item">
                                    <h4>Follow-up Schedule</h4>
                                    <p>• Every few months for active patients<br/>
                                    • Review: attack frequency, medication use, response, side effects<br/>
                                    • Encourage continued headache diary<br/>
                                    • Assess quality of life and disability</p>
                                </div>
                                <div class="info-item">
                                    <h4>Treatment Review</h4>
                                    <p>• Preventive treatment: review need every 6 months<br/>
                                    • Consider tapering/discontinuing if stable<br/>
                                    • Watch for medication overuse (≤2 days/week acute meds)</p>
                                </div>
                                <div class="info-item">
                                    <h4>Monitoring for Complications</h4>
                                    <p>• NSAID-related GI ulcer/bleeding<br/>
                                    • Renal dysfunction<br/>
                                    • Hepatotoxicity<br/>
                                    • Hypertension<br/>
                                    • Cardiovascular events<br/>
                                    • Paracetamol-related liver damage</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-user-friends"></i> Patient Education</h3>
                            
                            <div class="criteria-list">
                                <h4>Key Messages:</h4>
                                <ul>
                                    <li>TTH is the most common headache type and is usually benign</li>
                                    <li>Take analgesics early in attack at adequate dose</li>
                                    <li>Limit acute medication to ≤2 days/week</li>
                                    <li>Keep regular sleep, meals, hydration, and exercise</li>
                                    <li>Practice stress management techniques</li>
                                    <li>Maintain headache diary</li>
                                    <li>Return if: new red flag symptoms, increasing frequency, treatment not working</li>
                                    <li>Chronic TTH: preventive treatment may be needed, requires patience</li>
                                </ul>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-prognosis"></i> Prognosis</h3>
                            
                            <div class="info-grid">
                                <div class="info-item">
                                    <h4>Episodic TTH <span class="badge badge-success">Good</span></h4>
                                    <p>• Most common type, peaks age 20-39 then declines<br/>
                                    • Usually responds well to simple analgesics<br/>
                                    • Self-limited, rarely disabling<br/>
                                    • May remit or improve with age</p>
                                </div>
                                <div class="info-item">
                                    <h4>Chronic TTH <span class="badge badge-warning">Variable</span></h4>
                                    <p>• Major impact on quality of life<br/>
                                    • Generalized impairment in functioning<br/>
                                    • High comorbidity with anxiety/depression<br/>
                                    • Requires long-term management<br/>
                                    • May improve with preventive treatment</p>
                                </div>
                                <div class="info-item">
                                    <h4>Poor Prognostic Factors</h4>
                                    <p>• Depression/anxiety<br/>
                                    • Poor sleep<br/>
                                    • Stress<br/>
                                    • Medication overuse<br/>
                                    • Poor self-efficacy</p>
                                </div>
                                <div class="info-item">
                                    <h4>Transformation to Chronic</h4>
                                    <p>• Risk increased by: frequent analgesic use, stress, poor sleep, mood disorders<br/>
                                    • Prevention: rational analgesic use, treat comorbidities, lifestyle management</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-hands-helping"></i> Specialist Referral</h3>
                            <div class="red-flags">
                                <p><strong>Consider referral to headache specialist if:</strong></p>
                                <ul>
                                    <li>Diagnostic uncertainty</li>
                                    <li>Failed multiple preventive treatments</li>
                                    <li>Significant medication overuse requiring supervised withdrawal</li>
                                    <li>Severe disability despite treatment</li>
                                    <li>Complex comorbidities (severe depression, anxiety)</li>
                                    <li>Need for procedures (trigger point injections, etc.)</li>
                                    <li>Pregnancy with difficult-to-manage headache</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="header" style="margin-top: 20px; font-size: 0.9em;">
                <p><strong>Disclaimer:</strong> This algorithm is based on BMJ Best Practice guidelines (April 2025) and NICE recommendations. It is intended as a clinical decision support tool for healthcare professionals. Always use clinical judgment and consider individual patient circumstances. Verify drug doses with local formularies. Not a substitute for specialist consultation when needed.</p>
                <p style="margin-top: 10px; font-style: italic;">
                    <i class="fas fa-info-circle"></i> <strong>Red Badge:</strong> Urgent referral required | 
                    <i class="fas fa-exclamation-triangle"></i> <strong>Amber Badge:</strong> Caution/monitor closely | 
                    <i class="fas fa-check-circle"></i> <strong>Green Badge:</strong> Stable/manageable
                </p>
            </div>
        </main>
    </div>

    <script>
        // Theme management
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        }

        // Load saved theme
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
        }

        // Card toggle functionality
        function toggleCard(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('.expand-icon');
            
            content.classList.toggle('expanded');
            icon.style.transform = content.classList.contains('expanded') ? 'rotate(180deg)' : 'rotate(0deg)';
        }

        // Expand/collapse all
        function expandAll() {
            document.querySelectorAll('.card-content').forEach(content => {
                content.classList.add('expanded');
            });
            document.querySelectorAll('.expand-icon').forEach(icon => {
                icon.style.transform = 'rotate(180deg)';
            });
        }

        function collapseAll() {
            document.querySelectorAll('.card-content').forEach(content => {
                content.classList.remove('expanded');
            });
            document.querySelectorAll('.expand-icon').forEach(icon => {
                icon.style.transform = 'rotate(0deg)';
            });
        }

        // Search functionality
        function toggleSearch() {
            const searchBox = document.getElementById('searchBox');
            searchBox.style.display = searchBox.style.display === 'block' ? 'none' : 'block';
            if (searchBox.style.display === 'block') {
                searchBox.querySelector('input').focus();
            }
        }

        function searchContent(searchTerm) {
            if (!searchTerm) {
                // Clear highlights
                document.querySelectorAll('.highlight').forEach(el => {
                    el.outerHTML = el.innerHTML;
                });
                return;
            }

            // Clear previous highlights
            document.querySelectorAll('.highlight').forEach(el => {
                el.outerHTML = el.innerHTML;
            });

            // Highlight new matches
            const walker = document.createTreeWalker(
                document.body,
                NodeFilter.SHOW_TEXT,
                null,
                false
            );

            const textNodes = [];
            let node;
            while (node = walker.nextNode()) {
                if (node.parentNode.tagName !== 'SCRIPT' && 
                    node.parentNode.tagName !== 'STYLE' &&
                    node.textContent.toLowerCase().includes(searchTerm.toLowerCase())) {
                    textNodes.push(node);
                }
            }

            textNodes.forEach(textNode => {
                const span = document.createElement('span');
                span.innerHTML = textNode.textContent.replace(
                    new RegExp(`(${searchTerm})`, 'gi'),
                    '<span class="highlight">$1</span>'
                );
                textNode.parentNode.replaceChild(span, textNode);
            });

            // Scroll to first match
            const firstHighlight = document.querySelector('.highlight');
            if (firstHighlight) {
                firstHighlight.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // Scroll to section
        function scrollToSection(sectionId) {
            const section = document.querySelector(`[data-section="${sectionId}"]`);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                // Expand the target card
                const content = section.querySelector('.card-content');
                const icon = section.querySelector('.expand-icon');
                content.classList.add('expanded');
                icon.style.transform = 'rotate(180deg)';
            }
        }

        // Progress sidebar active state
        function updateActiveSection() {
            const sections = document.querySelectorAll('.card');
            const progressItems = document.querySelectorAll('.progress-item');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const sectionId = entry.target.dataset.section;
                        progressItems.forEach(item => item.classList.remove('active'));
                        const activeItem = document.querySelector(`[onclick="scrollToSection('${sectionId}')"]`);
                        if (activeItem) activeItem.classList.add('active');
                    }
                });
            }, { threshold: 0.3 });
            
            sections.forEach(section => observer.observe(section));
        }

        // Expand first card by default
        document.addEventListener('DOMContentLoaded', () => {
            const firstCard = document.querySelector('.card-content');
            const firstIcon = document.querySelector('.expand-icon');
            if (firstCard && firstIcon) {
                firstCard.classList.add('expanded');
                firstIcon.style.transform = 'rotate(180deg)';
            }
            updateActiveSection();
        });

        // Print styles
        window.addEventListener('beforeprint', () => {
            document.body.classList.add('print-mode');
            expandAll();
        });

        window.addEventListener('afterprint', () => {
            document.body.classList.remove('print-mode');
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + F for search
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                e.preventDefault();
                toggleSearch();
            }
            // Esc to close search
            if (e.key === 'Escape') {
                document.getElementById('searchBox').style.display = 'none';
            }
        });

        // Close search when clicking outside
        document.addEventListener('click', (e) => {
            const searchBox = document.getElementById('searchBox');
            const toolbar = document.querySelector('.toolbar');
            if (!searchBox.contains(e.target) && !toolbar.contains(e.target)) {
                searchBox.style.display = 'none';
            }
        });

        // Floating action button for mobile
        const mobileFab = document.createElement('div');
        mobileFab.innerHTML = `
            <button style="
                position: fixed;
                bottom: 20px;
                right: 20px;
                width: 60px;
                height: 60px;
                border-radius: 50%;
                background: linear-gradient(45deg, #667eea, #764ba2);
                color: white;
                border: none;
                font-size: 1.5em;
                cursor: pointer;
                box-shadow: 0 5px 20px rgba(0,0,0,0.3);
                display: none;
                z-index: 1000;
            " onclick="expandAll()">
                <i class="fas fa-expand"></i>
            </button>
        `;
        document.body.appendChild(mobileFab);

        // Show FAB on mobile
        if (window.innerWidth <= 768) {
            mobileFab.querySelector('button').style.display = 'flex';
            mobileFab.querySelector('button').style.alignItems = 'center';
            mobileFab.querySelector('button').style.justifyContent = 'center';
        }

        window.addEventListener('resize', () => {
            if (window.innerWidth <= 768) {
                mobileFab.querySelector('button').style.display = 'flex';
                mobileFab.querySelector('button').style.alignItems = 'center';
                mobileFab.querySelector('button').style.justifyContent = 'center';
            } else {
                mobileFab.querySelector('button').style.display = 'none';
            }
        });
    </script>

</body></html>