<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MOH Quick Reference | Medication Overuse Headache</title>
    <style>
        :root {
            /* Clinical Color Palette */
            --danger-bg: #ffebee;
            --danger-border: #ef5350;
            --danger-text: #b71c1c;
            
            --success-bg: #e8f5e9;
            --success-border: #66bb6a;
            --success-text: #1b5e20;

            --info-bg: #e3f2fd;
            --info-border: #42a5f5;
            --info-text: #0d47a1;

            --neutral-bg: #f5f5f5;
            --neutral-border: #bdbdbd;
            --neutral-text: #424242;

            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-hover: 0 8px 15px rgba(0,0,0,0.15);
        }

        /* Dark Mode Variables */
        body.dark-mode {
            --white: #1e1e1e;
            --neutral-bg: #2c2c2c;
            --neutral-text: #e0e0e0;
            --neutral-border: #444;
            
            --danger-bg: #4a1515;
            --danger-text: #ff8a80;
            --danger-border: #d32f2f;

            --success-bg: #1b3320;
            --success-text: #a5d6a7;
            --success-border: #2e7d32;

            --info-bg: #102a42;
            --info-text: #90caf9;
            --info-border: #1565c0;
        }

        * {
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            padding: 0;
            line-height: 1.5;
        }

        body.dark-mode {
            background-color: #121212;
            color: #e0e0e0;
        }

        /* --- Header & Controls --- */
        header {
            background-color: var(--white);
            padding: 1rem 2rem;
            border-bottom: 4px solid var(--info-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        .branding h1 {
            margin: 0;
            font-size: 1.5rem;
            color: var(--info-text);
        }

        .branding p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--neutral-text);
            opacity: 0.8;
        }

        .controls {
            display: flex;
            gap: 1rem;
        }

        input#searchBox {
            padding: 0.5rem 1rem;
            border: 1px solid var(--neutral-border);
            border-radius: 20px;
            width: 250px;
            font-size: 0.9rem;
        }

        button.theme-toggle {
            background: none;
            border: 1px solid var(--neutral-border);
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            color: var(--neutral-text);
            font-weight: bold;
        }

        button.theme-toggle:hover {
            background-color: var(--neutral-bg);
        }

        /* --- Main Grid Layout --- */
        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        /* --- Card Styles --- */
        .card {
            background: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            border-left: 6px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .card h2 {
            margin-top: 0;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--neutral-text);
        }

        /* --- Modifiers --- */
        .card.alert {
            border-left-color: var(--danger-border);
            background: linear-gradient(to right, var(--danger-bg), var(--white));
        }
        .card.alert h2 { color: var(--danger-text); }

        .card.action {
            border-left-color: var(--success-border);
            background: linear-gradient(to right, var(--success-bg), var(--white));
        }
        .card.action h2 { color: var(--success-text); }

        .card.info {
            border-left-color: var(--info-border);
            background: linear-gradient(to right, var(--info-bg), var(--white));
        }
        .card.info h2 { color: var(--info-text); }

        /* --- Content Elements --- */
        ul.feature-list {
            list-style: none;
            padding: 0;
        }
        ul.feature-list li {
            margin-bottom: 0.8rem;
            padding-left: 1.5rem;
            position: relative;
        }
        ul.feature-list li::before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            font-weight: bold;
            color: var(--info-border);
        }
        .card.alert ul.feature-list li::before { color: var(--danger-border); }
        .card.action ul.feature-list li::before { color: var(--success-border); }

        .stat-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }
        .stat-box {
            background: rgba(255,255,255,0.6);
            padding: 1rem;
            border-radius: 6px;
            text-align: center;
            border: 1px solid var(--neutral-border);
        }
        body.dark-mode .stat-box {
            background: rgba(0,0,0,0.2);
        }
        .stat-box strong {
            display: block;
            font-size: 1.5rem;
            color: var(--info-text);
        }
        .stat-box span {
            font-size: 0.85rem;
            color: var(--neutral-text);
        }

        /* --- Tables --- */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }
        th, td {
            text-align: left;
            padding: 0.75rem;
            border-bottom: 1px solid var(--neutral-border);
        }
        th {
            background-color: var(--neutral-bg);
            color: var(--neutral-text);
        }
        .highlight-row {
            background-color: var(--danger-bg);
            color: var(--danger-text);
        }

        /* --- Timeline (Withdrawal) --- */
        .timeline {
            border-left: 2px solid var(--neutral-border);
            margin-left: 10px;
            padding-left: 20px;
        }
        .timeline-item {
            position: relative;
            margin-bottom: 1.5rem;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -26px;
            top: 5px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--neutral-border);
        }
        .timeline-item.bad::before { background-color: var(--danger-border); }
        .timeline-item.good::before { background-color: var(--success-border); }
        
        .tag {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .tag.red { background: var(--danger-bg); color: var(--danger-text); border: 1px solid var(--danger-border); }
        .tag.green { background: var(--success-bg); color: var(--success-text); border: 1px solid var(--success-border); }

        /* --- Utility --- */
        .hidden { display: none; }
        .print-only { display: none; }
        
        @media print {
            header, .controls { display: none; }
            .card { break-inside: avoid; border: 1px solid #ccc; box-shadow: none; background: white; color: black; }
            body { background: white; color: black; }
            .container { display: block; }
            .card { margin-bottom: 1rem; }
        }

        /* --- Footer --- */
        footer {
            text-align: center;
            padding: 2rem;
            color: var(--neutral-text);
            font-size: 0.8rem;
        }
    </style>
</head>
<body>

    <header>
        <div class="branding">
            <h1>Headache - Medication Overuse</h1>
            <p>Clinical Quick Reference (NICE CKS)</p>
        </div>
        <div class="controls">
            <input type="text" id="searchBox" placeholder="Filter (e.g. 'withdrawal', 'referral')...">
            <button class="theme-toggle" onclick="toggleTheme()">üåô Dark Mode</button>
        </div>
    </header>

    <div class="container" id="mainContainer">
        
        <!-- RED FLAG ALERT -->
        <div class="card alert" data-keywords="urgent admission secondary red flags">
            <h2>‚ö†Ô∏è Safety First: Red Flags</h2>
            <div class="tag red">PRIORITY ACTION</div>
            <p><strong>If ANY red flags are present, arrange specialist admission or referral immediately.</strong></p>
            <ul class="feature-list">
                <li>Suspected serious underlying secondary cause.</li>
                <li>Systemic symptoms (fever, weight loss).</li>
                <li>Neurological deficits (focal signs).</li>
                <li>Sudden onset "thunderclap" headache.</li>
                <li>Papilledema.</li>
            </ul>
            <p><em>See CKS Headache - Assessment for full list.</em></p>
        </div>

        <!-- DEFINITION CRITERIA -->
        <div class="card info" data-keywords="definition diagnosis criteria frequency days">
            <h2>üìã The Diagnosis Criteria</h2>
            <p><strong>MOH is defined as:</strong> Headache ‚â•15 days/month in a person with a pre-existing primary headache disorder, caused by regular overuse for >3 months.</p>
            
            <table>
                <thead>
                    <tr>
                        <th>Medication Class</th>
                        <th>Threshold for Overuse</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="highlight-row">
                        <td><strong>Triptans, Ergotamines, Opioids, Combination Analgesics</strong></td>
                        <td><strong>>= 10 days/month</strong></td>
                    </tr>
                    <tr>
                        <td>Simple Analgesics (Paracetamol, NSAIDs, Aspirin)</td>
                        <td>>= 15 days/month</td>
                    </tr>
                </tbody>
            </table>
            <p style="font-size:0.85rem; color:var(--neutral-text)">*Note: Triptan overuse causes faster onset (1.7 years) than simple analgesics (4.8 years).</p>
        </div>

        <!-- MANAGEMENT: ACTION -->
        <div class="card action" data-keywords="management treatment withdrawal stop advice">
            <h2>‚úÖ Primary Management: Withdrawal</h2>
            <div class="tag green">FIRST LINE</div>
            <p><strong>Explain:</strong> Early withdrawal is the mainstay of treatment. It usually resolves the headache.</p>
            
            <ul class="feature-list">
                <li><strong>Stop abruptly:</strong> Stop all overused acute meds (Triptans, Ergotamines, Simple analgesics) immediately. Do not taper.</li>
                <li><strong>Duration:</strong> Stop for at least <strong>1 month</strong>.</li>
                <li><strong>Diary:</strong> Advise keeping a headache diary to track progress.</li>
                <li><strong>Avoid Replacement:</strong> Do not replace with NSAIDs or Amitriptyline unless necessary for the underlying headache.</li>
            </ul>
        </div>

        <!-- WITHDRAWAL TIMELINE -->
        <div class="card info" data-keywords="timeline symptoms worsening recovery nausea">
            <h2>‚è±Ô∏è What to Expect: The Withdrawal Timeline</h2>
            <p>Warn the patient that they may feel worse before they feel better.</p>
            
            <div class="timeline">
                <div class="timeline-item bad">
                    <strong>Days 1 - 14 (The "Washout")</strong>
                    <p>Headache often <strong>worsens</strong>. Withdrawal symptoms may include nausea, anxiety, restlessness, sleep disturbance, and hypotension.</p>
                </div>
                <div class="timeline-item good">
                    <strong>Week 2 - 4</strong>
                    <p>Headache usually begins to <strong>improve</strong>.</p>
                </div>
                <div class="timeline-item">
                    <strong>Month 2 - 3</strong>
                    <p>Recovery continues. Underlying primary headache (Migraine/Tension) reassessed.</p>
                </div>
            </div>
        </div>

        <!-- REFERRAL CRITERIA -->
        <div class="card alert" data-keywords="neurology referral specialist uncertainty">
            <h2>üè• When to Refer (Neurology)</h2>
            <p>Most cases are managed in primary care, but refer if:</p>
            <ul class="feature-list">
                <li>Uncertainty about the diagnosis or atypical symptoms.</li>
                <li>Previous repeated withdrawal attempts have been unsuccessful.</li>
                <li>Patient is overusing strong opioids, barbiturates, or tranquilizers.</li>
                <li>Significant comorbidities needing specialist management.</li>
                <li>Do <u>not</u> refer solely for neuroimaging/reassurance if diagnosis is clear.</li>
            </ul>
        </div>

        <!-- LONG TERM & PATIENT INFO -->
        <div class="card info" data-keywords="prevention relapse patient leaflet support">
            <h2>üí° Prevention & Resources</h2>
            <p><strong>To prevent relapse:</strong></p>
            <ul class="feature-list">
                <li>Future acute medication restricted to <strong>max 2 days/week</strong>.</li>
                <li>Treat underlying anxiety/depression/insomnia if present.</li>
                <li>Consider prophylaxis for migraine (e.g., Topiramate) if needed.</li>
            </ul>
            <hr style="border:0; border-top:1px solid var(--neutral-border); margin: 1rem 0;">
            <p><strong>Patient Resources:</strong></p>
            <ul class="feature-list">
                <li>Lifting the Burden (www.l-t-b.org)</li>
                <li>The Migraine Trust - Medication Overuse Leaflet</li>
                <li>BASH Patient Leaflet - Common Headache Problems</li>
            </ul>
        </div>

    </div>

    <footer>
        <p>Based on NICE CKS Headache - medication overuse (Last revised May 2022).</p>
        <p>For professional use only. Always use clinical judgment.</p>
    </footer>

    <script>
        // --- Search Filter Logic ---
        const searchBox = document.getElementById('searchBox');
        const cards = document.querySelectorAll('.card');

        searchBox.addEventListener('keyup', (e) => {
            const term = e.target.value.toLowerCase();

            cards.forEach(card => {
                const keywords = card.getAttribute('data-keywords').toLowerCase();
                const text = card.innerText.toLowerCase();
                
                if (keywords.includes(term) || text.includes(term)) {
                    card.classList.remove('hidden');
                } else {
                    card.classList.add('hidden');
                }
            });
        });

        // --- Dark Mode Logic ---
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const btn = document.querySelector('.theme-toggle');
            if (document.body.classList.contains('dark-mode')) {
                btn.innerText = "‚òÄÔ∏è Light Mode";
            } else {
                btn.innerText = "üåô Dark Mode";
            }
        }

        // --- Auto-detect system preference ---
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            toggleTheme();
        }
    </script>
</body>
</html>