<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinical Quick-Scan: Proven Peptic Ulcer</title>
    <style>
        :root {
            /* Clinical Palette */
            --primary-blue: #005eb8; /* NHS Blue style */
            --primary-light: #e8f4fa;
            --danger-red: #d32f2f;
            --danger-bg: #ffebee;
            --success-green: #2e7d32;
            --success-bg: #e8f5e9;
            --neutral-gray: #f5f5f5;
            --text-dark: #212121;
            --text-light: #666666;
            --white: #ffffff;
            --border-radius: 8px;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background-color: var(--neutral-gray);
            color: var(--text-dark);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* --- Header & Nav --- */
        header {
            background-color: var(--white);
            border-bottom: 4px solid var(--primary-blue);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        h1 {
            font-size: 1.5rem;
            color: var(--primary-blue);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-tabs {
            display: flex;
            gap: 1rem;
        }

        .nav-btn {
            background: none;
            border: none;
            padding: 0.5rem 1rem;
            font-size: 1rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            color: var(--text-light);
            font-weight: 600;
            transition: var(--transition);
        }

        .nav-btn:hover {
            color: var(--primary-blue);
            background-color: var(--primary-light);
        }

        .nav-btn.active {
            color: var(--primary-blue);
            border-bottom-color: var(--primary-blue);
        }

        /* --- Main Layout --- */
        main {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Red Flags / Alert Section --- */
        .alert-banner {
            background-color: var(--danger-bg);
            border-left: 6px solid var(--danger-red);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-radius: 4px;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .alert-icon {
            color: var(--danger-red);
            width: 32px;
            height: 32px;
            flex-shrink: 0;
        }

        .alert-content h2 {
            color: var(--danger-red);
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .alert-list {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .alert-tag {
            background: var(--white);
            color: var(--danger-red);
            border: 1px solid var(--danger-red);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* --- Cards & Grid --- */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border-top: 4px solid transparent;
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 12px rgba(0,0,0,0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-dark);
        }

        .card-blue { border-top-color: var(--primary-blue); }
        .card-green { border-top-color: var(--success-green); }
        .card-red { border-top-color: var(--danger-red); }

        /* --- Decision Tool (Interactive) --- */
        .decision-tool {
            background: var(--white);
            padding: 2rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .step-container {
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .option-group {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .decision-btn {
            background-color: var(--white);
            border: 2px solid var(--primary-blue);
            color: var(--primary-blue);
            padding: 1rem 2rem;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            min-width: 150px;
        }

        .decision-btn:hover {
            background-color: var(--primary-blue);
            color: var(--white);
            transform: scale(1.05);
        }

        .result-box {
            background-color: var(--success-bg);
            border: 2px solid var(--success-green);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            margin-top: 1rem;
            width: 100%;
            text-align: left;
        }

        .reset-link {
            margin-top: 1rem;
            color: var(--text-light);
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.9rem;
        }

        /* --- Drug Regimens --- */
        .regimen-card {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .drug-pill {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--neutral-gray);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-size: 0.95rem;
        }

        .drug-name {
            font-weight: 700;
        }

        .drug-dose {
            background: var(--white);
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            border: 1px solid #ddd;
        }

        /* --- Tables --- */
        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .info-table th, .info-table td {
            text-align: left;
            padding: 0.75rem;
            border-bottom: 1px solid #eee;
        }

        .info-table th {
            color: var(--primary-blue);
            font-weight: 600;
        }

        /* --- Footer --- */
        footer {
            background-color: var(--text-dark);
            color: var(--white);
            text-align: center;
            padding: 1.5rem;
            margin-top: 2rem;
            font-size: 0.85rem;
        }

        /* --- Icons (SVG styling) --- */
        svg {
            vertical-align: middle;
        }

        /* Responsive */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 1rem;
            }
            .nav-tabs {
                width: 100%;
                justify-content: center;
                overflow-x: auto;
            }
            .grid-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

<header>
    <h1>
        <!-- SVG Logo Icon -->
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
        </svg>
        CKS: Proven Peptic Ulcer
    </h1>
    <nav class="nav-tabs">
        <button class="nav-btn active" onclick="switchTab('overview')">Overview & Flags</button>
        <button class="nav-btn" onclick="switchTab('management')">Decision Tool</button>
        <button class="nav-btn" onclick="switchTab('regimens')">Drug Regimens</button>
    </nav>
</header>

<main>
    <!-- RED FLAGS BANNER (Visible on all tabs or specifically overview) -->
    <div class="alert-banner">
        <svg class="alert-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
        </svg>
        <div class="alert-content">
            <h2>Immediate Red Flags (Refer/Urgent Action)</h2>
            <div class="alert-list">
                <span class="alert-tag">Dysphagia</span>
                <span class="alert-tag">Weight loss (Age >55)</span>
                <span class="alert-tag">Persistent vomiting</span>
                <span class="alert-tag">GI Bleeding</span>
                <span class="alert-tag"> signs of peritonitis</span>
            </div>
        </div>
    </div>

    <!-- TAB 1: OVERVIEW & BACKGROUND -->
    <section id="overview" class="tab-content active">
        <div class="grid-container">
            <!-- Definition Card -->
            <div class="card card-blue">
                <div class="card-header">
                    <span class="card-title">Definition</span>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#005eb8" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                </div>
                <p>Breach in epithelium of gastric or duodenal mucosa penetrating muscularis mucosae, confirmed on endoscopy.</p>
                <ul style="margin-top:0.5rem; padding-left:1.2rem; font-size:0.9rem; color:#555;">
                    <li>Symptoms: Upper abdominal pain/discomfort, heartburn, nausea (4+ weeks).</li>
                    <li><strong>Gastric Ulcer:</strong> Higher risk of malignancy. Must repeat endoscopy.</li>
                    <li><strong>Duodenal Ulcer:</strong> Usually benign.</li>
                </ul>
            </div>

            <!-- Risk Factors Card -->
            <div class="card card-blue">
                <div class="card-header">
                    <span class="card-title">Key Risk Factors</span>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#005eb8" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                </div>
                <table class="info-table">
                    <tr><td><strong>H. pylori</strong></td><td>90% duodenal, 70-80% gastric ulcers (non-NSAID).</td></tr>
                    <tr><td><strong>NSAIDs / Aspirin</strong></td><td>20% incidence in chronic users; 4x complication risk.</td></tr>
                    <tr><td><strong>Other Meds</strong></td><td>SSRIs, Bisphosphonates, Corticosteroids, Cocaine.</td></tr>
                    <tr><td><strong>Lifestyle</strong></td><td>Smoking (2x risk), Alcohol, Stress.</td></tr>
                </table>
            </div>

            <!-- Prognosis Card -->
            <div class="card card-green">
                <div class="card-header">
                    <span class="card-title">Prognosis & Healing</span>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#2e7d32" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>
                </div>
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.5rem;">
                    <span>Duodenal Ulcer Healing</span>
                    <span style="font-weight:bold; color:var(--success-green);">~4 weeks (PPI)</span>
                </div>
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span>Gastric Ulcer Healing</span>
                    <span style="font-weight:bold; color:var(--success-green);">~8 weeks (PPI)</span>
                </div>
                <hr style="border:0; border-top:1px solid #ddd; margin:0.8rem 0;">
                <p style="font-size:0.9rem;">
                    <strong>Recurrence Risk:</strong> Drops from 60-80% to <strong>5%</strong> after H. pylori eradication.
                </p>
            </div>
        </div>
    </section>

    <!-- TAB 2: INTERACTIVE MANAGEMENT TOOL -->
    <section id="management" class="tab-content">
        <div class="decision-tool">
            <h2 style="margin-bottom: 1rem; color: var(--primary-blue);">Clinical Decision Support</h2>
            <div id="decision-step-container" class="step-container">
                <!-- Content injected via JS -->
            </div>
            <p class="reset-link" onclick="resetDecision()">Start Over</p>
        </div>

        <div style="margin-top: 2rem;">
            <h3 style="margin-bottom:1rem;">General Management Steps</h3>
            <div class="grid-container">
                <div class="card card-blue">
                    <div class="card-title">Lifestyle & Advice</div>
                    <ul style="padding-left:1.2rem; margin-top:0.5rem;">
                        <li>Lose weight (if overweight)</li>
                        <li>Avoid triggers: Coffee, spicy/fatty foods</li>
                        <li>Stop smoking</li>
                        <li>Reduce alcohol</li>
                    </ul>
                </div>
                <div class="card card-blue">
                    <div class="card-title">Medication Review</div>
                    <ul style="padding-left:1.2rem; margin-top:0.5rem;">
                        <li><strong>STOP NSAIDs</strong> if possible.</li>
                        <li>Review corticosteroids, SSRIs, bisphosphonates.</li>
                        <li>Short-term antacids/alginates okay.</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- TAB 3: DRUG REGIMENS -->
    <section id="regimens" class="tab-content">
        <h3 style="margin-bottom: 1rem; border-left: 4px solid var(--primary-blue); padding-left: 0.5rem;">Recommended PPI Doses</h3>
        <div style="display:flex; gap:0.5rem; flex-wrap:wrap; margin-bottom:2rem;">
            <span class="alert-tag" style="border-color:var(--primary-blue); color:var(--primary-blue);">Lansoprazole 30mg</span>
            <span class="alert-tag" style="border-color:var(--primary-blue); color:var(--primary-blue);">Omeprazole 20-40mg</span>
            <span class="alert-tag" style="border-color:var(--primary-blue); color:var(--primary-blue);">Esomeprazole 20mg</span>
            <span class="alert-tag" style="border-color:var(--primary-blue); color:var(--primary-blue);">Pantoprazole 40mg</span>
            <span class="alert-tag" style="border-color:var(--primary-blue); color:var(--primary-blue);">Rabeprazole 20mg</span>
        </div>

        <div class="grid-container">
            <!-- Regimen 1 -->
            <div class="card card-green">
                <div class="card-header">
                    <span class="card-title">First-Line (Standard)</span>
                    <span style="font-size:0.8rem; background:#e8f5e9; padding:2px 6px; border-radius:4px; color:#2e7d32;">7 Days</span>
                </div>
                <div class="regimen-card">
                    <p style="font-size:0.9rem; margin-bottom:0.5rem;">Triple Therapy (PPI + Amoxicillin + Clarithromycin OR Metronidazole)</p>
                    <div class="drug-pill">
                        <span class="drug-name">PPI</span>
                        <span class="drug-dose">Twice Daily</span>
                    </div>
                    <div class="drug-pill">
                        <span class="drug-name">Amoxicillin</span>
                        <span class="drug-dose">1g Twice Daily</span>
                    </div>
                    <div class="drug-pill">
                        <span class="drug-name">Clarithromycin</span>
                        <span class="drug-dose">500mg Twice Daily</span>
                    </div>
                    <p style="text-align:center; font-size:0.9rem;">OR</p>
                    <div class="drug-pill">
                        <span class="drug-name">Metronidazole</span>
                        <span class="drug-dose">400mg Twice Daily</span>
                    </div>
                </div>
            </div>

            <!-- Regimen 2: Penicillin Allergy -->
            <div class="card card-green">
                <div class="card-header">
                    <span class="card-title">First-Line (Penicillin Allergy)</span>
                    <span style="font-size:0.8rem; background:#e8f5e9; padding:2px 6px; border-radius:4px; color:#2e7d32;">7 Days</span>
                </div>
                <div class="regimen-card">
                    <p style="font-size:0.9rem; margin-bottom:0.5rem;">Triple Therapy (PPI + Clarithromycin + Metronidazole)</p>
                    <div class="drug-pill">
                        <span class="drug-name">PPI</span>
                        <span class="drug-dose">Twice Daily</span>
                    </div>
                    <div class="drug-pill">
                        <span class="drug-name">Clarithromycin</span>
                        <span class="drug-dose">500mg Twice Daily</span>
                    </div>
                    <div class="drug-pill">
                        <span class="drug-name">Metronidazole</span>
                        <span class="drug-dose">400mg Twice Daily</span>
                    </div>
                </div>
            </div>

            <!-- Regimen 3: Second Line -->
            <div class="card card-blue">
                <div class="card-header">
                    <span class="card-title">Second-Line (Failed First Line)</span>
                    <span style="font-size:0.8rem; background:#e8f4fa; padding:2px 6px; border-radius:4px; color:#005eb8;">7-14 Days</span>
                </div>
                <div class="regimen-card">
                    <p style="font-size:0.9rem; margin-bottom:0.5rem;"><strong>If not used first-line:</strong> PPI + Amoxicillin + Clarithromycin/Metronidazole.</p>
                    <hr style="border:0; border-top:1px dashed #ccc; margin:0.5rem 0;">
                    <p style="font-size:0.9rem; margin-bottom:0.5rem;"><strong>If previous exposure to Clarithro & Metro:</strong></p>
                    <div class="drug-pill">
                        <span class="drug-name">PPI</span>
                        <span class="drug-dose">Twice Daily</span>
                    </div>
                    <div class="drug-pill">
                        <span class="drug-name">Amoxicillin</span>
                        <span class="drug-dose">1g Twice Daily</span>
                    </div>
                    <div class="drug-pill">
                        <span class="drug-name">Levofloxacin</span>
                        <span class="drug-dose">250mg Twice Daily</span>
                    </div>
                    <p style="text-align:center; font-size:0.9rem;">OR</p>
                    <div class="drug-pill">
                        <span class="drug-name">Tetracycline HCl</span>
                        <span class="drug-dose">500mg Four Times Daily</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card card-red" style="margin-top: 2rem;">
            <div class="card-header">
                <span class="card-title">Follow-up & Referral</span>
            </div>
            <ul style="padding-left:1.2rem;">
                <li><strong>Gastric Ulcer:</strong> Repeat endoscopy 6-8 weeks to confirm healing. Re-test for H. pylori.</li>
                <li><strong>Test of Cure:</strong> Urea breath test (ensure 2 weeks off PPI, 4 weeks off antibiotics).</li>
                <li><strong>Refer if:</strong> Refractory symptoms, failed 2nd line eradication, unhealed gastric ulcer, suspicion of Zollinger-Ellison.</li>
            </ul>
        </div>
    </section>

</main>

<footer>
    <p>Based on NICE Clinical Knowledge Summaries (CKS) - Dyspepsia - proven peptic ulcer (May 2024).<br>
    For educational and reference purposes only. Always verify with current local guidelines.</p>
</footer>

<script>
    // --- Tab Switching Logic ---
    function switchTab(tabId) {
        // Remove active class from all contents
        document.querySelectorAll('.tab-content').forEach(el => {
            el.classList.remove('active');
        });
        // Remove active class from all buttons
        document.querySelectorAll('.nav-btn').forEach(el => {
            el.classList.remove('active');
        });

        // Activate specific tab and button
        document.getElementById(tabId).classList.add('active');
        // Find the button that calls this function with this ID (approximate)
        const btns = Array.from(document.querySelectorAll('.nav-btn'));
        const activeBtn = btns.find(btn => btn.getAttribute('onclick').includes(tabId));
        if(activeBtn) activeBtn.classList.add('active');
    }

    // --- Decision Tree Logic ---
    const decisionState = {
        step: 0,
        hPyloriStatus: null,
        nsaidStatus: null,
        allergy: null
    };

    function renderDecision() {
        const container = document.getElementById('decision-step-container');
        container.innerHTML = ''; // Clear current

        if (decisionState.step === 0) {
            // Initial Question
            const title = document.createElement('h3');
            title.textContent = "Is the patient H. pylori Positive?";
            container.appendChild(title);

            const btnGroup = document.createElement('div');
            btnGroup.className = 'option-group';

            const btnPos = document.createElement('button');
            btnPos.className = 'decision-btn';
            btnPos.textContent = "Yes (+)";
            btnPos.onclick = () => { decisionState.hPyloriStatus = 'positive'; decisionState.step = 1; renderDecision(); };

            const btnNeg = document.createElement('button');
            btnNeg.className = 'decision-btn';
            btnNeg.textContent = "No (-)";
            btnNeg.onclick = () => { decisionState.hPyloriStatus = 'negative'; decisionState.step = 3; renderDecision(); };

            btnGroup.appendChild(btnPos);
            btnGroup.appendChild(btnNeg);
            container.appendChild(btnGroup);

        } else if (decisionState.step === 1) {
            // Positive H. pylori -> Ask about NSAID
            const title = document.createElement('h3');
            title.textContent = "Is the ulcer associated with NSAID use?";
            container.appendChild(title);

            const btnGroup = document.createElement('div');
            btnGroup.className = 'option-group';

            const btnYes = document.createElement('button');
            btnYes.className = 'decision-btn';
            btnYes.textContent = "Yes";
            btnYes.onclick = () => { decisionState.nsaidStatus = true; decisionState.step = 2; renderDecision(); };

            const btnNo = document.createElement('button');
            btnNo.className = 'decision-btn';
            btnNo.textContent = "No";
            btnNo.onclick = () => { decisionState.nsaidStatus = false; decisionState.step = 2; renderDecision(); };

            btnGroup.appendChild(btnYes);
            btnGroup.appendChild(btnNo);
            container.appendChild(btnGroup);

        } else if (decisionState.step === 2) {
            // H. pylori Positive Result Logic
            let html = '';
            
            if (decisionState.nsaidStatus === true) {
                html = `
                    <h4 style="color:var(--primary-blue)">Management Plan: H. pylori + NSAID User</h4>
                    <div class="result-box">
                        <strong>1. Prescribe Full-dose PPI for 2 months</strong>
                        <p style="font-size:0.9rem; color:#555;">To allow ulcer healing.</p>
                        <hr style="border:0; border-top:1px dashed #ccc; margin:0.5rem 0;">
                        <strong>2. Prescribe First-line Eradication Therapy</strong>
                        <p style="font-size:0.9rem; color:#555;">Start AFTER completing PPI therapy. (See 'Drug Regimens' tab).</p>
                    </div>
                `;
            } else {
                html = `
                    <h4 style="color:var(--primary-blue)">Management Plan: H. pylori Positive (No NSAID)</h4>
                    <div class="result-box">
                        <strong>Prescribe First-line Eradication Therapy NOW</strong>
                        <p style="font-size:0.9rem; color:#555;">Standard 7-day triple therapy. (See 'Drug Regimens' tab).</p>
                    </div>
                `;
            }

            container.innerHTML = html;

        } else if (decisionState.step === 3) {
            // H. pylori Negative Result Logic
            const html = `
                <h4 style="color:var(--primary-blue)">Management Plan: H. pylori Negative</h4>
                <div class="result-box">
                    <strong>Prescribe Full-dose PPI</strong>
                    <p style="font-size:0.9rem; color:#555;">Duration: 4â€“8 weeks depending on clinical judgment.</p>
                    <hr style="border:0; border-top:1px dashed #ccc; margin:0.5rem 0;">
                    <p style="font-size:0.9rem; color:#d32f2f;"><strong>Note:</strong> Review adherence. Check for inadvertent NSAID use or rare causes like Zollinger-Ellison.</p>
                </div>
            `;
            container.innerHTML = html;
        }
    }

    function resetDecision() {
        decisionState.step = 0;
        decisionState.hPyloriStatus = null;
        decisionState.nsaidStatus = null;
        renderDecision();
    }

    // Initialize
    renderDecision();

</script>

</body>
</html>