<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Insulin Therapy in Type 2 Diabetes – Quick Reference Algorithm</title>
  <meta name="description" content="Clean, fast reference algorithm for insulin therapy in type 2 diabetes (adults & young people) designed for busy clinics."/>
  <style>
    /* ---- CSS Variables (Light & Dark) ---- */
    :root{
      --bg: #0b0c0f;
      --panel: #101218;
      --text: #e8edf2;
      --muted: #b6c2cf;
      --brand: #6ad3ff;
      --accent: #9ef0a7;
      --warn: #ffd166;
      --danger: #ff6b6b;
      --ok: #7cd992;
      --ring: rgba(106,211,255,.35);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --card-border: 1px solid rgba(255,255,255,.06);
    }
    [data-theme="light"]{
      --bg: #f8fafc;
      --panel: #ffffff;
      --text: #0b1220;
      --muted: #425466;
      --brand: #0ea5e9;
      --accent: #10b981;
      --warn: #f59e0b;
      --danger: #ef4444;
      --ok: #16a34a;
      --ring: rgba(14,165,233,.25);
      --shadow: 0 10px 24px rgba(2,8,20,.08);
      --card-border: 1px solid rgba(2,8,23,.06);
    }

    /* ---- Base ---- */
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--text);
      background: radial-gradient(1200px 700px at 80% -10%, rgba(106,211,255,.12), transparent 40%),
                  radial-gradient(800px 500px at 20% -10%, rgba(144,238,144,.12), transparent 45%),
                  var(--bg);
      line-height:1.55;
      letter-spacing:.2px;
    }
    .container{max-width:1100px;margin:0 auto;padding:24px}

    /* ---- Header ---- */
    header{
      position:sticky;top:0;z-index:50;
      backdrop-filter:saturate(1.2) blur(10px);
      background:color-mix(in oklab, var(--bg) 70%, transparent);
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .bar{display:flex;gap:14px;align-items:center;justify-content:space-between;padding:14px 20px}
    .title{display:flex;gap:12px;align-items:center}
    .title h1{font-size:18px;margin:0;font-weight:750;letter-spacing:.2px}
    .badge{font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.12);color:var(--muted)}
    .actions{display:flex;gap:10px;align-items:center}
    .btn{
      appearance:none;border:0;cursor:pointer;border-radius:12px;padding:10px 14px;
      background:var(--panel);color:var(--text);box-shadow:var(--shadow);
      border:var(--card-border);
      display:inline-flex;gap:10px;align-items:center;justify-content:center;font-weight:650
    }
    .btn:hover{outline:2px solid var(--ring)}
    .btn.small{padding:8px 10px;border-radius:10px}
    .btn.ghost{background:transparent;box-shadow:none}

    /* ---- Search + Chips ---- */
    .filters{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin:18px 0 6px}
    .search{flex:1;min-width:240px;position:relative}
    .search input{
      width:100%;padding:12px 40px 12px 44px;border-radius:14px;background:var(--panel);
      border:var(--card-border);color:var(--text);box-shadow:var(--shadow);font-size:14px
    }
    .search svg{position:absolute;left:14px;top:50%;transform:translateY(-50%);opacity:.7}
    .chip{padding:8px 12px;border-radius:999px;background:color-mix(in oklab, var(--brand) 12%, var(--panel));
      border:var(--card-border);font-size:13px}
    .chip a{color:inherit;text-decoration:none}

    /* ---- Grid & Cards ---- */
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px;margin-top:14px}
    .col-6{grid-column:span 6}
    .col-12{grid-column:span 12}
    @media (max-width: 900px){.col-6{grid-column:span 12}}

    .card{
      background:linear-gradient(180deg, color-mix(in oklab, var(--panel) 96%, transparent), var(--panel));
      border-radius:18px;padding:18px 18px;border:var(--card-border);box-shadow:var(--shadow);
      position:relative;overflow:hidden
    }
    .card h2{font-size:16px;margin:0 0 10px 0;font-weight:800}
    .card .eyebrow{display:flex;gap:8px;align-items:center;color:var(--muted);font-size:12px;margin-bottom:6px}
    .card ul{margin:6px 0 0 18px;padding:0}
    .card li{margin:6px 0}
    .tag{display:inline-flex;align-items:center;gap:8px;font-size:12px;margin-left:auto;padding:4px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.12);color:var(--muted)}

    .icon{width:18px;height:18px;opacity:.9}
    .ok{color:var(--accent)}
    .warn{color:var(--warn)}
    .danger{color:var(--danger)}

    /* ---- Footer Note ---- */
    .note{margin-top:22px;color:var(--muted);font-size:13px}

    /* ---- Print Styles (A4, dense two-column) ---- */
    @media print{
      :root{--bg:#fff;--panel:#fff;--text:#000;--muted:#222;--card-border:1px solid #ddd;--shadow:none}
      header,.filters,.actions,.chipbar{display:none!important}
      body{background:#fff}
      .container{max-width:100%;padding:8mm}
      .grid{display:block;column-count:2;column-gap:12mm}
      .card{break-inside:avoid;margin:0 0 8mm 0;padding:10px;border-radius:8px;box-shadow:none}
      .card h2{font-size:12.5pt}
      .card li, .card p{font-size:10.5pt}
      .note{font-size:9.5pt}
    }
  </style>
</head>
<body data-theme="light">
  <header>
    <div class="bar container">
      <div class="title">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><path d="M20 7c0 5-4 9-8 9s-8-4-8-9"/><path d="M12 16v4"/><path d="M8 20h8"/></svg>
        <h1>Insulin Therapy in Type 2 Diabetes — Quick Reference Algorithm</h1>
        <span class="badge" title="Last reviewed July 2025">v2025.07</span>
      </div>
      <div class="actions">
        <button class="btn small" id="themeBtn" title="Toggle light/dark (D)">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M12 3v2m0 14v2M3 12h2m14 0h2M5.6 5.6l1.4 1.4m10 10 1.4 1.4m0-12.8-1.4 1.4m-10 10-1.4 1.4"/></svg>
          Theme
        </button>
        <button class="btn small" onclick="window.print()" title="Print to PDF (P)">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M6 9V3h12v6"/><rect x="6" y="13" width="12" height="8" rx="2"/><path d="M6 17h12M6 13h12"/></svg>
          Print
        </button>
      </div>
    </div>
  </header>

  <main class="container" id="main">
    <div class="filters">
      <div class="search" role="search">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="11" cy="11" r="7"/><path d="m21 21-3.9-3.9"/></svg>
        <input id="searchInput" placeholder="Type to filter sections (e.g., hypoglycaemia, NPH, DVLA, Ramadan)" aria-label="Filter content" />
      </div>
      <div class="chipbar" aria-label="Quick jump links">
        <span class="chip"><a href="#when">When to Consider</a></span>
        <span class="chip"><a href="#types">Insulin Types</a></span>
        <span class="chip"><a href="#regimens">Regimen Choice</a></span>
        <span class="chip"><a href="#smbg">SMBG & Accessories</a></span>
        <span class="chip"><a href="#technique">Injection Technique</a></span>
        <span class="chip"><a href="#poor">Poor Control</a></span>
        <span class="chip"><a href="#hypo">Hypoglycaemia</a></span>
        <span class="chip"><a href="#lifestyle">Lifestyle & Safety</a></span>
        <span class="chip"><a href="#adverse">Adverse & Interactions</a></span>
      </div>
    </div>

    <section class="grid" id="cards">
      <!-- 1. When to Consider -->
      <article class="card col-6" id="when" data-terms="consider initiation symptomatic hyperglycaemia weight loss failure oral therapy intolerance high risk barriers obesity frailty life expectancy anxiety driving travel preference children">
        <div class="eyebrow">
          <span class="tag">Start</span>
        </div>
        <h2>1) When to Consider Insulin</h2>
        <ul>
          <li>Symptomatic hyperglycaemia (polyuria, polydipsia, weight loss).</li>
          <li>Poor control despite max tolerated non‑insulin therapy / contraindication or intolerance to orals.</li>
          <li>High complication risk (e.g., young age, very high HbA<sub>1c</sub>).</li>
          <li>Multidisciplinary decision for children/young people.</li>
        </ul>
        <p><strong>Potential barriers:</strong> obesity (weight gain risk), frailty/limited life expectancy, needle anxiety, depression/cognitive issues, driving/travel concerns, personal preference.</p>
      </article>

      <!-- 2. Insulin Types -->
      <article class="card col-6" id="types" data-terms="insulin types short rapid soluble aspart lispro glulisine intermediate NPH long glargine detemir ultra degludec U300 premixed analog human">
        <div class="eyebrow">
          <span class="tag">Know</span>
        </div>
        <h2>2) Insulin Types</h2>
        <ul>
          <li><strong>Short‑acting</strong>: soluble (Actrapid®, Humulin S®); <em>rapid‑acting analogues</em> (lispro, aspart, glulisine).</li>
          <li><strong>Intermediate (NPH)</strong>: Humulin I®, Insulatard®.</li>
          <li><strong>Long‑acting analogues</strong>: glargine, detemir.</li>
          <li><strong>Ultra‑long</strong>: degludec, glargine U300.</li>
          <li><strong>Premixed</strong>: human (Humulin M®, Insuman®) or analogue mixes (NovoMix®, Humalog Mix®).</li>
        </ul>
      </article>

      <!-- 3. Initial Regimen Choice -->
      <article class="card col-12" id="regimens" data-terms="regimen choice NPH first line add prandial HbA1c 75 9% long acting analogue glargine detemir recurrent hypos once daily carer device premixed postprandial basal bolus monitor">
        <div class="eyebrow">
          <span class="tag">Decide</span>
        </div>
        <h2>3) Initial Regimen & Escalation</h2>
        <ul>
          <li><strong>First line:</strong> NPH once/twice daily.</li>
          <li>Consider <strong>NPH + short‑acting</strong> (separate or premix) if HbA<sub>1c</sub> ≥ 75 mmol/mol (9.0%).</li>
          <li><strong>Switch/choose long‑acting analogue</strong> (glargine/detemir) if: recurrent hypoglycaemia, need once‑daily admin (carer), device issues, or inadequate control on NPH.</li>
          <li><strong>Premixed analogue</strong> if prefer pre‑meal dosing, post‑prandial spikes, or hypos on human mixes.</li>
          <li>Escalate to <strong>basal‑bolus</strong> if control remains inadequate.</li>
          <li>On basal only? Monitor for need of prandial; on premix? Monitor for need of extra prandial dose or move to basal‑bolus.</li>
        </ul>
      </article>

      <!-- 4. SMBG & Accessories -->
      <article class="card col-6" id="smbg" data-terms="self monitoring SMBG education annual review technique frequency targets meters strips lancets ketone glucagon sharps passport ID">
        <div class="eyebrow">
          <span class="tag">Monitor</span>
        </div>
        <h2>4) SMBG & Essential Accessories</h2>
        <ul>
          <li>Educate at initiation; annual review of skills, frequency, equipment, interpretation vs targets.</li>
          <li>Must have: delivery device + suitable needle length; glucose meter, strips, lancets; ketone testing (urine/blood) if indicated; glucagon kit; sharps container; insulin passport; diabetes ID.</li>
        </ul>
      </article>

      <!-- 5. Injection Technique -->
      <article class="card col-6" id="technique" data-terms="injection technique rotate sites abdomen thigh buttock arm needle 4mm 90 degrees room temperature no reuse leakage lipohypertrophy">
        <div class="eyebrow">
          <span class="tag">Do</span>
        </div>
        <h2>5) Injection Technique & Site Care</h2>
        <ul>
          <li>Use insulin at room temp; new needle each time; prime pens; never inject through clothing.</li>
          <li>Sites: <em>abdomen</em> fastest; <em>thigh</em> slower; <em>buttock</em> slowest. Rotate within area; avoid lipodystrophy.</li>
          <li>Insert at 90° with 4 mm pen needles; leave in for 5–10 s; gentle pressure, don’t rub.</li>
          <li>Manage issues: adjust needle length; review technique; switch analogue for persistent local reactions; don’t inject into lumps.</li>
        </ul>
      </article>

      <!-- 6. Poor Control -->
      <article class="card col-12" id="poor" data-terms="poor control hyperglycaemia hypoglycaemia nonadherence technique sites lifestyle psychosocial illness sick day CKD gastroparesis coeliac Addison's do not stop insulin">
        <div class="eyebrow">
          <span class="tag warn">Troubleshoot</span>
        </div>
        <h2>6) If Control Is Poor</h2>
        <ul>
          <li>Check adherence, administration technique, site rotation, SMBG skills, target knowledge.</li>
          <li>Review lifestyle (meals, alcohol, exercise) and psychosocial factors (anxiety, depression, support).</li>
          <li>Screen for comorbidities (CKD, gastroparesis, coeliac, Addison’s) affecting variability.</li>
          <li><strong>Intercurrent illness:</strong> increase monitoring; may need temporary dose changes; <u>do not stop insulin</u>.</li>
          <li>Seek specialist input for regimen titration if needed.</li>
        </ul>
      </article>

      <!-- 7. Hypoglycaemia -->
      <article class="card col-6" id="hypo" data-terms="hypoglycaemia recognition mild moderate severe impaired awareness nocturnal glucagon 0.5mg 1mg 999 10-20g recheck 10-15 min long acting carb">
        <div class="eyebrow">
          <span class="tag danger">Treat</span>
        </div>
        <h2>7) Hypoglycaemia</h2>
        <ul>
          <li><strong>Recognise:</strong> hunger, tremor, sweating → confusion, drowsiness; severe = coma/convulsions.</li>
          <li><strong>Mild/moderate:</strong> give 10–20 g fast‑acting carb → recheck in 10–15 min → repeat if needed → follow with long‑acting carb/meal.</li>
          <li><strong>Severe/unconscious:</strong> IM glucagon <em>0.5 mg (child &lt;25 kg)</em> or <em>1 mg (others)</em> → 999 if no response/IV glucose needed.</li>
          <li><strong>Nocturnal/recurrent:</strong> review education, regimen, evening intake, activity; consider specialist review.</li>
          <li><strong>Impaired awareness:</strong> higher risk of severe hypos — intensify education; prioritise hypo‑avoidance; refer if persists.</li>
        </ul>
      </article>

      <!-- 8. Lifestyle & Safety -->
      <article class="card col-6" id="lifestyle" data-terms="driving DVLA test 2 hours every 2 hours no severe hypo 12 months group 2 memory meter fasting Ramadan break fast 3.5 shift work travel hand luggage time zones insurance declare">
        <div class="eyebrow">
          <span class="tag warn">Safety</span>
        </div>
        <h2>8) Lifestyle & Safety</h2>
        <ul>
          <li><strong>Driving (DVLA):</strong> test ≤2 h pre‑drive and every 2 h while driving; no ≥2 severe hypos in last 12 months; meet vision standards; stricter rules for Group 2.</li>
          <li><strong>Fasting (incl. Ramadan):</strong> pre‑fast education; frequent SMBG; adjust doses; <u>break fast if BG &lt; 3.5 mmol/L or symptomatic</u>.</li>
          <li><strong>Work:</strong> some safety‑critical roles need individual assessment; shift work raises variability—adjust regimen with specialist input.</li>
          <li><strong>Travel:</strong> carry insulin & supplies in hand luggage with medical letter; manage time‑zone changes &gt;4 h (seek specialist advice).</li>
          <li><strong>Insurance:</strong> declare insulin therapy to insurer; ensure travel cover for diabetes.</li>
        </ul>
      </article>

      <!-- 9. Adverse & Interactions -->
      <article class="card col-12" id="adverse" data-terms="adverse effects weight gain vision oedema neuritis interactions enhance ACEi beta blockers MAOI alcohol salicylates fibrates reduce steroids thiazides OCP sympathomimetics growth hormone levothyroxine">
        <div class="eyebrow">
          <span class="tag">Consider</span>
        </div>
        <h2>9) Other Adverse Effects & Drug Interactions</h2>
        <ul>
          <li><strong>Adverse:</strong> weight gain; transient refraction changes; oedema (may settle after dose reduction); insulin neuritis after rapid control.</li>
          <li><strong>↑ Effect / ↓ Requirement:</strong> alcohol (also masks hypos), ACEi, β‑blockers (mask tremor), MAOIs, salicylates, fibrates, anabolic steroids.</li>
          <li><strong>↓ Effect / ↑ Requirement:</strong> corticosteroids, thiazide/loop diuretics, OCP, sympathomimetics (e.g., salbutamol), growth hormone, levothyroxine, danazol, glucagon.</li>
        </ul>
      </article>

    </section>

    <p class="note">
      <strong>For trained clinicians:</strong> Individualise all decisions by age, duration of diabetes, comorbidities, psychosocial context, and patient preference. 
      Escalate to the diabetes specialist team for recurrent severe hypoglycaemia, impaired awareness, or poor control despite optimisation. 
      Based on consolidated guidance from your supplied source (CKS, last revised July 2025).
    </p>
  </main>

  <script>
    // Theme toggle + keyboard shortcuts (D = theme, P = print)
    const body = document.body;
    const themeBtn = document.getElementById('themeBtn');
    themeBtn?.addEventListener('click', () => {
      body.dataset.theme = body.dataset.theme === 'dark' ? 'light' : 'dark';
    });
    window.addEventListener('keydown', (e)=>{
      if(e.key.toLowerCase()==='d'){ body.dataset.theme = body.dataset.theme === 'dark' ? 'light' : 'dark'; }
      if(e.key.toLowerCase()==='p'){ e.preventDefault(); window.print(); }
      document.getElementById('searchInput')?.focus();
    });

    // Lightweight content filter
    const q = document.getElementById('searchInput');
    const cards = Array.from(document.querySelectorAll('#cards .card'));
    q?.addEventListener('input', (e)=>{
      const term = (q.value||'').trim().toLowerCase();
      cards.forEach(card=>{
        const hay = (card.innerText + ' ' + (card.dataset.terms||'')).toLowerCase();
        const match = !term || hay.includes(term);
        card.style.display = match ? '' : 'none';
      });
    });
  </script>
</body>
</html>
