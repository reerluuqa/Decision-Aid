<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secondary Hyperparathyroidism - Interactive Algorithm</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --info: #9b59b6;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --text: #2c3e50;
            --text-light: #7f8c8d;
            --border: #bdc3c7;
            --card-bg: #ffffff;
            --bg: #f8f9fa;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-hover: 0 6px 16px rgba(0,0,0,0.12);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        [data-theme="dark"] {
            --primary: #3498db;
            --secondary: #5dade2;
            --success: #2ecc71;
            --warning: #f1c40f;
            --danger: #e74c3c;
            --info: #bb8fce;
            --light: #34495e;
            --dark: #ecf0f1;
            --text: #ecf0f1;
            --text-light: #bdc3c7;
            --border: #7f8c8d;
            --card-bg: #2c3e50;
            --bg: #1a252f;
            --shadow: 0 4px 12px rgba(0,0,0,0.3);
            --shadow-hover: 0 6px 16px rgba(0,0,0,0.4);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            transition: var(--transition);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            min-height: 100vh;
        }

        .main-content {
            flex: 1;
            padding: 2rem;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            background: var(--card-bg);
            color: var(--text);
            transition: var(--transition);
        }

        .search-box:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .filter-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            box-shadow: var(--shadow);
        }

        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .filter-btn.active {
            background: var(--secondary);
            color: white;
        }

        .theme-toggle {
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text);
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        .theme-toggle:hover {
            transform: rotate(180deg);
        }

        .cards-container {
            display: grid;
            gap: 2rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: var(--transition);
            border-left: 6px solid;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }

        .card.assessment {
            border-left-color: var(--secondary);
        }

        .card.diagnosis {
            border-left-color: var(--info);
        }

        .card.treatment {
            border-left-color: var(--success);
        }

        .card.follow-up {
            border-left-color: var(--warning);
        }

        .card-header {
            padding: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, var(--card-bg), rgba(52, 152, 219, 0.05));
        }

        .card-header-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            font-weight: bold;
        }

        .assessment .card-icon { background: var(--secondary); }
        .diagnosis .card-icon { background: var(--info); }
        .treatment .card-icon { background: var(--success); }
        .follow-up .card-icon { background: var(--warning); }

        .card-title h2 {
            font-size: 1.5rem;
            color: var(--text);
            margin-bottom: 0.25rem;
        }

        .card-title p {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .expand-icon {
            font-size: 1.5rem;
            color: var(--text-light);
            transition: var(--transition);
        }

        .card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out;
        }

        .card.expanded .card-content {
            max-height: 2000px;
        }

        .card-body {
            padding: 0 1.5rem 1.5rem;
        }

        .section {
            margin-bottom: 1.5rem;
        }

        .section h3 {
            color: var(--text);
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0.25rem;
        }

        .badge-red {
            background: rgba(231, 76, 60, 0.15);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .badge-amber {
            background: rgba(243, 156, 18, 0.15);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .badge-green {
            background: rgba(39, 174, 96, 0.15);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .list {
            list-style: none;
            margin: 0.5rem 0;
        }

        .list li {
            padding: 0.75rem;
            margin: 0.5rem 0;
            background: var(--light);
            border-radius: 8px;
            border-left: 3px solid var(--secondary);
            transition: var(--transition);
        }

        .list li:hover {
            transform: translateX(4px);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .test-panel {
            background: var(--light);
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--info);
        }

        .test-panel h4 {
            color: var(--text);
            margin-bottom: 0.5rem;
        }

        .test-result {
            font-family: monospace;
            background: rgba(52, 152, 219, 0.1);
            padding: 0.5rem;
            border-radius: 4px;
            margin-top: 0.5rem;
            border: 1px solid var(--border);
        }

        .algorithm-path {
            background: linear-gradient(135deg, var(--light), rgba(39, 174, 96, 0.05));
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 4px solid var(--success);
        }

        .algorithm-step {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin: 1rem 0;
            padding: 1rem;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--success);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .sidebar {
            width: 280px;
            background: var(--card-bg);
            padding: 2rem;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            transition: var(--transition);
        }

        .sidebar h3 {
            margin-bottom: 1rem;
            color: var(--text);
            font-size: 1.2rem;
        }

        .progress-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            margin: 0.5rem 0;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            border-left: 3px solid transparent;
        }

        .progress-item:hover {
            background: var(--light);
        }

        .progress-item.active {
            background: var(--light);
            border-left-color: var(--secondary);
        }

        .progress-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            color: white;
            flex-shrink: 0;
        }

        .progress-text {
            flex: 1;
        }

        .progress-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .progress-desc {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .floating-alert {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--danger);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: var(--shadow-hover);
            transform: translateX(400px);
            transition: var(--transition);
            z-index: 1000;
            max-width: 350px;
        }

        .floating-alert.show {
            transform: translateX(0);
        }

        .alert-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .print-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--secondary);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: var(--shadow-hover);
            font-size: 1.5rem;
            transition: var(--transition);
            z-index: 999;
        }

        .print-btn:hover {
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                box-shadow: none;
            }
            
            .main-content {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                min-width: auto;
            }
        }

        .highlight {
            background: rgba(52, 152, 219, 0.3);
            padding: 0.2rem;
            border-radius: 4px;
        }

        @media print {
            .sidebar, .controls, .print-btn, .floating-alert {
                display: none;
            }
            
            .card {
                box-shadow: none;
                page-break-inside: avoid;
            }
            
            .card-content {
                max-height: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <main class="main-content">
            <div class="header">
                <h1>Secondary Hyperparathyroidism</h1>
                <p>Interactive Clinical Decision Support Algorithm | Last updated: Apr 04, 2024</p>
            </div>

            <div class="controls">
                <input type="text" class="search-box" placeholder="Search algorithm content..." id="searchBox">
                <button class="filter-btn" data-filter="all">All</button>
                <button class="filter-btn" data-filter="urgent">Urgent</button>
                <button class="filter-btn" data-filter="caution">Caution</button>
                <button class="filter-btn" data-filter="routine">Routine</button>
                <button class="theme-toggle" id="themeToggle">üåì</button>
            </div>

            <div class="cards-container" id="cardsContainer">
                <!-- Assessment Card -->
                <div class="card assessment" data-category="routine">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-header-content">
                            <div class="card-icon">ü©∫</div>
                            <div class="card-title">
                                <h2>Assessment</h2>
                                <p>Clinical evaluation and risk stratification</p>
                            </div>
                        </div>
                        <div class="expand-icon">‚ñº</div>
                    </div>
                    <div class="card-content">
                        <div class="card-body">
                            <div class="section">
                                <h3>üîç Key Diagnostic Factors</h3>
                                <ul class="list">
                                    <li><strong>Presence of risk factors:</strong> Increasing age, CKD, vitamin D deficiency, malabsorption syndromes, inadequate sunlight exposure, obesity, or medications</li>
                                    <li><strong>Features of CKD:</strong> Skin discoloration, bruising, pruritus, fluid overload (rales, pericardial rub, edema), fatigue, nausea, poor concentration, myoclonus</li>
                                    <li><strong>Features of malabsorption:</strong> Long-standing GI symptoms (abdominal pain, irregular bowel habits, chronic diarrhea) from Crohn's, celiac disease, chronic pancreatitis, or post-bypass surgery</li>
                                </ul>
                            </div>

                            <div class="section">
                                <h3>‚ö†Ô∏è Other Diagnostic Factors</h3>
                                <ul class="list">
                                    <li><strong>Neuromuscular irritability:</strong> Perioral tingling, paresthesia in fingers/toes, muscle cramps, laryngospasm, tetany, seizures</li>
                                    <li><strong>Physical signs:</strong> Chvostek's sign (facial muscle twitching), Trousseau's sign (carpal spasm)</li>
                                    <li><strong>Skeletal manifestations:</strong> Bone pain (pelvis, hips, legs, lower back, ribs), fractures with minimal trauma, bowed legs/knock knees in children</li>
                                </ul>
                            </div>

                            <div class="section">
                                <h3>üìä First-Line Investigations</h3>
                                <div class="grid-2">
                                    <div class="test-panel">
                                        <h4>Serum Calcium</h4>
                                        <p>First-line test. Must be paired with iPTH.</p>
                                        <div class="test-result">&lt;2.10 mmol/L (&lt;8.4 mg/dL)</div>
                                        <span class="badge badge-red">Critical</span>
                                    </div>
                                    <div class="test-panel">
                                        <h4>Intact PTH (iPTH)</h4>
                                        <p>Definitive test for hyperparathyroidism</p>
                                        <div class="test-result">&gt;88 nanograms/L (&gt;88 pg/mL)</div>
                                        <span class="badge badge-red">Elevated</span>
                                    </div>
                                    <div class="test-panel">
                                        <h4>Serum Creatinine</h4>
                                        <p>Assess renal function</p>
                                        <div class="test-result">&gt;91.5 micromol/L (&gt;1.2 mg/dL)</div>
                                        <span class="badge badge-amber">CKD Indicator</span>
                                    </div>
                                    <div class="test-panel">
                                        <h4>25-hydroxyvitamin D</h4>
                                        <p>Most accurate measure of vitamin D status</p>
                                        <div class="test-result">&lt;40-75 nmol/L (&lt;16-30 ng/mL)</div>
                                        <span class="badge badge-amber">Deficiency</span>
                                    </div>
                                </div>
                            </div>

                            <div class="section">
                                <h3>üî¨ Additional Tests</h3>
                                <ul class="list">
                                    <li><strong>Phosphorus:</strong> Elevated in CKD-related SHPT, low/normal in vitamin D deficiency</li>
                                    <li><strong>Magnesium:</strong> May be abnormal in CKD, can cause PTH resistance</li>
                                    <li><strong>Imaging:</strong> Ultrasound, 99Tc-MIBI SPECT/CT, CT, or MRI if surgery considered</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Diagnosis Card -->
                <div class="card diagnosis" data-category="caution">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-header-content">
                            <div class="card-icon">üî¨</div>
                            <div class="card-title">
                                <h2>Diagnosis</h2>
                                <p>Confirm diagnosis and identify underlying cause</p>
                            </div>
                        </div>
                        <div class="expand-icon">‚ñº</div>
                    </div>
                    <div class="card-content">
                        <div class="card-body">
                            <div class="section">
                                <h3>üí° Diagnostic Approach</h3>
                                <p>Diagnosis is based on clinical picture and metabolic derangements:</p>
                                <ul class="list">
                                    <li><strong>Low serum calcium + high PTH = SHPT</strong></li>
                                    <li><strong>Elevated phosphorus points to CKD as etiology</strong></li>
                                    <li><strong>Normal/low phosphorus suggests vitamin D deficiency</strong></li>
                                    <li><strong>Check 25-hydroxyvitamin D levels</strong> - deficiency is most common cause</li>
                                </ul>
                            </div>

                            <div class="section">
                                <h3>üîÑ Differential Diagnosis</h3>
                                <div class="test-panel">
                                    <h4>Primary Hyperparathyroidism</h4>
                                    <p>Differentiated by calcium level - high in primary, low in secondary</p>
                                    <span class="badge badge-red">Must Exclude</span>
                                </div>
                            </div>

                            <div class="section">
                                <h3>‚ö†Ô∏è Risk Factors - Strong</h3>
                                <ul class="list">
                                    <li><strong>Aging:</strong> PTH increases with age due to renal capacity loss, calcium malabsorption, vitamin D deficiency</li>
                                    <li><strong>CKD:</strong> Most frequent disease association - phosphate retention, loss of 1-alpha-hydroxylase</li>
                                    <li><strong>Vitamin D deficiency:</strong> Inadequate sunlight (housebound, institutionalized, heavy sunblock use), malabsorption, poor intake</li>
                                    <li><strong>Malabsorption syndromes:</strong> Crohn's, celiac disease, chronic pancreatitis, post-gastric bypass</li>
                                </ul>
                            </div>

                            <div class="section">
                                <h3>üìã Additional Risk Factors</h3>
                                <ul class="list">
                                    <li><strong>Obesity:</strong> Vitamin D sequestration in adipose tissue</li>
                                    <li><strong>Medications:</strong> Anticonvulsants (phenytoin, phenobarbital), corticosteroids</li>
                                    <li><strong>Genetic disorders:</strong> Vitamin D-dependent rickets types 1 & 2, X-linked hypophosphatemia</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Treatment Card -->
                <div class="card treatment" data-category="urgent">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-header-content">
                            <div class="card-icon">üíä</div>
                            <div class="card-title">
                                <h2>Treatment</h2>
                                <p>Management based on underlying cause</p>
                            </div>
                        </div>
                        <div class="expand-icon">‚ñº</div>
                    </div>
                    <div class="card-content">
                        <div class="card-body">
                            <div class="section">
                                <h3>üåû Lack of Sunlight-Related SHPT</h3>
                                <div class="algorithm-path">
                                    <div class="algorithm-step">
                                        <div class="step-number">1</div>
                                        <div>
                                            <h4>Safe Sun Exposure</h4>
                                            <p>10-15 min/day between 10 a.m.-3 p.m., spring-fall. Arms/legs or hands/face/arms. Apply SPF 15+ after exposure.</p>
                                            <span class="badge badge-green">First-line</span>
                                        </div>
                                    </div>
                                    <div class="algorithm-step">
                                        <div class="step-number">2</div>
                                        <div>
                                            <h4>Vitamin D Supplementation</h4>
                                            <p>Ergocalciferol or colecalciferol based on deficiency level. Consider multivitamins or fortified foods.</p>
                                            <span class="badge badge-amber">Adjunct</span>
                                        </div>
                                    </div>
                                    <div class="algorithm-step">
                                        <div class="step-number">3</div>
                                        <div>
                                            <h4>Calcium Supplementation</h4>
                                            <p>If dietary intake is poor. Calcium carbonate 1000-1500 mg/day (adults) in divided doses.</p>
                                            <span class="badge badge-amber">If Needed</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="section">
                                <h3>ü§¢ Malabsorption-Related SHPT</h3>
                                <div class="algorithm-path">
                                    <div class="algorithm-step">
                                        <div class="step-number">1</div>
                                        <div>
                                            <h4>Optimize Underlying Disease</h4>
                                            <p>Gluten-free diet for celiac, enzymes for pancreatic insufficiency, anti-inflammatories for IBD</p>
                                            <span class="badge badge-red">Critical</span>
                                        </div>
                                    </div>
                                    <div class="algorithm-step">
                                        <div class="step-number">2</div>
                                        <div>
                                            <h4>UV Exposure</h4>
                                            <p>Sensible sunlight or UV-B emitting light source/tanning bed</p>
                                            <span class="badge badge-green">Effective Alternative</span>
                                        </div>
                                    </div>
                                    <div class="algorithm-step">
                                        <div class="step-number">3</div>
                                        <div>
                                            <h4>Vitamin D & Calcium</h4>
                                            <p>Higher doses may be needed. IM administration sometimes used. Calcium carbonate 2-4 g/day.</p>
                                            <span class="badge badge-amber">High Dose Required</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="section">
                                <h3>üî¥ CKD-Related SHPT (Stages 3-5D)</h3>
                                <div class="algorithm-path">
                                    <h4>Phosphate Management</h4>
                                    <div class="algorithm-step">
                                        <div class="step-number">1</div>
                                        <div>
                                            <h4>Dietary Phosphate Restriction</h4>
                                            <p>800-1000 mg/day in adults. Avoid dairy, organ meats, fish with bones, colas, additives.</p>
                                            <span class="badge badge-green">First-line</span>
                                        </div>
                                    </div>
                                    <div class="algorithm-step">
                                        <div class="step-number">2</div>
                                        <div>
                                            <h4>Phosphate Binders</h4>
                                            <p><strong>First-line:</strong> Calcium acetate (NICE recommendation)</p>
                                            <p><strong>Alternatives:</strong> Sevelamer, lanthanum, iron-based binders</p>
                                            <p><strong>Avoid:</strong> Aluminum-based binders long-term</p>
                                            <span class="badge badge-amber">If Diet Insufficient</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="algorithm-path" style="margin-top: 1rem;">
                                    <h4>Vitamin D Management</h4>
                                    <div class="algorithm-step">
                                        <div class="step-number">1</div>
                                        <div>
                                            <h4>Correct Vitamin D Deficiency</h4>
                                            <p>Ergocalciferol or colecalciferol if 25-hydroxyvitamin D &lt;75 nmol/L. Check levels annually once replete.</p>
                                            <span class="badge badge-green">Essential Step</span>
                                        </div>
                                    </div>
                                    <div class="algorithm-step">
                                        <div class="step-number">2</div>
                                        <div>
                                            <h4>Active Vitamin D Sterols</h4>
                                            <p>Calcitriol, doxercalciferol, paricalcitol, or alfacalcidol when PTH persists despite correction of deficiency, hyperphosphatemia, and hypocalcemia</p>
                                            <span class="badge badge-amber">Specialist Use</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="algorithm-path" style="margin-top: 1rem;">
                                    <h4>Calcium Management</h4>
                                    <div class="algorithm-step">
                                        <div class="step-number">1</div>
                                        <div>
                                            <h4>Maintain Normal Calcium</h4>
                                            <p>Target corrected total calcium within normal lab range</p>
                                            <span class="badge badge-green">Monitor Monthly</span>
                                        </div>
                                    </div>
                                    <div class="algorithm-step">
                                        <div class="step-number">2</div>
                                        <div>
                                            <h4>Treat Hypocalcemia</h4>
                                            <p>Calcium salts (carbonate or acetate orally, gluconate IV) ¬± vitamin D sterol</p>
                                            <span class="badge badge-red">If Significant/Symptomatic</span>
                                        </div>
                                    </div>
                                    <div class="algorithm-step">
                                        <div class="step-number">3</div>
                                        <div>
                                            <h4>Manage Hypercalcemia</h4>
                                            <p>Switch to non-calcium-based phosphate binders, reduce/discontinue vitamin D</p>
                                            <span class="badge badge-red">Adjust Therapy</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="algorithm-path" style="margin-top: 1rem;">
                                    <h4>Persistently Elevated PTH</h4>
                                    <div class="algorithm-step">
                                        <div class="step-number">1</div>
                                        <div>
                                            <h4>Calcimimetic Therapy</h4>
                                            <p><strong>Cinacalcet:</strong> 30 mg daily, titrate up to 180 mg (CKD 5D only)</p>
                                            <p><strong>Etelcalcetide:</strong> IV 5 mg 3x/week after dialysis (alternative if oral not tolerated)</p>
                                            <p>Bind to CaSR, increase sensitivity to calcium, rapidly lower PTH</p>
                                            <span class="badge badge-amber">Specialist Drug</span>
                                        </div>
                                    </div>
                                    <div class="algorithm-step">
                                        <div class="step-number">2</div>
                                        <div>
                                            <h4>Parathyroidectomy</h4>
                                            <p>Indicated for PTH &gt;9x ULN with hypercalcemia/hyperphosphatemia refractory to medical therapy</p>
                                            <p><strong>Options:</strong> Subtotal parathyroidectomy or total with auto-transplantation</p>
                                            <span class="badge badge-red">Refractory Cases</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="section">
                                <h3>‚ö†Ô∏è Important Considerations</h3>
                                <ul class="list">
                                    <li><strong>Post-op Monitoring:</strong> Check ionized calcium q4-6h for 48-72h after parathyroidectomy</li>
                                    <li><strong>Pre-op Vitamin D:</strong> Consider calcitriol 72h before surgery to lessen post-op hypocalcemia</li>
                                    <li><strong>Calciphylaxis Risk:</strong> Calcium-phosphate product ‚â•70 increases risk - cinacalcet may reduce risk</li>
                                    <li><strong>Monitoring:</strong> Calcium, phosphorus monthly √ó3 months, then q3 months; PTH q3 months √ó6 months, then q3 months</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Follow-up Card -->
                <div class="card follow-up" data-category="routine">
                    <div class="card-header" onclick="toggleCard(this)">
                        <div class="card-header-content">
                            <div class="card-icon">üìà</div>
                            <div class="card-title">
                                <h2>Follow-up & Monitoring</h2>
                                <p>Long-term management and complication surveillance</p>
                            </div>
                        </div>
                        <div class="expand-icon">‚ñº</div>
                    </div>
                    <div class="card-content">
                        <div class="card-body">
                            <div class="section">
                                <h3>üîç Monitoring Schedule</h3>
                                <div class="grid-2">
                                    <div class="test-panel">
                                        <h4>CKD Patients (Stages 3-5)</h4>
                                        <ul style="list-style: disc; margin-left: 1rem;">
                                            <li>Electrolytes (Ca, P, Mg): <strong>Monthly √ó3 months</strong>, then <strong>q3 months</strong></li>
                                            <li>PTH: <strong>q3 months √ó6 months</strong>, then <strong>q3 months</strong></li>
                                            <li>25-hydroxyvitamin D: <strong>Annually</strong> once replete</li>
                                        </ul>
                                        <span class="badge badge-amber">Regular Monitoring</span>
                                    </div>
                                    <div class="test-panel">
                                        <h4>Post-Parathyroidectomy</h4>
                                        <ul style="list-style: disc; margin-left: 1rem;">
                                            <li>Ionized calcium: <strong>q4-6h for 48-72h</strong></li>
                                            <li>Then twice daily until stable</li>
                                            <li>Calcium gluconate infusion if &lt;0.9 mmol/L</li>
                                        </ul>
                                        <span class="badge badge-red">Critical Period</span>
                                    </div>
                                </div>
                            </div>

                            <div class="section">
                                <h3>‚ö†Ô∏è Potential Complications</h3>
                                <ul class="list">
                                    <li>
                                        <strong>Renal Osteodystrophy</strong> - High likelihood long-term
                                        <p>U-shaped association with fracture risk. Extremely low or high PTH increases fracture risk. Bone biopsy rarely needed.</p>
                                        <span class="badge badge-amber">Monitor via PTH trends</span>
                                    </li>
                                    <li>
                                        <strong>Osteoporosis</strong> - High likelihood long-term
                                        <p>Loss of bone mass from dysregulated bone formation/resorption. Bone densitometry can monitor but poor predictor in CKD 4-5.</p>
                                        <span class="badge badge-amber">Coexists with renal osteodystrophy</span>
                                    </li>
                                    <li>
                                        <strong>Calciphylaxis</strong> - Low likelihood but lethal
                                        <p>Vascular calcification causing tissue ischemia/necrosis. Mortality 60-87%. Associated with Ca-P product ‚â•70, warfarin, protein C/S deficiency.</p>
                                        <span class="badge badge-red">Medical Emergency</span>
                                    </li>
                                </ul>
                            </div>

                            <div class="section">
                                <h3>üìä Prognosis</h3>
                                <p>Outlook mirrors underlying disease:</p>
                                <ul class="list">
                                    <li><strong>CKD patients:</strong> Aggressive management optimizes outcomes; calcimimetics have reduced surgery frequency</li>
                                    <li><strong>Post-transplant:</strong> May persist as tertiary hyperparathyroidism and damage new kidney</li>
                                    <li><strong>Surgery:</strong> Reduces PTH but rarely curative; 28% reduction in all-cause mortality, 37% reduction in CV mortality</li>
                                    <li><strong>Vitamin D deficiency:</strong> Reversible with supplementation and sun exposure</li>
                                </ul>
                            </div>

                            <div class="section">
                                <h3>üìö Clinical Guidelines</h3>
                                <div class="grid-2">
                                    <div class="test-panel">
                                        <h4>Diagnostic Guidelines</h4>
                                        <ul style="list-style: disc; margin-left: 1rem; font-size: 0.9rem;">
                                            <li><strong>KDIGO 2017:</strong> CKD-MBD evaluation</li>
                                            <li><strong>NICE NG203:</strong> CKD assessment & management</li>
                                            <li><strong>EANM 2021:</strong> Parathyroid imaging</li>
                                            <li><strong>Endocrine Society 2011:</strong> Vitamin D deficiency evaluation</li>
                                        </ul>
                                    </div>
                                    <div class="test-panel">
                                        <h4>Treatment Guidelines</h4>
                                        <ul style="list-style: disc; margin-left: 1rem; font-size: 0.9rem;">
                                            <li><strong>KDIGO 2017:</strong> CKD-MBD treatment</li>
                                            <li><strong>NICE NG203:</strong> CKD management (calcium acetate first-line)</li>
                                            <li><strong>Endocrine Society 2011:</strong> Vitamin D deficiency treatment</li>
                                            <li><strong>CARI 2006:</strong> Vitamin D, calcimimetics, phosphate binders</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="section">
                                <h3>üí¨ Patient Education</h3>
                                <ul class="list">
                                    <li><strong>Adherence:</strong> Emphasize importance of phosphate binders, vitamin D, and calcium supplements</li>
                                    <li><strong>Diet:</strong> Low-phosphate diet without causing malnutrition - dietician involvement crucial</li>
                                    <li><strong>Sun exposure:</strong> Safe, limited exposure benefits vitamin D status</li>
                                    <li><strong>Cardiovascular risk:</strong> Control hypertension, diabetes, stop smoking</li>
                                    <li><strong>Symptom monitoring:</strong> Report bone pain, fractures, muscle cramps, skin changes</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <aside class="sidebar">
            <h3>Algorithm Progress</h3>
            <div id="progressItems">
                <div class="progress-item" data-card="assessment">
                    <div class="progress-icon" style="background: var(--secondary);">ü©∫</div>
                    <div class="progress-text">
                        <div class="progress-title">Assessment</div>
                        <div class="progress-desc">Clinical evaluation & investigations</div>
                    </div>
                </div>
                <div class="progress-item" data-card="diagnosis">
                    <div class="progress-icon" style="background: var(--info);">üî¨</div>
                    <div class="progress-text">
                        <div class="progress-title">Diagnosis</div>
                        <div class="progress-desc">Confirm diagnosis & differentials</div>
                    </div>
                </div>
                <div class="progress-item" data-card="treatment">
                    <div class="progress-icon" style="background: var(--success);">üíä</div>
                    <div class="progress-text">
                        <div class="progress-title">Treatment</div>
                        <div class="progress-desc">Management by underlying cause</div>
                    </div>
                </div>
                <div class="progress-item" data-card="follow-up">
                    <div class="progress-icon" style="background: var(--warning);">üìà</div>
                    <div class="progress-text">
                        <div class="progress-title">Follow-up</div>
                        <div class="progress-desc">Monitoring & complications</div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--border);">
                <h3 style="margin-bottom: 1rem;">Quick Actions</h3>
                <button class="filter-btn" onclick="expandAll()" style="width: 100%; margin-bottom: 0.5rem;">Expand All</button>
                <button class="filter-btn" onclick="collapseAll()" style="width: 100%; margin-bottom: 0.5rem;">Collapse All</button>
                <button class="filter-btn" onclick="resetView()" style="width: 100%;">Reset View</button>
            </div>

            <div style="margin-top: 2rem; font-size: 0.8rem; color: var(--text-light);">
                <p><strong>Legend:</strong></p>
                <div style="display: flex; align-items: center; gap: 0.5rem; margin: 0.5rem 0;">
                    <span class="badge badge-red">Urgent</span> - Immediate action required
                </div>
                <div style="display: flex; align-items: center; gap: 0.5rem; margin: 0.5rem 0;">
                    <span class="badge badge-amber">Caution</span> - Careful monitoring needed
                </div>
                <div style="display: flex; align-items: center; gap: 0.5rem; margin: 0.5rem 0;">
                    <span class="badge badge-green">Routine</span> - Standard management
                </div>
            </div>
        </aside>
    </div>

    <button class="print-btn" onclick="window.print()" title="Print Algorithm">üñ®Ô∏è</button>

    <div class="floating-alert" id="alertBox">
        <div class="alert-header">
            <span>‚ö†Ô∏è</span>
            <span>Clinical Decision Support</span>
        </div>
        <p id="alertText">This algorithm is for educational purposes. Always consult local guidelines and specialist advice.</p>
    </div>

    <script>
        // Theme Management
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            html.setAttribute('data-theme', savedTheme);
        }

        themeToggle.addEventListener('click', () => {
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });

        // Card Management
        function toggleCard(header) {
            const card = header.parentElement;
            const isExpanded = card.classList.contains('expanded');
            
            // Close all other cards
            document.querySelectorAll('.card').forEach(c => {
                if (c !== card) {
                    c.classList.remove('expanded');
                }
            });
            
            // Toggle current card
            card.classList.toggle('expanded');
            
            // Update progress
            updateProgress();
            
            // Scroll to card
            if (!isExpanded) {
                setTimeout(() => {
                    card.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }
        }

        function expandAll() {
            document.querySelectorAll('.card').forEach(card => {
                card.classList.add('expanded');
            });
            updateProgress();
        }

        function collapseAll() {
            document.querySelectorAll('.card').forEach(card => {
                card.classList.remove('expanded');
            });
            updateProgress();
        }

        function resetView() {
            collapseAll();
            document.getElementById('searchBox').value = '';
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.filter === 'all') btn.classList.add('active');
            });
            filterCards('all');
            clearHighlights();
        }

        // Progress Management
        function updateProgress() {
            const cards = document.querySelectorAll('.card');
            const progressItems = document.querySelectorAll('.progress-item');
            
            cards.forEach((card, index) => {
                if (card.classList.contains('expanded')) {
                    progressItems[index].classList.add('active');
                } else {
                    progressItems[index].classList.remove('active');
                }
            });
        }

        // Search Functionality
        const searchBox = document.getElementById('searchBox');
        searchBox.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            if (searchTerm.length > 2) {
                highlightSearchTerm(searchTerm);
            } else {
                clearHighlights();
            }
        });

        function highlightSearchTerm(term) {
            clearHighlights();
            const content = document.querySelectorAll('.card-content');
            content.forEach(section => {
                const textNodes = getTextNodes(section);
                textNodes.forEach(node => {
                    if (node.nodeValue.toLowerCase().includes(term)) {
                        const span = document.createElement('span');
                        span.className = 'highlight';
                        span.textContent = node.nodeValue;
                        node.parentNode.replaceChild(span, node);
                    }
                });
            });
        }

        function clearHighlights() {
            document.querySelectorAll('.highlight').forEach(span => {
                const text = document.createTextNode(span.textContent);
                span.parentNode.replaceChild(text, span);
            });
        }

        function getTextNodes(element) {
            const nodes = [];
            const walker = document.createTreeWalker(
                element,
                NodeFilter.SHOW_TEXT,
                null,
                false
            );
            let node;
            while (node = walker.nextNode()) {
                if (node.nodeValue.trim()) {
                    nodes.push(node);
                }
            }
            return nodes;
        }

        // Filter Functionality
        const filterButtons = document.querySelectorAll('.filter-btn[data-filter]');
        filterButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                filterButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                filterCards(btn.dataset.filter);
            });
        });

        function filterCards(filter) {
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                if (filter === 'all') {
                    card.style.display = 'block';
                } else {
                    const category = card.dataset.category;
                    if (filter === 'urgent' && category === 'urgent') {
                        card.style.display = 'block';
                    } else if (filter === 'caution' && category === 'caution') {
                        card.style.display = 'block';
                    } else if (filter === 'routine' && category === 'routine') {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                }
            });
        }

        // Progress item navigation
        document.querySelectorAll('.progress-item').forEach(item => {
            item.addEventListener('click', () => {
                const cardClass = item.dataset.card;
                const card = document.querySelector(`.card.${cardClass}`);
                if (card) {
                    card.classList.add('expanded');
                    card.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    updateProgress();
                }
            });
        });

        // Alert management
        function showAlert(message, duration = 5000) {
            const alertBox = document.getElementById('alertBox');
            const alertText = document.getElementById('alertText');
            alertText.textContent = message;
            alertBox.classList.add('show');
            setTimeout(() => {
                alertBox.classList.remove('show');
            }, duration);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            
            // Show initial alert
            setTimeout(() => {
                showAlert('Secondary hyperparathyroidism is most commonly due to vitamin D deficiency or CKD. Always verify calcium and PTH levels simultaneously.', 8000);
            }, 2000);

            // Auto-expand first card
            document.querySelector('.card.assessment').classList.add('expanded');
            updateProgress();

            // Check for CKD-related alerts
            const ckdElements = document.querySelectorAll('.badge-red');
            if (ckdElements.length > 0) {
                setTimeout(() => {
                    showAlert('CKD-related SHPT requires aggressive phosphate management and careful monitoring of calcium, phosphorus, and PTH levels.', 7000);
                }, 5000);
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'f':
                        e.preventDefault();
                        document.getElementById('searchBox').focus();
                        break;
                    case 'p':
                        e.preventDefault();
                        window.print();
                        break;
                    case 'e':
                        e.preventDefault();
                        expandAll();
                        break;
                }
            }
        });

        // Intersection Observer for scroll tracking
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    updateProgress();
                }
            });
        }, { threshold: 0.5 });

        document.querySelectorAll('.card').forEach(card => {
            observer.observe(card);
        });

        // Save state to localStorage
        function saveState() {
            const state = {
                expandedCards: Array.from(document.querySelectorAll('.card.expanded')).map(c => c.classList[1]),
                theme: html.getAttribute('data-theme'),
                searchTerm: searchBox.value,
                activeFilter: document.querySelector('.filter-btn.active')?.dataset.filter || 'all'
            };
            localStorage.setItem('shptAlgorithmState', JSON.stringify(state));
        }

        function loadState() {
            const saved = localStorage.getItem('shptAlgorithmState');
            if (saved) {
                const state = JSON.parse(saved);
                // Restore theme
                html.setAttribute('data-theme', state.theme);
                // Restore search
                searchBox.value = state.searchTerm;
                if (state.searchTerm) highlightSearchTerm(state.searchTerm);
                // Restore filters
                document.querySelector('.filter-btn.active')?.classList.remove('active');
                document.querySelector(`[data-filter="${state.activeFilter}"]`)?.classList.add('active');
                filterCards(state.activeFilter);
                // Restore expanded cards
                state.expandedCards.forEach(className => {
                    document.querySelector(`.card.${className}`)?.classList.add('expanded');
                });
            }
        }

        // Save state on changes
        document.addEventListener('click', saveState);
        searchBox.addEventListener('input', () => {
            setTimeout(saveState, 500);
        });

        // Load state on page load
        window.addEventListener('load', loadState);

        // Periodic reminders
        setInterval(() => {
            const alerts = [
                'Remember to check both calcium and PTH levels simultaneously for accurate diagnosis.',
                'Vitamin D deficiency is the most common cause of SHPT - check 25-hydroxyvitamin D levels.',
                'PTH levels vary throughout the day, peaking at ~2 a.m.',
                'In CKD, phosphate binders should be initiated when PTH and FGF-23 levels rise.',
                'Calciphylaxis risk increases with calcium-phosphate product ‚â•70.'
            ];
            const randomAlert = alerts[Math.floor(Math.random() * alerts.length)];
            showAlert(randomAlert, 6000);
        }, 30000); // Every 30 seconds
    </script>
</body>
</html>