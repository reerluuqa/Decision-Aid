<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allergic Rhinitis Interactive Algorithm - NICE CKS</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #005EB8;
            --navy-blue: #003087;
            --light-blue: #E8F4F8;
            --accent-teal: #00A19B;
            --success-green: #4CAF50;
            --warning-amber: #FF9800;
            --danger-red: #F44336;
            --info-purple: #9C27B0;
            --text-dark: #2C3E50;
            --text-light: #7F8C8D;
            --background: #F5F7FA;
            --card-bg: #FFFFFF;
            --border: #E1E8ED;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background);
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-blue), var(--navy-blue));
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 4px 12px var(--shadow);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: var(--card-bg);
            padding: 2rem 1.5rem;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            border-right: 1px solid var(--border);
            box-shadow: 2px 0 10px var(--shadow);
            z-index: 10;
        }

        .sidebar h3 {
            color: var(--primary-blue);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .progress-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            background: var(--light-blue);
        }

        .progress-item:hover {
            background: var(--light-blue);
            transform: translateX(5px);
        }

        .progress-item.active {
            background: var(--primary-blue);
            color: white;
        }

        .progress-item.completed {
            background: var(--success-green);
            color: white;
        }

        .progress-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .progress-item.active .progress-icon {
            background: white;
            color: var(--primary-blue);
        }

        .progress-item.completed .progress-icon {
            background: white;
            color: var(--success-green);
        }

        .progress-line {
            position: absolute;
            left: 35px;
            top: 60px;
            width: 2px;
            height: 40px;
            background: var(--border);
            z-index: -1;
        }

        .progress-item:last-child .progress-line {
            display: none;
        }

        .progress-item.completed .progress-line {
            background: var(--success-green);
        }

        .main-content {
            flex: 1;
            padding: 2rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 12px var(--shadow);
            margin-bottom: 2rem;
            overflow: hidden;
            transition: all 0.3s ease;
            border-left: 5px solid transparent;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px var(--shadow);
        }

        .card.assessment {
            border-left-color: var(--info-purple);
        }

        .card.diagnosis {
            border-left-color: var(--accent-teal);
        }

        .card.treatment {
            border-left-color: var(--success-green);
        }

        .card.followup {
            border-left-color: var(--warning-amber);
        }

        .card-header {
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            user-select: none;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .assessment .card-icon {
            background: var(--info-purple);
        }

        .diagnosis .card-icon {
            background: var(--accent-teal);
        }

        .treatment .card-icon {
            background: var(--success-green);
        }

        .followup .card-icon {
            background: var(--warning-amber);
        }

        .card-title {
            flex: 1;
        }

        .card-title h2 {
            color: var(--text-dark);
            margin-bottom: 0.25rem;
        }

        .card-title p {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .expand-icon {
            transition: transform 0.3s ease;
            color: var(--text-light);
        }

        .card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .card.expanded .card-content {
            max-height: 2000px;
        }

        .card-body {
            padding: 0 1.5rem 1.5rem;
        }

        .feature-list {
            list-style: none;
            margin: 1rem 0;
        }

        .feature-list li {
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .feature-list li:last-child {
            border-bottom: none;
        }

        .feature-list i {
            color: var(--primary-blue);
            margin-top: 0.2rem;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 0.25rem;
            transition: all 0.2s ease;
        }

        .badge:hover {
            transform: scale(1.05);
        }

        .badge.urgent {
            background: var(--danger-red);
            color: white;
        }

        .badge.caution {
            background: var(--warning-amber);
            color: white;
        }

        .badge.stable {
            background: var(--success-green);
            color: white;
        }

        .badge.info {
            background: var(--primary-blue);
            color: white;
        }

        .decision-tree {
            background: var(--light-blue);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .decision-node {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 0.5rem 0;
            border-left: 4px solid var(--primary-blue);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .decision-node:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .medication-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .medication-card {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .medication-card:hover {
            border-color: var(--primary-blue);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .medication-card h4 {
            color: var(--primary-blue);
            margin-bottom: 0.5rem;
        }

        .medication-card .dose {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--navy-blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .btn-secondary {
            background: var(--accent-teal);
            color: white;
        }

        .btn-secondary:hover {
            background: #008B8B;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .severity-scale {
            display: flex;
            justify-content: space-between;
            margin: 1rem 0;
            padding: 1rem;
            background: white;
            border-radius: 8px;
        }

        .severity-item {
            text-align: center;
            flex: 1;
            padding: 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .severity-item:hover {
            transform: scale(1.05);
        }

        .severity-item.mild {
            background: var(--success-green);
            color: white;
        }

        .severity-item.moderate {
            background: var(--warning-amber);
            color: white;
        }

        .severity-item.severe {
            background: var(--danger-red);
            color: white;
        }

        .expandable-section {
            margin: 1rem 0;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .expandable-header {
            padding: 1rem;
            background: var(--light-blue);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .expandable-header:hover {
            background: #D1E7F0;
        }

        .expandable-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: white;
        }

        .expandable-section.expanded .expandable-content {
            max-height: 500px;
            padding: 1rem;
        }

        .referral-criteria {
            background: linear-gradient(135deg, #FFF3CD, #FFEAA7);
            border: 1px solid #F0C40A;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .referral-criteria h4 {
            color: #856404;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .referral-criteria ul {
            list-style: none;
            padding-left: 0;
        }

        .referral-criteria li {
            padding: 0.5rem 0;
            color: #856404;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .referral-criteria i {
            margin-top: 0.2rem;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                position: static;
                height: auto;
                border-right: none;
                border-bottom: 1px solid var(--border);
            }

            .header h1 {
                font-size: 1.8rem;
                flex-direction: column;
            }

            .medication-grid {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 94, 184, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0, 94, 184, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 94, 184, 0); }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-lungs"></i> Allergic Rhinitis Interactive Algorithm</h1>
        <p>Based on NICE Clinical Knowledge Summaries (CKS) - Last revised January 2024</p>
    </div>

    <div class="container">
        <aside class="sidebar">
            <h3><i class="fas fa-map-marked-alt"></i> Algorithm Navigator</h3>
            <div class="progress-item active" data-step="assessment">
                <div class="progress-icon">
                    <i class="fas fa-clipboard-check"></i>
                </div>
                <div>
                    <strong>Assessment</strong>
                    <div style="font-size: 0.85rem; opacity: 0.8;">Initial evaluation</div>
                </div>
                <div class="progress-line"></div>
            </div>
            <div class="progress-item" data-step="diagnosis">
                <div class="progress-icon">
                    <i class="fas fa-search"></i>
                </div>
                <div>
                    <strong>Diagnosis</strong>
                    <div style="font-size: 0.85rem; opacity: 0.8;">Confirm condition</div>
                </div>
                <div class="progress-line"></div>
            </div>
            <div class="progress-item" data-step="treatment">
                <div class="progress-icon">
                    <i class="fas fa-pills"></i>
                </div>
                <div>
                    <strong>Treatment</strong>
                    <div style="font-size: 0.85rem; opacity: 0.8;">Management options</div>
                </div>
                <div class="progress-line"></div>
            </div>
            <div class="progress-item" data-step="followup">
                <div class="progress-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div>
                    <strong>Follow-up</strong>
                    <div style="font-size: 0.85rem; opacity: 0.8;">Monitor progress</div>
                </div>
            </div>

            <div style="margin-top: 2rem; padding: 1rem; background: var(--light-blue); border-radius: 8px;">
                <h4 style="color: var(--primary-blue); margin-bottom: 0.5rem;"><i class="fas fa-info-circle"></i> Quick Tips</h4>
                <ul style="list-style: none; font-size: 0.85rem;">
                    <li style="padding: 0.25rem 0;"><i class="fas fa-mouse-pointer"></i> Click cards to expand</li>
                    <li style="padding: 0.25rem 0;"><i class="fas fa-map-marker-alt"></i> Use sidebar to navigate</li>
                    <li style="padding: 0.25rem 0;"><i class="fas fa-exclamation-triangle"></i> Watch for colored badges</li>
                </ul>
            </div>
        </aside>

        <main class="main-content">
            <!-- Assessment Card -->
            <div class="card assessment fade-in" id="assessment-card">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-icon">
                        <i class="fas fa-clipboard-check"></i>
                    </div>
                    <div class="card-title">
                        <h2>Assessment</h2>
                        <p>Comprehensive evaluation of patient symptoms and history</p>
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-body">
                        <div class="severity-scale">
                            <div class="severity-item mild" onclick="showSeverityInfo('mild')">
                                <i class="fas fa-leaf"></i>
                                <h4>Mild</h4>
                                <p>No sleep disturbance</p>
                            </div>
                            <div class="severity-item moderate" onclick="showSeverityInfo('moderate')">
                                <i class="fas fa-cloud"></i>
                                <h4>Moderate</h4>
                                <p>Affects daily activities</p>
                            </div>
                            <div class="severity-item severe" onclick="showSeverityInfo('severe')">
                                <i class="fas fa-bolt"></i>
                                <h4>Severe</h4>
                                <p>Sleep significantly affected</p>
                            </div>
                        </div>

                        <h3><i class="fas fa-question-circle"></i> Key Assessment Questions</h3>
                        <ul class="feature-list">
                            <li>
                                <i class="fas fa-allergies"></i>
                                <div>
                                    <strong>Symptom Pattern:</strong> Sneezing, nasal itching, rhinorrhea, congestion?
                                    <div style="font-size: 0.85rem; color: var(--text-light);">Bilateral symptoms developing within minutes of allergen exposure</div>
                                </div>
                            </li>
                            <li>
                                <i class="fas fa-clock"></i>
                                <div>
                                    <strong>Timing & Duration:</strong> When do symptoms occur? How long do they last?
                                    <div style="font-size: 0.85rem; color: var(--text-light);">Intermittent (<4 days/week) vs Persistent (≥4 days/week)</div>
                                </div>
                            </li>
                            <li>
                                <i class="fas fa-map-marker-alt"></i>
                                <div>
                                    <strong>Environmental Factors:</strong> Triggers at home, work, or outdoors?
                                    <div style="font-size: 0.85rem; color: var(--text-light);">Pollen, house dust mites, pets, occupational exposures</div>
                                </div>
                            </li>
                            <li>
                                <i class="fas fa-bed"></i>
                                <div>
                                    <strong>Impact on Life:</strong> Sleep disturbance? School/work performance?
                                    <div style="font-size: 0.85rem; color: var(--text-light);">Quality of life assessment</div>
                                </div>
                            </li>
                            <li>
                                <i class="fas fa-family"></i>
                                <div>
                                    <strong>Family History:</strong> Any atopy in first-degree relatives?
                                    <div style="font-size: 0.85rem; color: var(--text-light);">Asthma, eczema, or allergic rhinitis</div>
                                </div>
                            </li>
                        </ul>

                        <div class="expandable-section">
                            <div class="expandable-header" onclick="toggleExpandable(this)">
                                <span><i class="fas fa-stethoscope"></i> Physical Examination</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="expandable-content">
                                <ul class="feature-list">
                                    <li><i class="fas fa-check"></i> <strong>Nasal Mucosa:</strong> Pale, swollen with clear secretions (typical in allergic rhinitis)</li>
                                    <li><i class="fas fa-check"></i> <strong>Nasal Polyps:</strong> Rare in children</li>
                                    <li><i class="fas fa-check"></i> <strong>Eye Examination:</strong> Look for allergic conjunctivitis</li>
                                    <li><i class="fas fa-check"></i> <strong>Facial Features:</strong> Allergic shiners, nasal crease, mouth breathing</li>
                                    <li><i class="fas fa-check"></i> <strong>Growth Assessment:</strong> Essential in children (height measurement)</li>
                                </ul>
                            </div>
                        </div>

                        <div class="referral-criteria">
                            <h4><i class="fas fa-exclamation-triangle"></i> Red Flags - Urgent ENT Referral</h4>
                            <ul>
                                <li><i class="fas fa-asterisk"></i> Unilateral symptoms</li>
                                <li><i class="fas fa-asterisk"></i> Blood-stained nasal discharge</li>
                                <li><i class="fas fa-asterisk"></i> Recurrent epistaxis</li>
                                <li><i class="fas fa-asterisk"></i> Nasal pain</li>
                            </ul>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" onclick="showInvestigations()">
                                <i class="fas fa-microscope"></i> Investigations
                            </button>
                            <button class="btn btn-secondary" onclick="showDifferential()">
                                <i class="fas fa-not-equal"></i> Differential Diagnosis
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Diagnosis Card -->
            <div class="card diagnosis fade-in" id="diagnosis-card">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <div class="card-title">
                        <h2>Diagnosis</h2>
                        <p>Confirm allergic rhinitis and classify severity</p>
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-body">
                        <h3><i class="fas fa-diagnoses"></i> Diagnostic Criteria</h3>
                        <p>Allergic rhinitis can usually be diagnosed from the clinical history, supported by nasal examination and response to first-line treatment.</p>

                        <div class="decision-tree">
                            <div class="decision-node" onclick="toggleDecision(this)">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <strong>Classic Symptoms Present?</strong>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="expandable-content">
                                    <ul style="margin-top: 0.5rem;">
                                        <li>Sneezing episodes</li>
                                        <li>Nasal itching</li>
                                        <li>Watery rhinorrhea</li>
                                        <li>Nasal congestion (bilateral)</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="decision-node" onclick="toggleDecision(this)">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <strong>Temporal Pattern Consistent?</strong>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="expandable-content">
                                    <ul style="margin-top: 0.5rem;">
                                        <li><strong>Seasonal:</strong> Spring (tree pollen), Summer (grass pollen)</li>
                                        <li><strong>Perennial:</strong> Year-round with environmental variation</li>
                                        <li><strong>Occupational:</strong> Improves away from work</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="decision-node" onclick="toggleDecision(this)">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <strong>Response to Treatment?</strong>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="expandable-content">
                                    <p style="margin-top: 0.5rem;">Consider therapeutic trial with intranasal corticosteroid or antihistamine</p>
                                </div>
                            </div>
                        </div>

                        <h3><i class="fas fa-layer-group"></i> Classification</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin: 1rem 0;">
                            <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--success-green);">
                                <h4 style="color: var(--success-green);"><i class="fas fa-clock"></i> By Duration</h4>
                                <ul style="list-style: none; margin-top: 0.5rem;">
                                    <li><i class="fas fa-calendar-day"></i> <strong>Intermittent:</strong> <4 days/week or <4 weeks</li>
                                    <li><i class="fas fa-calendar-week"></i> <strong>Persistent:</strong> ≥4 days/week and ≥4 weeks</li>
                                </ul>
                            </div>
                            <div style="background: white; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--warning-amber);">
                                <h4 style="color: var(--warning-amber);"><i class="fas fa-thermometer-half"></i> By Severity</h4>
                                <ul style="list-style: none; margin-top: 0.5rem;">
                                    <li><i class="fas fa-smile"></i> <strong>Mild:</strong> No sleep disturbance, normal daily activities</li>
                                    <li><i class="fas fa-frown"></i> <strong>Moderate-Severe:</strong> Sleep and/or daily activities affected</li>
                                </ul>
                            </div>
                        </div>

                        <h3><i class="fas fa-microscope"></i> Investigations</h3>
                        <div class="expandable-section">
                            <div class="expandable-header" onclick="toggleExpandable(this)">
                                <span><i class="fas fa-flask"></i> When to Investigate?</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="expandable-content">
                                <p>Further investigations are usually only required if:</p>
                                <ul class="feature-list">
                                    <li><i class="fas fa-question"></i> The allergen causing symptoms can be avoided</li>
                                    <li><i class="fas fa-question"></i> There are elements leading to diagnostic doubt</li>
                                    <li><i class="fas fa-question"></i> There is a lack of response to treatment</li>
                                </ul>
                            </div>
                        </div>

                        <div class="expandable-section">
                            <div class="expandable-header" onclick="toggleExpandable(this)">
                                <span><i class="fas fa-vial"></i> Allergy Testing Options</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="expandable-content">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                    <div style="background: white; padding: 1rem; border-radius: 8px;">
                                        <h4 style="color: var(--primary-blue);"><i class="fas fa-syringe"></i> Skin Prick Testing</h4>
                                        <ul style="list-style: none; font-size: 0.9rem;">
                                            <li><i class="fas fa-check" style="color: var(--success-green);"></i> High negative predictive value</li>
                                            <li><i class="fas fa-check" style="color: var(--success-green);"></i> Immediate results</li>
                                            <li><i class="fas fa-times" style="color: var(--danger-red);"></i> May be suppressed by antihistamines</li>
                                        </ul>
                                    </div>
                                    <div style="background: white; padding: 1rem; border-radius: 8px;">
                                        <h4 style="color: var(--primary-blue);"><i class="fas fa-tint"></i> Serum IgE Testing</h4>
                                        <ul style="list-style: none; font-size: 0.9rem;">
                                            <li><i class="fas fa-check" style="color: var(--success-green);"></i> Used when skin testing not possible</li>
                                            <li><i class="fas fa-check" style="color: var(--success-green);"></i> Not affected by antihistamines</li>
                                            <li><i class="fas fa-info" style="color: var(--warning-amber);"></i> Levels don't correlate with clinical reaction</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" onclick="showManagementPathway()">
                                <i class="fas fa-route"></i> Management Pathway
                            </button>
                            <button class="btn btn-secondary" onclick="showReferralCriteria()">
                                <i class="fas fa-hospital-alt"></i> Referral Criteria
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Treatment Card -->
            <div class="card treatment fade-in" id="treatment-card">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-icon">
                        <i class="fas fa-pills"></i>
                    </div>
                    <div class="card-title">
                        <h2>Treatment</h2>
                        <p>Evidence-based management strategies</p>
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-body">
                        <h3><i class="fas fa-leaf"></i> Self-Management Strategies</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin: 1rem 0;">
                            <div style="background: var(--light-blue); padding: 1rem; border-radius: 8px;">
                                <h4><i class="fas fa-tree-pollen"></i> Pollen Avoidance</h4>
                                <ul style="list-style: none; font-size: 0.9rem;">
                                    <li><i class="fas fa-times"></i> Avoid grassy areas when pollen high</li>
                                    <li><i class="fas fa-home"></i> Keep windows shut in cars/buildings</li>
                                    <li><i class="fas fa-shower"></i> Shower after high exposure</li>
                                    <li><i class="fas fa-sunglasses"></i> Use wraparound sunglasses</li>
                                </ul>
                            </div>
                            <div style="background: var(--light-blue); padding: 1rem; border-radius: 8px;">
                                <h4><i class="fas fa-broom"></i> House Dust Mite Control</h4>
                                <ul style="list-style: none; font-size: 0.9rem;">
                                    <li><i class="fas fa-bed"></i> Impermeable mattress/pillow covers</li>
                                    <li><i class="fas fa-temperature-high"></i> Wash bedding weekly at high temp</li>
                                    <li><i class="fas fa-home"></i> Prefer hard floors to carpets</li>
                                    <li><i class="fas fa-wind"></i> Reduce humidity and improve ventilation</li>
                                </ul>
                            </div>
                        </div>

                        <h3><i class="fas fa-prescription-bottle-alt"></i> First-Line Drug Treatment</h3>
                        <p>Most local policies restrict prescribing for seasonal allergic rhinitis. OTC treatments may be prescribed for perennial rhinitis.</p>

                        <div class="expandable-section">
                            <div class="expandable-header" onclick="toggleExpandable(this)">
                                <span><i class="fas fa-spray-can"></i> Intranasal Corticosteroids (Most Effective)</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="expandable-content">
                                <div class="medication-grid">
                                    <div class="medication-card">
                                        <h4>Mometasone Furoate</h4>
                                        <p class="dose"><strong>Children 3-11 years:</strong> 50mcg once daily each nostril</p>
                                        <p class="dose"><strong>≥12 years:</strong> 100mcg once daily each nostril</p>
                                        <span class="badge stable">First Choice</span>
                                    </div>
                                    <div class="medication-card">
                                        <h4>Fluticasone Propionate</h4>
                                        <p class="dose"><strong>Children 4-11 years:</strong> 50mcg once daily each nostril</p>
                                        <p class="dose"><strong>≥12 years:</strong> 100mcg once daily each nostril</p>
                                        <span class="badge stable">Alternative</span>
                                    </div>
                                    <div class="medication-card">
                                        <h4>Fluticasone Furoate (Avamys®)</h4>
                                        <p class="dose"><strong>Children 6-11 years:</strong> 27.5mcg once daily each nostril</p>
                                        <p class="dose"><strong>≥12 years:</strong> 55mcg once daily each nostril</p>
                                        <span class="badge stable">Alternative</span>
                                    </div>
                                </div>
                                <div style="background: #FFF3CD; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                                    <p style="color: #856404;"><i class="fas fa-info-circle"></i> <strong>Onset of action:</strong> 6-8 hours after first dose, maximal effect may take 2 weeks</p>
                                </div>
                            </div>
                        </div>

                        <div class="expandable-section">
                            <div class="expandable-header" onclick="toggleExpandable(this)">
                                <span><i class="fas fa-tablets"></i> Antihistamines</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="expandable-content">
                                <div class="medication-grid">
                                    <div class="medication-card">
                                        <h4>Oral Antihistamines</h4>
                                        <p class="dose"><strong>Cetirizine:</strong> 10mg once daily (≥12 years)</p>
                                        <p class="dose"><strong>Loratadine:</strong> 10mg once daily (≥12 years)</p>
                                        <p class="dose"><strong>Fexofenadine:</strong> 120mg once daily (≥12 years)</p>
                                        <span class="badge stable">Non-sedating</span>
                                    </div>
                                    <div class="medication-card">
                                        <h4>Intranasal Antihistamine</h4>
                                        <p><strong>Azelastine:</strong></p>
                                        <p class="dose">1 spray twice daily each nostril (≥6 years)</p>
                                        <p style="font-size: 0.85rem; color: var(--text-light);">Fast onset (within minutes)</p>
                                        <span class="badge info">Rapid Relief</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="expandable-section">
                            <div class="expandable-header" onclick="toggleExpandable(this)">
                                <span><i class="fas fa-compress-arrows-alt"></i> Combination Therapy</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="expandable-content">
                                <div class="medication-grid">
                                    <div class="medication-card">
                                        <h4>Dymista®</h4>
                                        <p>Azelastine + Fluticasone Propionate</p>
                                        <p class="dose">1 spray twice daily each nostril (≥12 years)</p>
                                        <span class="badge info">More effective than steroid alone</span>
                                    </div>
                                    <div class="medication-card">
                                        <h4>Ryaltris®</h4>
                                        <p>Olopatadine + Mometasone</p>
                                        <p class="dose">2 sprays twice daily each nostril (≥12 years)</p>
                                        <span class="badge info">Alternative combination</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h3><i class="fas fa-route"></i> Treatment Pathway</h3>
                        <div style="background: var(--light-blue); padding: 1.5rem; border-radius: 8px;">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <span class="badge stable">Step 1</span>
                                <div>
                                    <strong>Mild/Intermittent Symptoms</strong>
                                    <p style="font-size: 0.9rem; color: var(--text-light);">Antihistamine (intranasal or oral)</p>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <span class="badge caution">Step 2</span>
                                <div>
                                    <strong>Moderate-Severe/Persistent</strong>
                                    <p style="font-size: 0.9rem; color: var(--text-light);">Intranasal corticosteroid OR combination therapy</p>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <span class="badge urgent">Step 3</span>
                                <div>
                                    <strong>Refractory Symptoms</strong>
                                    <p style="font-size: 0.9rem; color: var(--text-light);">Consider leukotriene receptor antagonist or specialist referral</p>
                                </div>
                            </div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" onclick="showTreatmentFailure()">
                                <i class="fas fa-exclamation-circle"></i> Treatment Failure Options
                            </button>
                            <button class="btn btn-secondary" onclick="showImmunotherapy()">
                                <i class="fas fa-syringe"></i> Immunotherapy
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Follow-up Card -->
            <div class="card followup fade-in" id="followup-card">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="card-title">
                        <h2>Follow-up & Monitoring</h2>
                        <p>Ensure optimal control and adjust treatment as needed</p>
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-body">
                        <h3><i class="fas fa-calendar-check"></i> Review Schedule</h3>
                        <ul class="feature-list">
                            <li>
                                <i class="fas fa-calendar-alt"></i>
                                <div>
                                    <strong>Initial Review:</strong> 2-4 weeks after starting treatment
                                    <div style="font-size: 0.85rem; color: var(--text-light);">Assess symptom control and technique</div>
                                </div>
                            </li>
                            <li>
                                <i class="fas fa-calendar-week"></i>
                                <div>
                                    <strong>Subsequent Reviews:</strong> Annually or as needed
                                    <div style="font-size: 0.85rem; color: var(--text-light);">Monitor growth in children, assess control</div>
                                </div>
                            </li>
                            <li>
                                <i class="fas fa-clock"></i>
                                <div>
                                    <strong>Seasonal Treatment:</strong> Review at end of pollen season
                                    <div style="font-size: 0.85rem; color: var(--text-light);">Step down or stop treatment as appropriate</div>
                                </div>
                            </li>
                        </ul>

                        <h3><i class="fas fa-tasks"></i> Assessment of Control</h3>
                        <div style="background: white; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <strong>Symptom Control</strong>
                                <div>
                                    <span class="badge stable">Well Controlled</span>
                                    <span class="badge caution">Partially Controlled</span>
                                    <span class="badge urgent">Uncontrolled</span>
                                </div>
                            </div>
                            
                            <div class="expandable-section">
                                <div class="expandable-header" onclick="toggleExpandable(this)">
                                    <span><i class="fas fa-check-circle"></i> Well Controlled Indicators</span>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="expandable-content">
                                    <ul class="feature-list">
                                        <li><i class="fas fa-check"></i> No sneezing/itching episodes</li>
                                        <li><i class="fas fa-check"></i> Minimal nasal congestion</li>
                                        <li><i class="fas fa-check"></i> No sleep disturbance</li>
                                        <li><i class="fas fa-check"></i> Normal daily activities</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="expandable-section">
                                <div class="expandable-header" onclick="toggleExpandable(this)">
                                    <span><i class="fas fa-exclamation-triangle"></i> Uncontrolled Indicators</span>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="expandable-content">
                                    <ul class="feature-list">
                                        <li><i class="fas fa-times"></i> Frequent bothersome symptoms</li>
                                        <li><i class="fas fa-times"></i> Sleep disturbance present</li>
                                        <li><i class="fas fa-times"></i> Impairment of daily activities</li>
                                        <li><i class="fas fa-times"></i> Need for frequent rescue medication</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <h3><i class="fas fa-child"></i> Special Populations</h3>
                        <div class="medication-grid">
                            <div class="medication-card">
                                <h4><i class="fas fa-child"></i> Children</h4>
                                <ul style="list-style: none; font-size: 0.9rem;">
                                    <li><i class="fas fa-ruler-vertical"></i> Monitor growth (height)</li>
                                    <li><i class="fas fa-eye"></i> Watch for eye symptoms</li>
                                    <li><i class="fas fa-school"></i> Assess school performance</li>
                                    <li><i class="fas fa-bed"></i> Sleep quality assessment</li>
                                </ul>
                            </div>
                            <div class="medication-card">
                                <h4><i class="fas fa-baby"></i> Pregnancy & Breastfeeding</h4>
                                <ul style="list-style: none; font-size: 0.9rem;">
                                    <li><i class="fas fa-exclamation-triangle"></i> Avoid unless benefits outweigh risks</li>
                                    <li><i class="fas fa-spray-can"></i> Intranasal steroids: use lowest effective dose</li>
                                    <li><i class="fas fa-tablets"></i> Oral antihistamines: avoid if possible</li>
                                    <li><i class="fas fa-user-md"></i> Specialist advice recommended</li>
                                </ul>
                            </div>
                            <div class="medication-card">
                                <h4><i class="fas fa-briefcase"></i> Occupational Rhinitis</h4>
                                <ul style="list-style: none; font-size: 0.9rem;">
                                    <li><i class="fas fa-ban"></i> Allergen avoidance crucial</li>
                                    <li><i class="fas fa-mask"></i> Protective equipment</li>
                                    <li><i class="fas fa-exchange-alt"></i> Consider job modification</li>
                                    <li><i class="fas fa-file-medical"></i> Document for compensation</li>
                                </ul>
                            </div>
                        </div>

                        <h3><i class="fas fa-exclamation-triangle"></i> When to Reassess/Refer</h3>
                        <div class="referral-criteria">
                            <h4><i class="fas fa-hospital-alt"></i> Referral Indicators</h4>
                            <ul>
                                <li><i class="fas fa-arrow-right"></i> Persistent symptoms despite optimal therapy</li>
                                <li><i class="fas fa-arrow-right"></i> Diagnostic uncertainty</li>
                                <li><i class="fas fa-arrow-right"></i> Considering immunotherapy</li>
                                <li><i class="fas fa-arrow-right"></i> Occupational rhinitis</li>
                                <li><i class="fas fa-arrow-right"></i> Suspected nasal polyps/structural issues</li>
                                <li><i class="fas fa-arrow-right"></i> Significant impact on quality of life</li>
                            </ul>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary pulse" onclick="showSummary()">
                                <i class="fas fa-clipboard-list"></i> Algorithm Summary
                            </button>
                            <button class="btn btn-secondary" onclick="printAlgorithm()">
                                <i class="fas fa-print"></i> Print Algorithm
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Toggle card expansion
        function toggleCard(header) {
            const card = header.parentElement;
            card.classList.toggle('expanded');
            
            // Update progress indicator
            const cardId = card.id.replace('-card', '');
            updateProgress(cardId);
            
            // Smooth scroll to card
            setTimeout(() => {
                card.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        }

        // Toggle expandable sections
        function toggleExpandable(header) {
            const section = header.parentElement;
            section.classList.toggle('expanded');
            
            // Rotate icon
            const icon = header.querySelector('.fa-chevron-down');
            if (section.classList.contains('expanded')) {
                icon.style.transform = 'rotate(180deg)';
            } else {
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // Toggle decision tree nodes
        function toggleDecision(node) {
            const content = node.querySelector('.expandable-content');
            const icon = node.querySelector('.fa-chevron-down');
            
            if (content.style.maxHeight && content.style.maxHeight !== '0px') {
                content.style.maxHeight = '0px';
                icon.style.transform = 'rotate(0deg)';
            } else {
                content.style.maxHeight = content.scrollHeight + 'px';
                icon.style.transform = 'rotate(180deg)';
            }
        }

        // Update progress sidebar
        function updateProgress(currentStep) {
            const progressItems = document.querySelectorAll('.progress-item');
            let foundActive = false;
            
            progressItems.forEach(item => {
                const step = item.dataset.step;
                
                if (step === currentStep) {
                    item.classList.add('active');
                    item.classList.remove('completed');
                    foundActive = true;
                } else if (foundActive) {
                    item.classList.remove('active', 'completed');
                } else {
                    item.classList.remove('active');
                    item.classList.add('completed');
                }
            });
        }

        // Progress item click handler
        document.querySelectorAll('.progress-item').forEach(item => {
            item.addEventListener('click', function() {
                const step = this.dataset.step;
                const card = document.getElementById(step + '-card');
                
                // Expand the card
                card.classList.add('expanded');
                
                // Scroll to card
                setTimeout(() => {
                    card.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
                
                // Update progress
                updateProgress(step);
            });
        });

        // Severity scale interaction
        function showSeverityInfo(severity) {
            const messages = {
                mild: "Mild allergic rhinitis requires minimal intervention. Consider antihistamines as needed and allergen avoidance strategies.",
                moderate: "Moderate allergic rhinitis affects daily activities. Regular intranasal corticosteroids are usually required.",
                severe: "Severe allergic rhinitis significantly impacts quality of life. Combination therapy or specialist referral may be needed."
            };
            
            alert(messages[severity]);
        }

        // Button action handlers
        function showInvestigations() {
            const investigations = `
ALLERGY TESTING OPTIONS:

• Skin Prick Testing:
  - High negative predictive value
  - Immediate results
  - Suppressed by antihistamines, TCAs, topical steroids
  - 15% of positive tests may be asymptomatic

• Serum IgE Testing:
  - Used when skin testing not possible
  - Not affected by medications
  - Levels don't correlate with clinical reaction

• Specialist Investigations:
  - Nasal endoscopy
  - Nasal allergen challenge
  - Nasal nitric oxide evaluation
  - CT scans (if structural issues suspected)
            `;
            alert(investigations);
        }

        function showDifferential() {
            const differential = `
DIFFERENTIAL DIAGNOSIS:

• Infective Rhinitis:
  - Viral URTI symptoms
  - Usually resolves in 1 week

• Non-allergic Rhinitis:
  - Autonomic/irritant triggers
  - Temperature changes, smoke, odors

• Drug-induced:
  - ACE inhibitors, NSAIDs, intranasal decongestants

• Hormonal:
  - Pregnancy, hypothyroidism

• Structural:
  - Deviated septum, nasal polyps
  - Foreign body (especially children)

• Occupational:
  - Irritant or allergic triggers at work
            `;
            alert(differential);
        }

        function showManagementPathway() {
            const pathway = `
MANAGEMENT PATHWAY:

STEP 1 - Assessment:
• Take comprehensive history
• Physical examination
• Classify severity and duration

STEP 2 - Initial Treatment:
• Mild/Intermittent: Antihistamine
• Moderate-Severe/Persistent: Intranasal corticosteroid
• With eye symptoms: Add eye drops

STEP 3 - Review at 2-4 weeks:
• If controlled: Continue treatment
• If uncontrolled: Step up treatment

STEP 4 - Treatment Options:
• Add intranasal antihistamine
• Consider combination spray
• Add leukotriene antagonist (if asthma)
• Short oral steroid course (severe cases)

STEP 5 - Specialist Referral:
• Refractory symptoms
• Diagnostic uncertainty
• Considering immunotherapy
• Occupational rhinitis
            `;
            alert(pathway);
        }

        function showReferralCriteria() {
            const referral = `
REFERRAL CRITERIA:

URGENT (2-week wait):
• Unilateral symptoms
• Blood-stained discharge
• Recurrent epistaxis
• Nasal pain

ROUTINE:
• Persistent symptoms despite optimal treatment
• Diagnostic uncertainty
• Considering immunotherapy
• Occupational rhinitis
• Structural abnormalities
• Significant quality of life impact

CONSIDER ALLERGY TESTING:
• Before allergen avoidance measures
• Before immunotherapy
• To confirm specific triggers
            `;
            alert(referral);
        }

        function showTreatmentFailure() {
            const failure = `
TREATMENT FAILURE OPTIONS:

1. Check Compliance:
   - Correct spray technique
   - Regular use as prescribed
   - Adequate duration of trial

2. Add Short-term Decongestant:
   - Xylometazoline 0.1% (adults)
   - Maximum 5-7 days
   - Risk of rhinitis medicamentosa

3. Add Intranasal Anticholinergic:
   - Ipratropium bromide
   - For persistent watery rhinorrhea
   - ≥12 years only

4. Step up to Combination:
   - Intranasal steroid + antihistamine
   - Dymista® or Ryaltris®

5. Add Leukotriene Antagonist:
   - If coexisting asthma
   - Montelukast 10mg daily

6. Short Oral Steroid Course:
   - Prednisolone 0.5mg/kg for 5-10 days
   - For severe uncontrolled symptoms
   - Specialist advice for children
            `;
            alert(failure);
        }

        function showImmunotherapy() {
            const immunotherapy = `
IMMUNOTHERAPY:

INDICATIONS:
• Persistent symptoms despite optimal therapy
• IgE sensitivity confirmed
• Predominantly single allergen
• Patient preference over long-term medication

OPTIONS:
1. Subcutaneous Immunotherapy (SCIT):
   - Weekly initial dosing
   - 4-6 weekly maintenance (3 years)
   - Pre-seasonal for pollen allergy

2. Sublingual Immunotherapy (SLIT):
   - Daily self-administration
   - Usually 3 years duration
   - Grass pollen and house dust mite

BENEFITS:
• Modifies disease progression
• Long-term remission possible
• May prevent asthma development
• Reduces new sensitizations

ADVERSE EFFECTS:
• SCIT: Injection site reactions
• SLIT: Oropharyngeal itching/swelling
• Usually short-lived and settle with continued use
            `;
            alert(immunotherapy);
        }

        function showSummary() {
            const summary = `
ALGORITHM SUMMARY:

1. ASSESSMENT:
   - Comprehensive history and examination
   - Classify severity (mild/moderate-severe) and duration (intermittent/persistent)
   - Identify red flags for urgent referral

2. DIAGNOSIS:
   - Clinical diagnosis based on history and examination
   - Consider allergy testing if needed
   - Exclude alternative diagnoses

3. TREATMENT:
   - Mild/Intermittent: Antihistamine
   - Moderate-Severe/Persistent: Intranasal corticosteroid
   - Add intranasal antihistamine if needed
   - Consider combination therapy for refractory cases

4. FOLLOW-UP:
   - Review at 2-4 weeks
   - Assess control and adjust treatment
   - Annual review or as needed
   - Refer if uncontrolled or diagnostic uncertainty

KEY POINTS:
• Intranasal corticosteroids most effective
• Combination therapy more effective than monotherapy
• Allergen avoidance measures important
• Specialist referral for refractory cases
• Consider immunotherapy for selected patients
            `;
            alert(summary);
        }

        function printAlgorithm() {
            window.print();
        }

        // Initialize with first card expanded
        document.addEventListener('DOMContentLoaded', function() {
            const firstCard = document.querySelector('.card');
            firstCard.classList.add('expanded');
            
            // Add fade-in animation to cards
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                setTimeout(() => {
                    card.classList.add('fade-in');
                }, index * 200);
            });
        });

        // Smooth scroll for internal links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add keyboard navigation
        document.addEventListener('keydown', function(e) {
            const cards = Array.from(document.querySelectorAll('.card'));
            const expandedCard = document.querySelector('.card.expanded');
            const currentIndex = cards.indexOf(expandedCard);
            
            if (e.key === 'ArrowDown' && currentIndex < cards.length - 1) {
                e.preventDefault();
                toggleCard(cards[currentIndex].querySelector('.card-header'));
                setTimeout(() => {
                    cards[currentIndex + 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
                    setTimeout(() => {
                        toggleCard(cards[currentIndex + 1].querySelector('.card-header'));
                    }, 300);
                }, 300);
            } else if (e.key === 'ArrowUp' && currentIndex > 0) {
                e.preventDefault();
                toggleCard(cards[currentIndex].querySelector('.card-header'));
                setTimeout(() => {
                    cards[currentIndex - 1].scrollIntoView({ behavior: 'smooth', block: 'start' });
                    setTimeout(() => {
                        toggleCard(cards[currentIndex - 1].querySelector('.card-header'));
                    }, 300);
                }, 300);
            }
        });

        // Add scroll spy for progress indicator
        window.addEventListener('scroll', function() {
            const cards = document.querySelectorAll('.card');
            const scrollPosition = window.scrollY + 100;
            
            cards.forEach(card => {
                const cardTop = card.offsetTop;
                const cardBottom = cardTop + card.offsetHeight;
                const cardId = card.id.replace('-card', '');
                
                if (scrollPosition >= cardTop && scrollPosition < cardBottom) {
                    updateProgress(cardId);
                }
            });
        });
    </script>
</body>
</html>