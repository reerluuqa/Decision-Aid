<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NICE Low Back Pain Management Algorithm</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #06b6d4;
            --dark: #1e293b;
            --light: #f8fafc;
            --card-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --border-color: #e2e8f0;
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 255, 255, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #e6f0ff, #f0f9ff);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            background-attachment: fixed;
        }

        .container {
            display: flex;
            min-height: 100vh;
            max-width: 1920px;
            margin: 0 auto;
        }

        /* Progress Sidebar */
        .progress-sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-right: 1px solid var(--glass-border);
            padding: 24px;
            overflow-y: auto;
            z-index: 1000;
            transition: transform 0.4s cubic-bezier(0.2, 0, 0.2, 1);
            box-shadow: 2px 0 15px rgba(0, 0, 0, 0.05);
        }

        .progress-header {
            margin-bottom: 32px;
            text-align: center;
        }

        .progress-header h2 {
            font-size: 20px;
            color: var(--primary-light);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .progress-header p {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-steps {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .progress-step {
            display: flex;
            align-items: center;
            padding: 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            position: relative;
            overflow: hidden;
        }

        .progress-step::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .progress-step:hover::before {
            transform: scaleY(1);
        }

        .progress-step.completed {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .progress-step.completed::before {
            background: var(--success);
            transform: scaleY(1);
        }

        .progress-step.active {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary-light);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.1);
        }

        .progress-step.active::before {
            background: var(--primary-light);
            transform: scaleY(1);
        }

        .progress-step:hover {
            background: rgba(37, 99, 235, 0.05);
            transform: translateX(5px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.05);
        }

        .progress-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--glass-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.03);
            border: 1px solid var(--glass-border);
        }

        .progress-step.active .progress-icon,
        .progress-step.completed .progress-icon {
            background: var(--primary-light);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(37, 99, 235, 0.2);
        }

        .progress-step.completed .progress-icon {
            background: var(--success);
        }

        .progress-text {
            flex: 1;
        }

        .progress-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .progress-desc {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .progress-step.active .progress-desc {
            color: var(--primary-light);
        }

        .progress-step.completed .progress-desc {
            color: var(--success);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 40px 20px;
            max-width: calc(100% - 280px);
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
        }

        .page-header h1 {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 16px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
        }

        .page-header p {
            font-size: 18px;
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.7;
        }

        /* Algorithm Cards */
        .algorithm-section {
            margin-bottom: 48px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s cubic-bezier(0.2, 0, 0.2, 1);
        }

        .algorithm-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .section-card {
            background: var(--glass-bg);
            border-radius: 20px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.2, 0, 0.2, 1);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .section-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
        }

        .card-header {
            padding: 24px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                rgba(255,255,255,0.1) 0%, 
                rgba(255,255,255,0) 100%);
            z-index: 0;
        }

        .card-header.assessment {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
        }

        .card-header.diagnosis {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
        }

        .card-header.treatment {
            background: linear-gradient(135deg, #10b981, #34d399);
        }

        .card-header.followup {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
        }

        .card-header-content {
            display: flex;
            align-items: center;
            gap: 16px;
            position: relative;
            z-index: 1;
        }

        .card-icon {
            width: 56px;
            height: 56px;
            background: rgba(255,255,255,0.2);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            transition: all 0.3s ease;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .section-card:hover .card-icon {
            transform: scale(1.15) rotate(5deg);
            background: rgba(255,255,255,0.3);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .card-title-section h2 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .card-title-section p {
            font-size: 14px;
            opacity: 0.9;
        }

        .expand-icon {
            font-size: 24px;
            transition: transform 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .section-card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .card-body {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.2, 0, 0.2, 1);
        }

        .section-card.expanded .card-body {
            max-height: 2000px;
        }

        .card-content {
            padding: 32px;
        }

        /* Step Cards */
        .step-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }

        .step-card {
            background: var(--glass-bg);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid var(--glass-border);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
        }

        .step-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            border-color: rgba(37, 99, 235, 0.3);
        }

        .step-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary-light);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .step-card:hover::before {
            transform: scaleY(1);
        }

        .step-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .step-number {
            width: 32px;
            height: 32px;
            background: var(--primary-light);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
        }

        .severity-badges {
            display: flex;
            gap: 8px;
        }

        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .badge.urgent {
            background: linear-gradient(135deg, var(--danger), #f87171);
            color: white;
        }

        .badge.caution {
            background: linear-gradient(135deg, var(--warning), #fbbf24);
            color: #0f172a;
        }

        .badge.stable {
            background: linear-gradient(135deg, var(--success), #34d399);
            color: white;
        }

        .step-content h4 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .step-content p {
            font-size: 15px;
            color: var(--text-secondary);
            margin-bottom: 16px;
            line-height: 1.7;
        }

        .step-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            background: var(--glass-bg);
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            color: var(--text-primary);
            font-weight: 500;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
        }

        .action-btn:hover {
            background: var(--primary-light);
            color: white;
            border-color: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(37, 99, 235, 0.15);
        }

        .action-btn.secondary {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }

        .action-btn.secondary:hover {
            background: #475569;
            border-color: #475569;
        }

        /* Expandable Details */
        .expandable-details {
            margin-top: 16px;
            border-top: 1px solid var(--glass-border);
            padding-top: 16px;
        }

        .details-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            color: var(--primary-light);
            font-size: 14px;
            font-weight: 500;
            transition: color 0.2s ease;
        }

        .details-toggle:hover {
            color: var(--primary);
        }

        .details-toggle .icon {
            font-size: 18px;
            transition: transform 0.3s ease;
        }

        .details-toggle.expanded .icon {
            transform: rotate(90deg);
        }

        .details-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            margin-top: 12px;
        }

        .details-content.expanded {
            max-height: 500px;
        }

        .details-content ul {
            list-style: none;
            padding-left: 0;
        }

        .details-content li {
            padding: 8px 0;
            font-size: 14px;
            color: var(--text-secondary);
            position: relative;
            padding-left: 24px;
        }

        .details-content li::before {
            content: '‚Ä¢';
            position: absolute;
            left: 8px;
            color: var(--primary-light);
            font-size: 20px;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .progress-sidebar {
                transform: translateX(-100%);
                width: 280px;
            }

            .progress-sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                max-width: 100%;
            }

            .menu-toggle {
                display: block;
                position: fixed;
                top: 20px;
                left: 20px;
                z-index: 1001;
                background: var(--primary-light);
                color: white;
                border: none;
                border-radius: 12px;
                padding: 12px 14px;
                cursor: pointer;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
                transition: all 0.3s ease;
            }

            .menu-toggle:hover {
                background: var(--primary);
                transform: scale(1.05);
            }
        }

        .menu-toggle {
            display: none;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.5s ease forwards;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
            100% { transform: translateY(0px); }
        }

        .floating {
            animation: float 4s ease-in-out infinite;
        }

        /* Floating animation for icons */
        .section-card:hover .card-icon {
            animation: float 3s ease-in-out infinite;
        }

        /* New animation for badges */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            70% { box-shadow: 0 0 0 12px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        .badge.urgent {
            animation: pulse 2s infinite;
        }

        /* Print styles */
        @media print {
            .progress-sidebar {
                display: none;
            }
            .main-content {
                margin-left: 0;
                max-width: 100%;
            }
            .section-card {
                box-shadow: none;
                border: 1px solid var(--border-color);
            }
            .card-body {
                max-height: none !important;
            }
        }

        /* Smooth scroll */
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 20px;
        }

        /* Focus styles */
        button:focus, .action-btn:focus {
            outline: 2px solid var(--primary-light);
            outline-offset: 2px;
        }

        /* Loading state */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        /* New styles for glassmorphism effect */
        .section-card, .step-card, .progress-step {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.05);
        }

        .section-card:hover, .step-card:hover {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
        }
    </style>
</head>
<body>
    <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
    
    <div class="container">
        <!-- Progress Sidebar -->
        <aside class="progress-sidebar" id="progressSidebar">
            <div class="progress-header">
                <h2>Algorithm Progress</h2>
                <p>Click to navigate between sections</p>
            </div>
            <div class="progress-steps">
                <div class="progress-step active" data-section="assessment" onclick="scrollToSection('assessment')">
                    <div class="progress-icon">üìã</div>
                    <div class="progress-text">
                        <div class="progress-title">Assessment</div>
                        <div class="progress-desc">Initial evaluation & red flags</div>
                    </div>
                </div>
                <div class="progress-step" data-section="diagnosis" onclick="scrollToSection('diagnosis')">
                    <div class="progress-icon">üîç</div>
                    <div class="progress-text">
                        <div class="progress-title">Diagnosis</div>
                        <div class="progress-desc">Differential diagnosis</div>
                    </div>
                </div>
                <div class="progress-step" data-section="treatment" onclick="scrollToSection('treatment')">
                    <div class="progress-icon">üíä</div>
                    <div class="progress-text">
                        <div class="progress-title">Treatment</div>
                        <div class="progress-desc">Management options</div>
                    </div>
                </div>
                <div class="progress-step" data-section="followup" onclick="scrollToSection('followup')">
                    <div class="progress-icon">üìÖ</div>
                    <div class="progress-text">
                        <div class="progress-title">Follow-up</div>
                        <div class="progress-desc">Review & referral</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="page-header">
                <h1>NICE Low Back Pain Management</h1>
                <p>Interactive algorithm for non-specific low back pain without radiculopathy (Updated: October 2024)</p>
            </header>

            <!-- Assessment Section -->
            <section class="algorithm-section" id="assessment">
                <div class="section-card" data-section="assessment">
                    <div class="card-header assessment" onclick="toggleCard(this)">
                        <div class="card-header-content">
                            <div class="card-icon floating">üìã</div>
                            <div class="card-title-section">
                                <h2>Initial Assessment & Red Flags</h2>
                                <p>Comprehensive evaluation and identification of warning signs</p>
                            </div>
                        </div>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="card-body">
                        <div class="card-content">
                            <div class="step-grid">
                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">1</div>
                                        <div class="severity-badges">
                                            <span class="badge urgent">CRITICAL</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Cauda Equina Syndrome</h4>
                                        <p><strong>Immediate emergency referral if present:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>View specific symptoms</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>New difficulty initiating micturition</li>
                                                    <li>New urinary retention/overflow incontinence</li>
                                                    <li>New faecal incontinence</li>
                                                    <li>Gait disturbance</li>
                                                    <li>Perianal/perineal sensory loss</li>
                                                    <li>Unexpected laxity of anal sphincter</li>
                                                    <li>Sudden-onset bilateral radicular leg pain</li>
                                                    <li>Severe/progressive neurological deficit</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showAlert('Emergency referral to neurosurgery/spinal surgery required')">
                                                Emergency Referral
                                            </button>
                                            <button class="action-btn secondary" onclick="showInfo('Digital rectal exam may be considered in primary care')">
                                                DRE Consideration
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">2</div>
                                        <div class="severity-badges">
                                            <span class="badge urgent">URGENT</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Spinal Fracture Assessment</h4>
                                        <p><strong>Consider imaging if any of the following:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Risk factors</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Major trauma (e.g., RTA, fall from height)</li>
                                                    <li>Minor trauma in elderly/frail</li>
                                                    <li>Strenuous lifting in osteoporosis</li>
                                                    <li>Sudden severe central spinal pain</li>
                                                    <li>Structural deformity of spine</li>
                                                    <li>Point tenderness over vertebral body</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showAlert('Arrange spinal X-ray if indicated')">
                                                Order X-ray
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">3</div>
                                        <div class="severity-badges">
                                            <span class="badge caution">CAUTION</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Cancer/Metastatic Disease</h4>
                                        <p><strong>Consider if:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Cancer red flags</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Age ‚â•50 years with new onset pain</li>
                                                    <li>Gradual onset/progressive pain</li>
                                                    <li>Severe unremitting lumbar pain</li>
                                                    <li>Nocturnal pain preventing sleep</li>
                                                    <li>Pain aggravated by straining</li>
                                                    <li>Localized spinal tenderness</li>
                                                    <li>No improvement after 4-6 weeks</li>
                                                    <li>Unexplained weight loss</li>
                                                    <li>Previous history of cancer</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showAlert('Consider urgent cancer referral if indicated')">
                                                Cancer Referral
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">4</div>
                                        <div class="severity-badges">
                                            <span class="badge caution">CAUTION</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Infection/Inflammation</h4>
                                        <p><strong>Consider if any of the following present:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Infection risk factors</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Fever or feeling systemically unwell</li>
                                                    <li>Recent infection</li>
                                                    <li>Diabetes mellitus</li>
                                                    <li>IV drug use history</li>
                                                    <li>Immunocompromise</li>
                                                    <li>Spinal tenderness with systemic symptoms</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showAlert('Urgent referral for suspected infection')">
                                                Refer Urgently
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">5</div>
                                        <div class="severity-badges">
                                            <span class="badge stable">ROUTINE</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Standard History & Examination</h4>
                                        <p><strong>Complete assessment if no red flags:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Assessment components</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Onset, type, site, pattern of pain</li>
                                                    <li>Radiation, duration, aggravating/relieving factors</li>
                                                    <li>Previous episodes, morning stiffness</li>
                                                    <li>Impact on daily functioning</li>
                                                    <li>Psychological wellbeing assessment</li>
                                                    <li>Risk factors for chronicity</li>
                                                    <li>Current medication review</li>
                                                    <li>Gait, posture, spine examination</li>
                                                    <li>Neurological examination</li>
                                                    <li>STarT Back risk stratification</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('Use STarT Back tool for risk stratification')">
                                                STarT Back Tool
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Diagnosis Section -->
            <section class="algorithm-section" id="diagnosis">
                <div class="section-card" data-section="diagnosis">
                    <div class="card-header diagnosis" onclick="toggleCard(this)">
                        <div class="card-header-content">
                            <div class="card-icon floating">üîç</div>
                            <div class="card-title-section">
                                <h2>Differential Diagnosis</h2>
                                <p>Consider alternative conditions that may present with low back pain</p>
                            </div>
                        </div>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="card-body">
                        <div class="card-content">
                            <div class="step-grid">
                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">1</div>
                                        <div class="severity-badges">
                                            <span class="badge caution">NEUROLOGICAL</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Neurological Causes</h4>
                                        <p><strong>Consider if neurological signs present:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Differential diagnoses</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Sciatica/lumbar radiculopathy</li>
                                                    <li>Myelopathy or higher cord lesion</li>
                                                    <li>Peroneal palsy</li>
                                                    <li>Deep gluteal syndrome/piriformis syndrome</li>
                                                    <li>Spinal stenosis</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showAlert('See separate CKS topic for Sciatica management')">
                                                Sciatica Topic
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">2</div>
                                        <div class="severity-badges">
                                            <span class="badge caution">SYSTEMIC</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Systemic Conditions</h4>
                                        <p><strong>Consider if systemic features present:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Systemic causes</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Sacroiliitis/ankylosing spondylitis</li>
                                                    <li>Vascular claudication</li>
                                                    <li>Polymyalgia rheumatica</li>
                                                    <li>Rheumatoid arthritis</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('See CKS topic on Ankylosing Spondylitis')">
                                                Ankylosing Spondylitis
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">3</div>
                                        <div class="severity-badges">
                                            <span class="badge caution">OTHER</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Other Considerations</h4>
                                        <p><strong>Rule out other pathologies:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Other causes</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Abdominal aortic aneurysm</li>
                                                    <li>Intra-abdominal pathology</li>
                                                    <li>Osteoarthritis of spine/hip</li>
                                                    <li>Shingles (herpes zoster)</li>
                                                    <li>Osteoporosis-related fracture</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('Consider imaging if suspected')">
                                                Order Imaging
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">4</div>
                                        <div class="severity-badges">
                                            <span class="badge stable">DIAGNOSIS</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Non-Specific Low Back Pain</h4>
                                        <p><strong>Diagnosis of exclusion when:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Diagnostic criteria</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>No red flags present</li>
                                                    <li>No specific pathology identified</li>
                                                    <li>Pain varies with posture and time</li>
                                                    <li>Exacerbated by movement</li>
                                                    <li>Localized to lumbosacral area (12th ribs to iliac crest)</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('Continue to management algorithm')">
                                                Proceed to Treatment
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Treatment Section -->
            <section class="algorithm-section" id="treatment">
                <div class="section-card" data-section="treatment">
                    <div class="card-header treatment" onclick="toggleCard(this)">
                        <div class="card-header-content">
                            <div class="card-icon floating">üíä</div>
                            <div class="card-title-section">
                                <h2>Management & Treatment</h2>
                                <p>Evidence-based treatment options for non-specific low back pain</p>
                            </div>
                        </div>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="card-body">
                        <div class="card-content">
                            <div class="step-grid">
                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">1</div>
                                        <div class="severity-badges">
                                            <span class="badge stable">FIRST-LINE</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Self-Management & Information</h4>
                                        <p><strong>Provide advice on:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Self-management strategies</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Reassurance: most cases resolve within weeks</li>
                                                    <li>Stay active and resume normal activities</li>
                                                    <li>Gradual return to work/study</li>
                                                    <li>Avoid prolonged bed rest</li>
                                                    <li>Pain is not harmful if activities resumed gradually</li>
                                                    <li>Keep active to prevent recurrence</li>
                                                    <li>Short-term heat application (heat pack)</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('Recommend BackCare charity resources')">
                                                Patient Resources
                                            </button>
                                            <button class="action-btn secondary" onclick="showInfo('Provide STarT Back patient booklet')">
                                                STarT Back Booklet
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">2</div>
                                        <div class="severity-badges">
                                            <span class="badge stable">PHARMACOLOGICAL</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Pharmacological Management</h4>
                                        <p><strong>Acute pain medication options:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Medication guidance</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li><strong>First-line:</strong> OTC NSAID (ibuprofen) if no contraindications</li>
                                                    <li>Lowest effective dose for shortest time</li>
                                                    <li>Consider gastroprotection if indicated</li>
                                                    <li><strong>If NSAID contraindicated:</strong> short-term codeine ¬± paracetamol</li>
                                                    <li><strong>Do NOT use:</strong> paracetamol alone, gabapentinoids, antiepileptics, antidepressants</li>
                                                    <li><strong>Do NOT use:</strong> benzodiazepines for muscle spasm</li>
                                                    <li><strong>Do NOT use:</strong> opioids for chronic low back pain</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('See BNF for NSAID contraindications')">
                                                Check Contraindications
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">3</div>
                                        <div class="severity-badges">
                                            <span class="badge stable">PHYSICAL</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Physical Treatments</h4>
                                        <p><strong>Based on risk stratification (STarT Back):</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Treatment options</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Group exercise programs (biomechanical, aerobic, mind-body)</li>
                                                    <li>Manual therapy (manipulation, mobilisation, massage)</li>
                                                    <li>Part of treatment package including exercise</li>
                                                    <li>Self-referral to physiotherapy if available</li>
                                                    <li>Adjunct to self-management</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('Consider patient preferences and capabilities')">
                                                Patient Preferences
                                            </button>
                                            <button class="action-btn secondary" onclick="showInfo('Refer to physiotherapy services')">
                                                Physio Referral
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">4</div>
                                        <div class="severity-badges">
                                            <span class="badge stable">PSYCHOLOGICAL</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Psychological Support</h4>
                                        <p><strong>For patients with psychosocial barriers:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>CBT and psychological support</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Cognitive Behavioural Therapy (CBT)</li>
                                                    <li>Part of combined physical and psychological treatment</li>
                                                    <li>Consider if significant psychosocial barriers to recovery</li>
                                                    <li>For persistent/chronic pain</li>
                                                    <li>May include exercise ¬± manual therapy</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('Refer to CBT services')">
                                                CBT Referral
                                            </button>
                                            <button class="action-btn secondary" onclick="showInfo('Consider Mind-Body exercise programs')">
                                                Mind-Body Programs
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">5</div>
                                        <div class="severity-badges">
                                            <span class="badge stable">OCCUPATIONAL</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Work & Occupational Health</h4>
                                        <p><strong>Facilitate return to work:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Workplace interventions</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Occupational health assessment</li>
                                                    <li>Workplace adjustments</li>
                                                    <li>Graduated return to work plan</li>
                                                    <li>Ergonomic assessment</li>
                                                    <li>Consider impact on relationships and sleep</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('Request occupational health assessment')">
                                                OH Assessment
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">6</div>
                                        <div class="severity-badges">
                                            <span class="badge caution">CHRONIC PAIN</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Chronic Pain Management</h4>
                                        <p><strong>For pain lasting ‚â•3 months:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Specialist options</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Combined physical and psychological treatment approach</li>
                                                    <li>Referral to specialist back pain service</li>
                                                    <li>Radiofrequency denervation (for selected patients)</li>
                                                    <li>Spinal cord stimulation (for chronic neuropathic pain)</li>
                                                    <li>Multidisciplinary pain management</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showAlert('Consider specialist referral for chronic pain')">
                                                Specialist Referral
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Follow-up Section -->
            <section class="algorithm-section" id="followup">
                <div class="section-card" data-section="followup">
                    <div class="card-header followup" onclick="toggleCard(this)">
                        <div class="card-header-content">
                            <div class="card-icon floating">üìÖ</div>
                            <div class="card-title-section">
                                <h2>Follow-up & Referral</h2>
                                <p>Timeline for reassessment and escalation pathways</p>
                            </div>
                        </div>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="card-body">
                        <div class="card-content">
                            <div class="step-grid">
                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">1</div>
                                        <div class="severity-badges">
                                            <span class="badge stable">TIMELINE</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Initial Follow-up</h4>
                                        <p><strong>Review at 3-4 weeks:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Review components</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Assess adherence to self-management</li>
                                                    <li>Evaluate response to treatment</li>
                                                    <li>Reassess for red flags</li>
                                                    <li>Review medication use and side effects</li>
                                                    <li>Assess psychosocial factors</li>
                                                    <li>Check return to work progress</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('Schedule follow-up appointment')">
                                                Book Follow-up
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">2</div>
                                        <div class="severity-badges">
                                            <span class="badge caution">REASSESS</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Persistent Symptoms</h4>
                                        <p><strong>If symptoms persist after 3-4 weeks:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Reassessment steps</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Reassess for underlying cause</li>
                                                    <li>Check for new symptoms</li>
                                                    <li>Consider imaging if not already done</li>
                                                    <li>Review risk factors for chronicity</li>
                                                    <li>Assess for psychological comorbidities</li>
                                                    <li>Consider specialist referral</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showAlert('Consider early referral if risk factors present')">
                                                Early Referral
                                            </button>
                                            <button class="action-btn secondary" onclick="showInfo('Review STarT Back risk score')">
                                                Risk Reassessment
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">3</div>
                                        <div class="severity-badges">
                                            <span class="badge caution">REFERRAL</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Referral Indications</h4>
                                        <p><strong>Consider referral when:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Referral criteria</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Red flags present at any time</li>
                                                    <li>Suspected specific pathology</li>
                                                    <li>Persistent pain >6 weeks</li>
                                                    <li>Significant disability</li>
                                                    <li>Psychosocial barriers to recovery</li>
                                                    <li>Chronic pain (‚â•3 months)</li>
                                                    <li>Non-response to primary care management</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('Refer to physiotherapy, CBT, or specialist service')">
                                                Referral Pathways
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">4</div>
                                        <div class="severity-badges">
                                            <span class="badge stable">ONGOING</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Chronic Pain Management</h4>
                                        <p><strong>For pain lasting ‚â•3 months:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Long-term management</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>Multidisciplinary approach</li>
                                                    <li>Pain management program</li>
                                                    <li>Psychological support (CBT)</li>
                                                    <li>Graded exercise program</li>
                                                    <li>Occupational therapy input</li>
                                                    <li>Consider specialist interventions</li>
                                                    <li>Review medication regularly</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showAlert('Consider specialist pain service referral')">
                                                Pain Service Referral
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="step-card">
                                    <div class="step-header">
                                        <div class="step-number">5</div>
                                        <div class="severity-badges">
                                            <span class="badge stable">MONITORING</span>
                                        </div>
                                    </div>
                                    <div class="step-content">
                                        <h4>Quality Indicators</h4>
                                        <p><strong>NICE Quality Standard statements:</strong></p>
                                        <div class="expandable-details">
                                            <div class="details-toggle" onclick="toggleDetails(this)">
                                                <span class="icon">‚ñ∂</span>
                                                <span>Quality statements</span>
                                            </div>
                                            <div class="details-content">
                                                <ul>
                                                    <li>1: Risk stratification approach in primary care</li>
                                                    <li>2: No imaging requested by non-specialist unless serious pathology suspected</li>
                                                    <li>3: Advice and information for self-management provided</li>
                                                    <li>4: No paracetamol alone, gabapentinoids, antiepileptics, or antidepressants</li>
                                                    <li>5: No opioids for chronic low back pain</li>
                                                    <li>6: No spinal injections (except radiofrequency denervation for selected patients)</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="step-actions">
                                            <button class="action-btn" onclick="showInfo('Audit against NICE quality standards')">
                                                Quality Audit
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Add floating animation to icons
        document.addEventListener('DOMContentLoaded', function() {
            const icons = document.querySelectorAll('.card-icon');
            icons.forEach(icon => {
                icon.classList.add('floating');
            });
        });
        
        // Card toggle functionality
        function toggleCard(header) {
            const card = header.parentElement;
            const isExpanded = card.classList.contains('expanded');
            
            // Close all other cards
            document.querySelectorAll('.section-card').forEach(c => {
                if (c !== card) {
                    c.classList.remove('expanded');
                }
            });
            
            // Toggle current card
            card.classList.toggle('expanded');
            
            // Scroll to card
            setTimeout(() => {
                card.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        // Expand details functionality
        function toggleDetails(toggle) {
            const content = toggle.nextElementSibling;
            toggle.classList.toggle('expanded');
            content.classList.toggle('expanded');
        }

        // Progress tracking
        function updateProgress() {
            const sections = document.querySelectorAll('.algorithm-section');
            const progressSteps = document.querySelectorAll('.progress-step');
            
            sections.forEach((section, index) => {
                const rect = section.getBoundingClientRect();
                const isVisible = rect.top < window.innerHeight / 2 && rect.bottom > window.innerHeight / 2;
                
                if (isVisible) {
                    progressSteps.forEach(step => step.classList.remove('active'));
                    progressSteps[index].classList.add('active');
                }
                
                // Mark as completed if scrolled past
                if (rect.bottom < window.innerHeight / 2) {
                    progressSteps[index].classList.add('completed');
                }
            });
        }

        // Smooth scroll to section
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Expand the target card
            const card = section.querySelector('.section-card');
            setTimeout(() => {
                card.classList.add('expanded');
            }, 300);
            
            // Update active state
            document.querySelectorAll('.progress-step').forEach(step => {
                step.classList.remove('active');
                if (step.dataset.section === sectionId) {
                    step.classList.add('active');
                }
            });
            
            // Close sidebar on mobile
            if (window.innerWidth <= 1024) {
                document.getElementById('progressSidebar').classList.remove('open');
            }
        }

        // Toggle sidebar (mobile)
        function toggleSidebar() {
            const sidebar = document.getElementById('progressSidebar');
            sidebar.classList.toggle('open');
        }

        // Alert functions
        function showAlert(message) {
            alert(message);
        }

        function showInfo(message) {
            alert(message);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Add scroll listener
            window.addEventListener('scroll', updateProgress);
            
            // Add click outside to close sidebar on mobile
            document.addEventListener('click', function(e) {
                const sidebar = document.getElementById('progressSidebar');
                const toggle = document.querySelector('.menu-toggle');
                
                if (window.innerWidth <= 1024 && 
                    !sidebar.contains(e.target) && 
                    !toggle.contains(e.target) &&
                    sidebar.classList.contains('open')) {
                    sidebar.classList.remove('open');
                }
            });
            
            // Add hover effects to badges
            const badges = document.querySelectorAll('.badge');
            badges.forEach(badge => {
                badge.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.1)';
                });
                badge.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1)';
                });
            });
            
            // Make cards visible on scroll
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1 });
            
            document.querySelectorAll('.algorithm-section').forEach(section => {
                observer.observe(section);
            });
            
            // Add smooth transitions for badges
            const style = document.createElement('style');
            style.textContent = `
                .badge {
                    transition: transform 0.3s ease, box-shadow 0.3s ease;
                }
            `;
            document.head.appendChild(style);
        });

        // Handle window resize
        let resizeTimer;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function() {
                if (window.innerWidth > 1024) {
                    document.getElementById('progressSidebar').classList.remove('open');
                }
            }, 250);
        });

        // Print functionality
        function printAlgorithm() {
            window.print();
        }

        // Add keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.getElementById('progressSidebar').classList.remove('open');
            }
            
            // Arrow key navigation
            const sections = ['assessment', 'diagnosis', 'treatment', 'followup'];
            const currentIndex = sections.findIndex(section => {
                const el = document.getElementById(section);
                const rect = el.getBoundingClientRect();
                return rect.top >= 0 && rect.top < window.innerHeight / 2;
            });
            
            if (e.key === 'ArrowDown' && currentIndex < sections.length - 1) {
                scrollToSection(sections[currentIndex + 1]);
            } else if (e.key === 'ArrowUp' && currentIndex > 0) {
                scrollToSection(sections[currentIndex - 1]);
            }
        });

        // Add floating animation to icons
        document.addEventListener('DOMContentLoaded', function() {
            const icons = document.querySelectorAll('.card-icon');
            icons.forEach(icon => {
                icon.classList.add('floating');
            });
        });
    </script>
</body>
</html>