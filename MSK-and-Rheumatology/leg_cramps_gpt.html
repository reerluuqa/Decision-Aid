<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Leg Cramps (Adults) ‚Äî Clinical Decision Support</title>
<style>
  :root{
    --bg:#0b1220;
    --panel:#0f1a31;
    --card:#0f1f3d;
    --muted:#93a4c7;
    --text:#eaf1ff;
    --brand:#55d6be;
    --brand2:#7aa7ff;
    --warn:#ffcc66;
    --danger:#ff5d6c;
    --ok:#5ae28c;
    --line:rgba(255,255,255,.10);
    --shadow:0 12px 30px rgba(0,0,0,.35);
    --radius:18px;
    --radius2:26px;
  }

  @media (prefers-color-scheme: light){
    :root{
      --bg:#f7f9ff;
      --panel:#ffffff;
      --card:#ffffff;
      --muted:#4b5a7a;
      --text:#0b1220;
      --brand:#0bb99e;
      --brand2:#2e67ff;
      --warn:#b86a00;
      --danger:#d83a4a;
      --ok:#1d9b4a;
      --line:rgba(11,18,32,.10);
      --shadow:0 12px 30px rgba(11,18,32,.10);
    }
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font: 15.5px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    color:var(--text);
    background:
      radial-gradient(1200px 700px at 10% -10%, rgba(85,214,190,.20), transparent 60%),
      radial-gradient(900px 600px at 95% 0%, rgba(122,167,255,.25), transparent 55%),
      radial-gradient(900px 600px at 60% 110%, rgba(255,93,108,.15), transparent 55%),
      var(--bg);
  }

  a{color:inherit}
  .wrap{max-width:1200px; margin:0 auto; padding:18px 18px 80px;}
  .topbar{
    position:sticky; top:0; z-index:50;
    backdrop-filter:saturate(130%) blur(10px);
    background:linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,0));
    border-bottom:1px solid var(--line);
  }
  .topbar .inner{
    max-width:1200px; margin:0 auto; padding:12px 18px;
    display:flex; gap:14px; align-items:center; flex-wrap:wrap;
  }
  .brandmark{
    display:flex; align-items:center; gap:12px; min-width:260px;
  }
  .logo{
    width:42px; height:42px; border-radius:14px;
    background:
      linear-gradient(135deg, rgba(85,214,190,.95), rgba(122,167,255,.95));
    box-shadow: var(--shadow);
    display:grid; place-items:center;
    flex:0 0 auto;
  }
  .logo svg{filter:drop-shadow(0 8px 14px rgba(0,0,0,.25))}
  .titleblock{display:flex; flex-direction:column; gap:2px}
  .titleblock h1{
    margin:0; font-size:16.5px; letter-spacing:.2px;
  }
  .titleblock .sub{
    color:var(--muted); font-size:12.5px
  }

  .chips{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
  .chip{
    border:1px solid var(--line);
    background:rgba(255,255,255,.06);
    padding:8px 10px; border-radius:999px;
    display:flex; gap:8px; align-items:center;
  }
  .chip input, .chip select{
    border:none; outline:none; background:transparent; color:var(--text);
    font:inherit;
  }
  .chip input::placeholder{color:color-mix(in oklab, var(--muted), transparent 30%)}
  .chip select option{color:#0b1220}
  .chip .kbd{
    font-size:12px; color:var(--muted); border:1px dashed var(--line);
    padding:2px 8px; border-radius:999px;
  }

  .nav{
    display:flex; gap:8px; align-items:center; flex-wrap:wrap;
    margin-left:auto;
  }
  .nav a{
    text-decoration:none;
    padding:9px 10px;
    border-radius:999px;
    border:1px solid transparent;
    color:var(--muted);
    transition: .15s ease;
  }
  .nav a:hover{border-color:var(--line); color:var(--text); background:rgba(255,255,255,.05)}
  .nav a.active{color:var(--text); background:rgba(85,214,190,.10); border-color:rgba(85,214,190,.35)}

  .grid{
    display:grid; gap:16px;
    grid-template-columns: 360px 1fr;
    margin-top:18px;
  }
  @media (max-width: 980px){
    .grid{grid-template-columns:1fr}
  }

  .side{
    position:sticky; top:88px; align-self:start;
    display:flex; flex-direction:column; gap:14px;
  }
  @media (max-width: 980px){
    .side{position:relative; top:auto}
  }

  .card{
    background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
    border:1px solid var(--line);
    border-radius:var(--radius2);
    box-shadow: var(--shadow);
    overflow:hidden;
  }
  .card .hd{
    padding:14px 16px;
    display:flex; gap:10px; align-items:flex-start; justify-content:space-between;
    border-bottom:1px solid var(--line);
  }
  .card .hd h2{
    margin:0; font-size:15px; letter-spacing:.2px;
  }
  .card .hd .hint{color:var(--muted); font-size:12.5px}
  .card .bd{padding:14px 16px}

  .pillrow{display:flex; gap:10px; flex-wrap:wrap}
  .pill{
    display:flex; gap:10px; align-items:center;
    padding:10px 12px;
    border-radius:14px;
    border:1px solid var(--line);
    background:rgba(255,255,255,.03);
  }
  .pill b{font-size:12px; letter-spacing:.2px}
  .pill .mini{color:var(--muted); font-size:12px}
  .pill .dot{width:10px; height:10px; border-radius:50%}
  .dot.danger{background:var(--danger)}
  .dot.warn{background:var(--warn)}
  .dot.ok{background:var(--ok)}
  .dot.brand{background:var(--brand)}

  .btn{
    cursor:pointer;
    border:1px solid var(--line);
    background:rgba(255,255,255,.06);
    color:var(--text);
    padding:10px 12px;
    border-radius:14px;
    font:inherit;
    display:inline-flex; gap:10px; align-items:center;
    transition:.15s ease;
  }
  .btn:hover{transform:translateY(-1px); background:rgba(255,255,255,.08)}
  .btn.primary{border-color:rgba(85,214,190,.45); background:rgba(85,214,190,.12)}
  .btn.danger{border-color:rgba(255,93,108,.45); background:rgba(255,93,108,.10)}
  .btn.small{padding:8px 10px; border-radius:12px; font-size:13px}
  .btn .ic{width:18px; height:18px; flex:0 0 auto}

  .main{
    display:flex; flex-direction:column; gap:16px;
  }
  .section{
    scroll-margin-top:100px;
  }

  .hero{
    padding:18px 18px 16px;
    border-radius:var(--radius2);
    border:1px solid var(--line);
    background:
      linear-gradient(135deg, rgba(85,214,190,.12), rgba(122,167,255,.10)),
      linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    box-shadow: var(--shadow);
  }
  .hero h2{margin:0 0 6px; font-size:20px; letter-spacing:.2px}
  .hero p{margin:0; color:var(--muted)}
  .hero .meta{
    display:flex; gap:10px; flex-wrap:wrap; margin-top:12px
  }
  .tag{
    border:1px solid var(--line);
    background:rgba(255,255,255,.05);
    padding:7px 10px; border-radius:999px; color:var(--muted);
    font-size:12.5px;
    display:inline-flex; gap:8px; align-items:center;
  }
  .tag strong{color:var(--text); font-weight:700}
  .tag .ic{width:16px;height:16px}

  .panel{
    background:rgba(255,255,255,.03);
    border:1px solid var(--line);
    border-radius:var(--radius2);
    overflow:hidden;
  }
  .panel .ph{
    padding:14px 16px;
    display:flex; gap:12px; align-items:flex-start; justify-content:space-between;
    border-bottom:1px solid var(--line);
  }
  .panel .ph h3{margin:0; font-size:15.5px}
  .panel .ph .sub{color:var(--muted); font-size:12.5px; margin-top:2px}
  .panel .pb{padding:14px 16px}

  .split{
    display:grid; gap:12px;
    grid-template-columns: 1fr 1fr;
  }
  @media (max-width: 780px){
    .split{grid-template-columns:1fr}
  }

  .alert{
    border-radius:18px;
    border:1px solid var(--line);
    padding:12px 12px 12px 14px;
    display:flex; gap:12px; align-items:flex-start;
    background:rgba(255,255,255,.03);
  }
  .alert .badge{
    width:34px; height:34px; border-radius:14px;
    display:grid; place-items:center;
    flex:0 0 auto;
  }
  .alert.danger{border-color:rgba(255,93,108,.35); background:rgba(255,93,108,.08)}
  .alert.danger .badge{background:rgba(255,93,108,.18)}
  .alert.warn{border-color:rgba(255,204,102,.30); background:rgba(255,204,102,.09)}
  .alert.warn .badge{background:rgba(255,204,102,.18)}
  .alert.ok{border-color:rgba(90,226,140,.28); background:rgba(90,226,140,.08)}
  .alert.ok .badge{background:rgba(90,226,140,.16)}
  .alert .ttl{font-weight:800; margin:0 0 2px}
  .alert .txt{margin:0; color:var(--text)}
  .alert .muted{color:var(--muted); font-size:13px; margin-top:6px}

  .steps{
    counter-reset: step;
    display:flex; flex-direction:column; gap:10px;
  }
  .step{
    display:flex; gap:12px; align-items:flex-start;
    padding:12px 12px 12px 12px;
    border:1px solid var(--line);
    border-radius:18px;
    background:rgba(255,255,255,.03);
  }
  .step::before{
    counter-increment: step;
    content: counter(step);
    width:28px; height:28px;
    border-radius:12px;
    background:rgba(122,167,255,.16);
    border:1px solid rgba(122,167,255,.25);
    display:grid; place-items:center;
    font-weight:800;
    flex:0 0 auto;
  }
  .step h4{margin:0 0 2px; font-size:14.5px}
  .step p{margin:0; color:var(--muted)}
  .klist{margin:8px 0 0 0; padding:0 0 0 18px; color:var(--text)}
  .klist li{margin:6px 0; color:var(--text)}
  .klist li span{color:var(--muted)}
  .inline{
    display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:10px
  }

  details.acc{
    border:1px solid var(--line);
    border-radius:18px;
    background:rgba(255,255,255,.03);
    overflow:hidden;
  }
  details.acc summary{
    cursor:pointer;
    list-style:none;
    padding:12px 14px;
    display:flex; align-items:center; justify-content:space-between;
    gap:12px;
  }
  details.acc summary::-webkit-details-marker{display:none}
  details.acc summary .left{display:flex; gap:10px; align-items:center}
  .chev{width:18px; height:18px; transition:.18s ease; opacity:.75}
  details[open] .chev{transform:rotate(180deg)}
  details.acc .content{
    padding:0 14px 14px;
    border-top:1px solid var(--line);
    color:var(--text);
  }

  .cols{
    display:grid; gap:12px;
    grid-template-columns: 1fr 1fr 1fr;
  }
  @media (max-width: 980px){ .cols{grid-template-columns:1fr} }
  .miniCard{
    border:1px solid var(--line);
    border-radius:18px;
    padding:12px 12px;
    background:rgba(255,255,255,.03);
  }
  .miniCard h5{margin:0 0 6px; font-size:13.5px}
  .miniCard p{margin:0; color:var(--muted); font-size:13px}
  .mono{
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size:12.5px;
    background:rgba(0,0,0,.15);
    border:1px solid var(--line);
    padding:10px 12px;
    border-radius:14px;
    overflow:auto;
  }
  @media (prefers-color-scheme: light){
    .mono{background:rgba(11,18,32,.04)}
  }

  .footer{
    margin-top:20px;
    color:var(--muted);
    font-size:12.5px;
    display:flex; justify-content:space-between; flex-wrap:wrap; gap:10px;
    padding:14px 2px 0;
    border-top:1px solid var(--line);
  }

  /* content visibility controls */
  [data-urgency="urgent"]{ }
  .hideRoutine [data-urgency="routine"]{display:none !important}
  .hideUrgent [data-urgency="urgent"]{display:none !important}

  /* highlight search hits */
  mark.hit{
    background:rgba(255,204,102,.25);
    color:inherit;
    padding:0 2px;
    border-radius:6px;
  }

  /* print */
  @media print{
    body{background:#fff; color:#000}
    .topbar, .side, .nav{display:none !important}
    .wrap{max-width:none}
    .card, .panel, .hero{box-shadow:none}
    .mono{border:1px solid #ddd}
  }
</style>
</head>
<body>

<header class="topbar" role="banner">
  <div class="inner">
    <div class="brandmark">
      <div class="logo" aria-hidden="true">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
          <path d="M12 2c4.97 0 9 4.03 9 9 0 5.9-6.02 11.29-8.23 13.09a1.2 1.2 0 0 1-1.54 0C9.02 22.29 3 16.9 3 11c0-4.97 4.03-9 9-9Z" stroke="white" stroke-width="1.6"/>
          <path d="M7.2 12h3.2l1.1-2.3 1.4 5.2 1.2-2.9H16.8" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="titleblock">
        <h1>Leg Cramps (Adults) ‚Äî Rapid Assessment & Management</h1>
        <div class="sub">Clinical decision support ‚Ä¢ Designed for scanning ‚Ä¢ Self-contained</div>
      </div>
    </div>

    <div class="chips" role="group" aria-label="Quick controls">
      <div class="chip" title="Search this page (press /)">
        <span aria-hidden="true">üîé</span>
        <input id="q" type="search" placeholder="Search: ‚Äúquinine‚Äù, ‚ÄúDVT‚Äù, ‚Äúlabs‚Äù‚Ä¶"/>
        <span class="kbd">/</span>
      </div>

      <div class="chip" title="Filter by urgency">
        <span aria-hidden="true">üéõÔ∏è</span>
        <select id="urgency">
          <option value="all">Show: Urgent + routine</option>
          <option value="urgent">Urgent only</option>
          <option value="routine">Routine only</option>
        </select>
      </div>

      <div class="chip" title="Clinical context toggles (local display only)">
        <span aria-hidden="true">üè•</span>
        <select id="context">
          <option value="general">Context: general</option>
          <option value="ed">Context: ED / acute</option>
          <option value="primary">Context: primary care</option>
        </select>
      </div>

      <button class="btn small" id="reset" title="Reset filters and search">
        <svg class="ic" viewBox="0 0 24 24" fill="none"><path d="M21 12a9 9 0 1 1-2.64-6.36" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/><path d="M21 3v6h-6" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Reset
      </button>
    </div>

    <nav class="nav" aria-label="On-page navigation">
      <a href="#triage" data-nav>üö® Triage</a>
      <a href="#diagnosis" data-nav>üß† Dx</a>
      <a href="#workup" data-nav>üß™ Work-up</a>
      <a href="#management" data-nav>üß© Management</a>
      <a href="#quinine" data-nav>üíä Quinine</a>
      <a href="#differentials" data-nav>üß∑ Mimics</a>
    </nav>
  </div>
</header>

<main class="wrap" role="main">
  <section class="hero" aria-label="Summary">
    <h2>Fast pathway for suspected nocturnal/idiopathic leg cramps (‚â•18y)</h2>
    <p>Use this when cramps occur at rest/night, are brief (seconds to &lt;10 min), focal (often calf/foot), and improve with stretching. Separate urgent physiology and alternative diagnoses early.</p>

    <div class="meta">
      <span class="tag"><svg class="ic" viewBox="0 0 24 24" fill="none"><path d="M12 8v5l3 2" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/><path d="M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10Z" stroke="currentColor" stroke-width="1.7"/></svg><strong>Core pattern:</strong> sudden, painful contraction + palpable ‚Äúknot‚Äù</span>
      <span class="tag"><svg class="ic" viewBox="0 0 24 24" fill="none"><path d="M4 12h16" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/><path d="M12 4v16" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/></svg><strong>First-line:</strong> stretching, massage, sleep-position tweaks</span>
      <span class="tag"><svg class="ic" viewBox="0 0 24 24" fill="none"><path d="M12 3v18" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/><path d="M7 8h10" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/><path d="M7 16h10" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/></svg><strong>Quinine:</strong> generally not recommended; consider only selected cases</span>
    </div>
  </section>

  <div class="grid">
    <!-- LEFT: quick actions -->
    <aside class="side" aria-label="Quick actions">
      <div class="card">
        <div class="hd">
          <div>
            <h2>Visual flags</h2>
            <div class="hint">Instant triage at a glance</div>
          </div>
          <button class="btn small" id="expandAll" title="Expand all accordion sections">
            <svg class="ic" viewBox="0 0 24 24" fill="none"><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
            Expand
          </button>
        </div>
        <div class="bd">
          <div class="pillrow">
            <div class="pill"><span class="dot danger"></span><div><b>Urgent physiology</b><div class="mini">altered consciousness / anuria / hyper- or hypopyrexia</div></div></div>
            <div class="pill"><span class="dot warn"></span><div><b>Organic cause likely</b><div class="mini">&gt;10 min duration ‚Ä¢ widespread cramps ‚Ä¢ abnormal exam</div></div></div>
            <div class="pill"><span class="dot brand"></span><div><b>Typical idiopathic</b><div class="mini">&lt;10 min ‚Ä¢ unilateral ‚Ä¢ normal exam ‚Ä¢ stretch response</div></div></div>
            <div class="pill"><span class="dot ok"></span><div><b>Self-care first</b><div class="mini">stretch/massage ‚Ä¢ sleep positioning ‚Ä¢ consider analgesia after</div></div></div>
          </div>

          <div class="inline" style="margin-top:14px">
            <button class="btn primary" id="copyCrampsNote" title="Copy a concise clinical note to clipboard">
              <svg class="ic" viewBox="0 0 24 24" fill="none"><path d="M8 7h12v14H8z" stroke="currentColor" stroke-width="1.7"/><path d="M4 17H3a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h13a1 1 0 0 1 1 1v1" stroke="currentColor" stroke-width="1.7"/></svg>
              Copy note
            </button>
            <button class="btn" onclick="window.print()" title="Print-friendly view">
              <svg class="ic" viewBox="0 0 24 24" fill="none"><path d="M6 9V3h12v6" stroke="currentColor" stroke-width="1.7"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" stroke="currentColor" stroke-width="1.7"/><path d="M6 14h12v7H6z" stroke="currentColor" stroke-width="1.7"/></svg>
              Print
            </button>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="hd">
          <div>
            <h2>One-minute checklist</h2>
            <div class="hint">Use on first contact</div>
          </div>
        </div>
        <div class="bd">
          <div class="steps" id="checklist">
            <div class="step">
              <div>
                <h4>Rule out urgent physiology</h4>
                <p>Severe cramps + altered consciousness / anuria / hyper- or hypopyrexia ‚Üí admit.</p>
              </div>
            </div>
            <div class="step">
              <div>
                <h4>Confirm the ‚Äúcramp phenotype‚Äù</h4>
                <p>Brief, painful contraction, visible/palpable muscle tightening, relieved by stretching.</p>
              </div>
            </div>
            <div class="step">
              <div>
                <h4>Screen for organic cause</h4>
                <p>&gt;10 min duration, widespread cramps, exercise-related calf pain, neuro deficits, vascular signs, systemic disease, meds.</p>
              </div>
            </div>
          </div>

          <details class="acc" style="margin-top:12px">
            <summary>
              <span class="left"><span aria-hidden="true">üßæ</span><b>Cramp diary (template)</b></span>
              <svg class="chev" viewBox="0 0 24 24" fill="none"><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </summary>
            <div class="content">
              <div class="mono" id="diary">
Date: ____  Time: ____  Side: L / R  Muscle: calf / foot / thigh
Duration: ____ min   Severity (0‚Äì10): ____
Trigger: rest / night / after exercise / new medication / dehydration?  
Relief: stretch / massage / walking / heat / other: ____
Associated: weakness / numbness / swelling / fever / urine output change: ____
              </div>
              <div class="inline">
                <button class="btn small" data-copy="#diary">Copy template</button>
              </div>
            </div>
          </details>
        </div>
      </div>
    </aside>

    <!-- RIGHT: main content -->
    <div class="main">

      <!-- TRIAGE -->
      <section id="triage" class="section panel" aria-label="Triage">
        <div class="ph">
          <div>
            <h3>üö® Triage & immediate actions</h3>
            <div class="sub">Separate urgent physiology from routine idiopathic cramps.</div>
          </div>
          <div class="inline">
            <button class="btn small danger" data-jump="#triage">Jump</button>
          </div>
        </div>
        <div class="pb">
          <div class="split">
            <div class="alert danger" data-urgency="urgent">
              <div class="badge" aria-hidden="true">‚õî</div>
              <div>
                <div class="ttl">Admit / urgent escalation</div>
                <p class="txt">Severe cramps with <b>altered consciousness</b>, <b>anuria</b>, or <b>hyper- or hypopyrexia</b>.</p>
                <div class="muted">Think systemic/metabolic/toxic causes; treat physiology first.</div>
              </div>
            </div>

            <div class="alert warn" data-urgency="routine">
              <div class="badge" aria-hidden="true">‚ö†Ô∏è</div>
              <div>
                <div class="ttl">Organic cause more likely</div>
                <p class="txt">Duration <b>&gt;10 min</b>, <b>widespread</b> cramps, abnormal neuro/musculoskeletal exam, vascular signs, exercise-related calf pain, or systemic features.</p>
                <div class="muted">Pivot to targeted work-up and/or referral pathway.</div>
              </div>
            </div>
          </div>

          <div class="panel" style="margin-top:12px">
            <div class="ph">
              <div>
                <h3>At-the-bedside relief (active cramp)</h3>
                <div class="sub">Quick, low-risk interventions for symptom control.</div>
              </div>
            </div>
            <div class="pb" data-urgency="routine">
              <div class="steps">
                <div class="step">
                  <div>
                    <h4>Stretch + massage the involved muscle</h4>
                    <p>If calf cramp: straighten leg and dorsiflex ankle. Most idiopathic cramps settle within minutes.</p>
                  </div>
                </div>
                <div class="step">
                  <div>
                    <h4>After-cramp soreness</h4>
                    <p>Consider analgesia if residual tenderness; analgesia during cramp is usually impractical.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </section>

      <!-- DIAGNOSIS -->
      <section id="diagnosis" class="section panel" aria-label="Diagnosis">
        <div class="ph">
          <div>
            <h3>üß† Diagnosis: identify typical idiopathic cramps vs secondary causes</h3>
            <div class="sub">History and examination usually sufficient; investigations only if atypical or suspected underlying cause.</div>
          </div>
        </div>
        <div class="pb">
          <div class="cols">
            <div class="miniCard" data-urgency="routine">
              <h5>Typical idiopathic pattern</h5>
              <ul class="klist">
                <li>Sudden intense calf/foot pain (rarely thigh), often at night/rest</li>
                <li>Visible/palpable knotting or abnormal posture</li>
                <li>Duration seconds to &lt;10 minutes; single muscle; often unilateral</li>
                <li>Normal physical examination; good response to stretching</li>
              </ul>
            </div>

            <div class="miniCard" data-urgency="routine">
              <h5>Features suggesting alternative diagnosis</h5>
              <ul class="klist">
                <li><b>&gt;10 min</b> duration <span>(organic cause)</span></li>
                <li><b>Widespread</b> cramps <span>(‚Üë suspicion motor neurone disease)</span></li>
                <li>Exercise calf pain / urge to move legs / numbness or weakness</li>
                <li>Neuro signs: wasting, fasciculations, dystonia, sensory loss, altered reflexes</li>
                <li>Vascular signs: swelling, varicosities, abnormal pulses</li>
              </ul>
            </div>

            <div class="miniCard" data-urgency="routine">
              <h5>Think about drivers</h5>
              <p>Systemic disease (renal failure/haemodialysis, liver disease, thyroid disease, diabetes, Addison‚Äôs), electrolyte disturbances (K/Na/Ca/Mg), vitamin B or D deficiency, pregnancy, strenuous exercise, and medication triggers (e.g., diuretics, statins, LABA, nifedipine, imatinib).</p>
            </div>
          </div>

          <details class="acc" style="margin-top:12px">
            <summary>
              <span class="left"><span aria-hidden="true">üß≠</span><b>Structured history & exam prompts</b> <span style="color:var(--muted); font-size:12.5px">‚Äî quick scan</span></span>
              <svg class="chev" viewBox="0 0 24 24" fill="none"><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </summary>
            <div class="content">
              <div class="split">
                <div>
                  <ul class="klist">
                    <li><b>Pattern</b>: nocturnal/rest vs exertional; focal vs generalized; duration per episode</li>
                    <li><b>Relief</b>: response to stretching/massage</li>
                    <li><b>Neuro</b>: weakness, numbness, fasciculations; gait change</li>
                    <li><b>Vascular</b>: claudication, cold feet, ulcers, varicosities, unilateral swelling</li>
                  </ul>
                </div>
                <div>
                  <ul class="klist">
                    <li><b>Systemic</b>: fever, reduced urine output, endocrine symptoms</li>
                    <li><b>Comorbids</b>: renal, liver, thyroid, diabetes, neuromuscular disease</li>
                    <li><b>Medication review</b>: diuretics, statins, LABA, calcium-channel blockers, etc.</li>
                    <li><b>Exam</b>: pulses, calf size, varicosities; neuro exam; musculoskeletal assessment</li>
                  </ul>
                </div>
              </div>
            </div>
          </details>

        </div>
      </section>

      <!-- WORKUP -->
      <section id="workup" class="section panel" aria-label="Work-up">
        <div class="ph">
          <div>
            <h3>üß™ Investigations (only if atypical or underlying cause suspected)</h3>
            <div class="sub">Avoid routine ‚Äúshotgun‚Äù panels in typical idiopathic cramps.</div>
          </div>
        </div>
        <div class="pb" data-urgency="routine">
          <div class="alert ok">
            <div class="badge" aria-hidden="true">‚úÖ</div>
            <div>
              <div class="ttl">If typical idiopathic features + normal examination</div>
              <p class="txt">Investigations usually not required.</p>
              <div class="muted">Safety net: return if frequency/severity/nature changes or QoL impact develops.</div>
            </div>
          </div>

          <details class="acc" style="margin-top:12px" open>
            <summary>
              <span class="left"><span aria-hidden="true">üß´</span><b>Suggested targeted investigations</b></span>
              <svg class="chev" viewBox="0 0 24 24" fill="none"><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </summary>
            <div class="content">
              <div class="cols">
                <div class="miniCard">
                  <h5>Blood tests</h5>
                  <p>Urea/creatinine, electrolytes, calcium, thyroid function, fasting glucose, liver function, creatine kinase (if myalgia/myositis suspected).</p>
                </div>
                <div class="miniCard">
                  <h5>Vascular evaluation</h5>
                  <p>Vascular studies if claudication/peripheral arterial disease suspected.</p>
                </div>
                <div class="miniCard">
                  <h5>Imaging</h5>
                  <p>Lumbar spine imaging if nerve root entrapment/lumbar canal stenosis suspected.</p>
                </div>
              </div>
            </div>
          </details>
        </div>
      </section>

      <!-- MANAGEMENT -->
      <section id="management" class="section panel" aria-label="Management">
        <div class="ph">
          <div>
            <h3>üß© Management: idiopathic leg cramps</h3>
            <div class="sub">Self-care + reassurance first. Escalate only when cramps are frequent, painful, and impair sleep/QoL.</div>
          </div>
        </div>
        <div class="pb">

          <div class="split">
            <div class="alert ok" data-urgency="routine">
              <div class="badge" aria-hidden="true">üü¢</div>
              <div>
                <div class="ttl">Reassure + safety-net</div>
                <p class="txt">Idiopathic cramps are common and may resolve spontaneously; there is limited safe, proven prophylaxis.</p>
                <div class="muted">If no underlying concern and no QoL impact ‚Üí often no further management needed.</div>
              </div>
            </div>

            <div class="alert warn" data-urgency="routine">
              <div class="badge" aria-hidden="true">üü°</div>
              <div>
                <div class="ttl">When QoL is affected</div>
                <p class="txt">Offer structured self-care; consider pharmacotherapy only after excluding treatable causes and failed non-drug measures.</p>
                <div class="muted">Use a diary to quantify benefit/harm.</div>
              </div>
            </div>
          </div>

          <div class="panel" style="margin-top:12px" data-urgency="routine">
            <div class="ph">
              <div>
                <h3>Self-care (prevention and acute management)</h3>
                <div class="sub">Traditional measures have limited evidence, but low risk and often acceptable.</div>
              </div>
            </div>
            <div class="pb">
              <div class="steps">
                <div class="step">
                  <div>
                    <h4>During an attack</h4>
                    <ul class="klist">
                      <li>Stretch and massage the affected muscle(s)</li>
                      <li>For calf: straighten leg + dorsiflex ankle</li>
                    </ul>
                  </div>
                </div>
                <div class="step">
                  <div>
                    <h4>Reduce recurrence</h4>
                    <ul class="klist">
                      <li>Stretch affected muscle(s) <b>3√ó daily</b>; continue if helpful</li>
                      <li>Consider combined daily calf + hamstring stretching (may be more effective than calf alone)</li>
                    </ul>
                  </div>
                </div>
                <div class="step">
                  <div>
                    <h4>Sleep positioning</h4>
                    <ul class="klist">
                      <li>Reduce plantarflexion: pillow under feet supine, or feet over bed-end if prone</li>
                      <li>Keep blankets loose; avoid heavy bed covers</li>
                    </ul>
                  </div>
                </div>
                <div class="step">
                  <div>
                    <h4>Post-cramp pain</h4>
                    <p>Analgesia may help residual tenderness; typically not useful during the cramp itself.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </section>

      <!-- QUININE -->
      <section id="quinine" class="section panel" aria-label="Quinine">
        <div class="ph">
          <div>
            <h3>üíä Quinine (selected use only)</h3>
            <div class="sub">Poor benefit-to-risk ratio: treat as an exception, not default.</div>
          </div>
          <div class="inline">
            <button class="btn small" data-copy="#quinineRegimen">Copy regimen</button>
          </div>
        </div>

        <div class="pb">
          <div class="alert warn" data-urgency="routine">
            <div class="badge" aria-hidden="true">‚öñÔ∏è</div>
            <div>
              <div class="ttl">When to consider a trial</div>
              <p class="txt">Only if treatable causes excluded and cramps are very painful/frequent, disrupt sleep/QoL, and self-care has failed; check comorbids/interactions and discuss adverse effects.</p>
            </div>
          </div>

          <div class="split" style="margin-top:12px">
            <div class="panel">
              <div class="ph">
                <div>
                  <h3>Regimen & monitoring</h3>
                  <div class="sub">Use a diary to determine benefit objectively.</div>
                </div>
              </div>
              <div class="pb">
                <div class="mono" id="quinineRegimen">Quinine 200‚Äì300 mg PO at bedtime for 4 weeks.
‚Ä¢ Monitor benefit with sleep/cramp diary.
‚Ä¢ If no benefit after 4 weeks ‚Üí stop.
‚Ä¢ If beneficial ‚Üí continue for 3 months, then attempt stop to reassess.
‚Ä¢ If ongoing need ‚Üí review every 3 months; consider trial discontinuation.
‚Ä¢ Do not exceed recommended dose.</div>
              </div>
            </div>

            <div class="panel">
              <div class="ph">
                <div>
                  <h3>Safety signals (stop / urgent review)</h3>
                  <div class="sub">High-toxicity drug; overdose can be catastrophic.</div>
                </div>
              </div>
              <div class="pb">
                <div class="alert danger" data-urgency="urgent">
                  <div class="badge" aria-hidden="true">ü©∏</div>
                  <div>
                    <div class="ttl">Possible thrombocytopenia</div>
                    <p class="txt">Unexplained petechiae, bruising, or bleeding during treatment.</p>
                  </div>
                </div>

                <details class="acc" style="margin-top:10px">
                  <summary>
                    <span class="left"><span aria-hidden="true">üß†</span><b>Adverse effects & key contraindications</b></span>
                    <svg class="chev" viewBox="0 0 24 24" fill="none"><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
                  </summary>
                  <div class="content">
                    <div class="cols">
                      <div class="miniCard">
                        <h5>Do not prescribe if</h5>
                        <ul class="klist">
                          <li>Previous adverse reaction to quinine (including tonic water)</li>
                          <li>Haemolysis/haemoglobinuria</li>
                          <li>Optic neuritis</li>
                          <li>Tinnitus</li>
                          <li>Myasthenia gravis</li>
                          <li>Pregnancy (for cramps)</li>
                        </ul>
                      </div>
                      <div class="miniCard">
                        <h5>Caution</h5>
                        <ul class="klist">
                          <li>Older age</li>
                          <li>Cardiac disease / QT prolongation risk, AF, conduction defects/heart block</li>
                          <li>Electrolyte disturbance</li>
                          <li>G6PD deficiency (‚Üë haemolysis risk)</li>
                        </ul>
                      </div>
                      <div class="miniCard">
                        <h5>Notable harms</h5>
                        <ul class="klist">
                          <li>Overdose: vision loss, arrhythmias, seizures, respiratory depression, renal failure</li>
                          <li>Cinchonism: nausea/vomiting, headache, tinnitus/deafness, visual disturbance</li>
                          <li>QT prolongation / AV conduction changes</li>
                          <li>Thrombocytopenia / pancytopenia (rare)</li>
                        </ul>
                      </div>
                    </div>

                    <details class="acc" style="margin-top:10px">
                      <summary>
                        <span class="left"><span aria-hidden="true">üîó</span><b>Interaction highlights</b> <span style="color:var(--muted); font-size:12.5px">‚Äî check full list in BNF/eMC</span></span>
                        <svg class="chev" viewBox="0 0 24 24" fill="none"><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
                      </summary>
                      <div class="content">
                        <ul class="klist">
                          <li>‚Üë toxicity with CYP3A4 inhibitors (e.g., azoles; HIV protease inhibitors)</li>
                          <li>‚Üì levels with CYP3A4 inducers (rifampicin, carbamazepine, phenytoin)</li>
                          <li>QT-prolonging drugs (e.g., amiodarone, macrolides, SSRIs like citalopram/escitalopram, moxifloxacin, ondansetron, sotalol, etc.) ‚Üí ‚Üë ventricular arrhythmia risk</li>
                          <li>May increase levels of flecainide, digoxin/cardiac glycosides, mefloquine, amantadine</li>
                          <li>Anticoagulants: may enhance effect; hypoglycaemics: ‚Üë hypoglycaemia risk</li>
                        </ul>
                      </div>
                    </details>
                  </div>
                </details>
              </div>
            </div>
          </div>

        </div>
      </section>

      <!-- DIFFERENTIALS -->
      <section id="differentials" class="section panel" aria-label="Differential diagnosis">
        <div class="ph">
          <div>
            <h3>üß∑ Mimics & differential diagnoses</h3>
            <div class="sub">Use these when the phenotype is atypical or the exam is abnormal.</div>
          </div>
        </div>
        <div class="pb">
          <details class="acc" open>
            <summary>
              <span class="left"><span aria-hidden="true">üß©</span><b>Common mimics</b></span>
              <svg class="chev" viewBox="0 0 24 24" fill="none"><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </summary>
            <div class="content">
              <div class="cols">
                <div class="miniCard">
                  <h5>Restless legs syndrome</h5>
                  <p>Irritating/burning/crawling sensation with urge to move; movement relieves; no painful muscle tightening.</p>
                </div>
                <div class="miniCard">
                  <h5>Claudication (PAD)</h5>
                  <p>Aching/cramping with exercise, relieved by rest; peripheral pulses may be reduced.</p>
                </div>
                <div class="miniCard">
                  <h5>DVT / Baker‚Äôs cyst</h5>
                  <p>DVT: swelling, warmth, redness. Baker‚Äôs cyst: swelling/pain in calf/popliteal fossa.</p>
                </div>
              </div>

              <div class="cols" style="margin-top:12px">
                <div class="miniCard">
                  <h5>Neuropathy / neuro disease</h5>
                  <p>Numbness/tingling/neuropathic pain ¬± cramps; objective sensory/motor signs often present.</p>
                </div>
                <div class="miniCard">
                  <h5>Myalgia / myositis</h5>
                  <p>Deep aching pain without contraction; weakness and reduced tolerance; consider statin-associated myalgia.</p>
                </div>
                <div class="miniCard">
                  <h5>Dystonia / myoclonus / periodic limb movement</h5>
                  <p>Dystonia not relieved by stretching; myoclonus is jerking without pain; PLMD is rhythmic dorsiflexion during sleep.</p>
                </div>
              </div>
            </div>
          </details>

          <details class="acc" style="margin-top:12px">
            <summary>
              <span class="left"><span aria-hidden="true">üìå</span><b>Referral triggers</b></span>
              <svg class="chev" viewBox="0 0 24 24" fill="none"><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </summary>
            <div class="content">
              <div class="alert danger" data-urgency="urgent">
                <div class="badge" aria-hidden="true">üè•</div>
                <div>
                  <div class="ttl">Hospital admission</div>
                  <p class="txt">Severe cramps + altered consciousness, anuria, or hyper-/hypopyrexia.</p>
                </div>
              </div>

              <div class="alert warn" style="margin-top:10px" data-urgency="routine">
                <div class="badge" aria-hidden="true">üßë‚Äç‚öïÔ∏è</div>
                <div>
                  <div class="ttl">Specialist referral</div>
                  <p class="txt">Underlying cause suspected beyond primary care (e.g., neurology/rheumatology), diagnosis uncertain, or primary care treatment fails and QoL is affected.</p>
                </div>
              </div>
            </div>
          </details>
        </div>
      </section>

      <div class="footer">
        <div>
          <b>Source basis:</b> NICE CKS ‚ÄúLeg cramps‚Äù (last revised Dec 2022). Content adapted for bedside scanning.
        </div>
        <div>
          Tips: press <span class="kbd">/</span> to search ‚Ä¢ Use urgency filter ‚Ä¢ Print for handover
        </div>
      </div>

    </div>
  </div>
</main>

<script>
(function(){
  const $ = (q, root=document) => root.querySelector(q);
  const $$ = (q, root=document) => Array.from(root.querySelectorAll(q));

  const store = {
    get(k, d){ try{ return JSON.parse(localStorage.getItem(k)) ?? d }catch{ return d } },
    set(k,v){ try{ localStorage.setItem(k, JSON.stringify(v)) }catch{} }
  };

  const q = $("#q");
  const urgency = $("#urgency");
  const context = $("#context");
  const reset = $("#reset");

  // keyboard: / focus search, Esc clear
  window.addEventListener("keydown", (e)=>{
    if(e.key === "/" && !/input|textarea|select/i.test(document.activeElement.tagName)){
      e.preventDefault(); q.focus();
    }
    if(e.key === "Escape"){
      if(document.activeElement === q){ q.blur(); }
      q.value = "";
      applySearch("");
    }
  });

  // urgency filtering
  function applyUrgency(val){
    document.body.classList.remove("hideRoutine","hideUrgent");
    if(val === "urgent") document.body.classList.add("hideRoutine");
    if(val === "routine") document.body.classList.add("hideUrgent");
    store.set("urgency", val);
  }

  // context nudges (visual only)
  function applyContext(val){
    document.body.dataset.context = val;
    // subtle: set default urgency focus in ED
    if(val === "ed" && urgency.value === "all"){
      // no forced change; just leave as-is
    }
    store.set("context", val);
  }

  // search highlighting
  function clearMarks(){
    $$("mark.hit").forEach(m=>{
      const t = document.createTextNode(m.textContent);
      m.replaceWith(t);
    });
  }

  function markMatches(root, term){
    const walker = document.createTreeWalker(root, NodeFilter.SHOW_TEXT, {
      acceptNode(node){
        if(!node.nodeValue || !node.nodeValue.trim()) return NodeFilter.FILTER_REJECT;
        const parent = node.parentElement;
        if(!parent) return NodeFilter.FILTER_REJECT;
        if(["SCRIPT","STYLE","MARK"].includes(parent.tagName)) return NodeFilter.FILTER_REJECT;
        if(parent.closest("input, textarea, select, button")) return NodeFilter.FILTER_REJECT;
        if(!node.nodeValue.toLowerCase().includes(term)) return NodeFilter.FILTER_REJECT;
        return NodeFilter.FILTER_ACCEPT;
      }
    });
    const hits = [];
    while(walker.nextNode()) hits.push(walker.currentNode);
    hits.forEach(node=>{
      const text = node.nodeValue;
      const idx = text.toLowerCase().indexOf(term);
      if(idx < 0) return;
      const before = document.createTextNode(text.slice(0, idx));
      const match = document.createElement("mark");
      match.className = "hit";
      match.textContent = text.slice(idx, idx + term.length);
      const after = document.createTextNode(text.slice(idx + term.length));
      const frag = document.createDocumentFragment();
      frag.append(before, match, after);
      node.replaceWith(frag);
    });
  }

  function applySearch(raw){
    clearMarks();
    const term = raw.trim().toLowerCase();
    if(!term) return;
    // open accordions that might contain hits
    $$("details.acc").forEach(d=> d.open = true);
    markMatches(document.querySelector("main"), term);
    // scroll to first hit
    const first = $("mark.hit");
    if(first) first.scrollIntoView({behavior:"smooth", block:"center"});
  }

  q.addEventListener("input", ()=> applySearch(q.value));
  urgency.addEventListener("change", ()=> applyUrgency(urgency.value));
  context.addEventListener("change", ()=> applyContext(context.value));

  // sticky nav active section
  const navLinks = $$("[data-nav]");
  const sections = navLinks.map(a => document.querySelector(a.getAttribute("href"))).filter(Boolean);
  const obs = new IntersectionObserver((entries)=>{
    entries.forEach(en=>{
      if(en.isIntersecting){
        navLinks.forEach(a=> a.classList.toggle("active", a.getAttribute("href") === "#"+en.target.id));
      }
    });
  }, {rootMargin:"-50% 0px -45% 0px", threshold:0.01});
  sections.forEach(s=> obs.observe(s));

  // jump buttons
  $$("[data-jump]").forEach(b=>{
    b.addEventListener("click", ()=>{
      const t = document.querySelector(b.getAttribute("data-jump"));
      if(t) t.scrollIntoView({behavior:"smooth", block:"start"});
    });
  });

  // copy helpers
  async function copyText(text){
    try{
      await navigator.clipboard.writeText(text);
      toast("Copied to clipboard");
    }catch{
      toast("Copy failed (clipboard blocked)");
    }
  }

  function toast(msg){
    const el = document.createElement("div");
    el.textContent = msg;
    el.style.position="fixed";
    el.style.left="50%";
    el.style.bottom="18px";
    el.style.transform="translateX(-50%)";
    el.style.padding="10px 12px";
    el.style.borderRadius="14px";
    el.style.border="1px solid var(--line)";
    el.style.background="rgba(0,0,0,.55)";
    el.style.color="var(--text)";
    el.style.zIndex="999";
    el.style.boxShadow="var(--shadow)";
    document.body.appendChild(el);
    setTimeout(()=>{ el.style.opacity="0"; el.style.transition="opacity .25s ease"; }, 1100);
    setTimeout(()=> el.remove(), 1500);
  }

  $("#copyCrampsNote").addEventListener("click", ()=>{
    const note = [
      "Leg cramps (adult) ‚Äî rapid note:",
      "‚Ä¢ Phenotype: sudden painful contraction (often calf/foot), brief (seconds to <10 min), relieved by stretching; residual tenderness possible.",
      "‚Ä¢ Red flags: severe cramps + altered consciousness / anuria / hyper- or hypopyrexia ‚Üí admit.",
      "‚Ä¢ Screen organic causes: >10 min, widespread cramps, exertional calf pain/claudication, neuro deficits (wasting/fasciculations/sensory loss), vascular signs, systemic disease, medication triggers.",
      "‚Ä¢ Typical idiopathic + normal exam: no routine investigations; advise stretch/massage, 3√ó daily stretches, sleep positioning, loose covers; consider analgesia after.",
      "‚Ä¢ Consider quinine only in selected severe cases after exclusions; 200‚Äì300 mg nocte x4 weeks; stop if no benefit; review at 3 months; monitor for harms (e.g., thrombocytopenia)."
    ].join("\n");
    copyText(note);
  });

  $$("[data-copy]").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const sel = btn.getAttribute("data-copy");
      const el = document.querySelector(sel);
      if(!el) return;
      copyText(el.textContent.trim());
    });
  });

  // expand / collapse accordions
  const expandAll = $("#expandAll");
  let expanded = false;
  expandAll.addEventListener("click", ()=>{
    expanded = !expanded;
    $$("details.acc").forEach(d=> d.open = expanded);
    expandAll.innerHTML = expanded
      ? '<svg class="ic" viewBox="0 0 24 24" fill="none"><path d="M7 14l5-5 5 5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>Collapse'
      : '<svg class="ic" viewBox="0 0 24 24" fill="none"><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/></svg>Expand';
  });

  // reset
  reset.addEventListener("click", ()=>{
    q.value = "";
    urgency.value = "all";
    context.value = "general";
    applySearch("");
    applyUrgency("all");
    applyContext("general");
    toast("Reset");
  });

  // hydrate from localStorage
  urgency.value = store.get("urgency","all");
  context.value = store.get("context","general");
  applyUrgency(urgency.value);
  applyContext(context.value);

})();
</script>
</body>
</html>
