<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whiplash Injury Management Algorithm</title>
    <style>
        :root {
            --primary: #0058ad;
            --assessment: #3498db;
            --diagnosis: #9b59b6;
            --treatment: #27ae60;
            --followup: #e67e22;
            --danger: #e74c3c;
            --warning: #f39c12;
            --success: #27ae60;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-hover: 0 8px 15px rgba(0,0,0,0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e7f1 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            gap: 20px;
        }

        /* Header */
        .header {
            background: var(--primary);
            color: white;
            padding: 30px 0;
            text-align: center;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        /* Progress Sidebar */
        .progress-sidebar {
            position: sticky;
            top: 20px;
            width: 280px;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            height: fit-content;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .progress-sidebar h3 {
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2em;
            border-bottom: 2px solid var(--light);
            padding-bottom: 10px;
        }

        .progress-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .progress-item:hover {
            background: var(--light);
            transform: translateX(5px);
        }

        .progress-item.active {
            background: linear-gradient(90deg, rgba(52,152,219,0.1) 0%, rgba(52,152,219,0.05) 100%);
            border-left-color: var(--primary);
            font-weight: 600;
        }

        .progress-item.completed {
            border-left-color: var(--success);
            opacity: 0.8;
        }

        .progress-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            color: white;
            font-size: 12px;
            flex-shrink: 0;
        }

        .progress-icon.assessment { background: var(--assessment); }
        .progress-icon.diagnosis { background: var(--diagnosis); }
        .progress-icon.treatment { background: var(--treatment); }
        .progress-icon.followup { background: var(--followup); }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 0;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--card-color);
            transition: height 0.3s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-5px);
        }

        .card:hover::before {
            height: 8px;
        }

        .card.assessment { --card-color: var(--assessment); }
        .card.diagnosis { --card-color: var(--diagnosis); }
        .card.treatment { --card-color: var(--treatment); }
        .card.followup { --card-color: var(--followup); }

        .card-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            cursor: pointer;
            user-select: none;
        }

        .card-icon {
            width: 60px;
            height: 60px;
            background: var(--card-color);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            flex-shrink: 0;
            transition: transform 0.3s ease;
        }

        .card:hover .card-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .card-title {
            flex: 1;
        }

        .card-title h2 {
            color: var(--dark);
            font-size: 1.8em;
            margin-bottom: 5px;
        }

        .card-title p {
            color: #7f8c8d;
            font-size: 0.95em;
        }

        .expand-icon {
            font-size: 24px;
            color: var(--card-color);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease, padding-top 0.5s ease;
            padding-top: 0;
        }

        .card.expanded .card-content {
            max-height: 2000px;
            padding-top: 25px;
        }

        /* Content Sections */
        .section {
            margin-bottom: 25px;
            padding: 20px;
            background: var(--light);
            border-radius: 10px;
            border-left: 4px solid var(--card-color);
            transition: transform 0.3s ease;
        }

        .section:hover {
            transform: translateX(5px);
        }

        .section h3 {
            color: var(--dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2em;
        }

        .section-icon {
            width: 24px;
            height: 24px;
            background: var(--card-color);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        /* Badges */
        .badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
            50% { box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
            100% { box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        }

        .badge.danger {
            background: linear-gradient(135deg, var(--danger) 0%, #c0392b 100%);
            color: white;
        }

        .badge.warning {
            background: linear-gradient(135deg, var(--warning) 0%, #d35400 100%);
            color: white;
        }

        .badge.success {
            background: linear-gradient(135deg, var(--success) 0%, #229954 100%);
            color: white;
        }

        .badge.info {
            background: linear-gradient(135deg, var(--primary) 0%, #2980b9 100%);
            color: white;
        }

        /* Lists */
        .checklist {
            list-style: none;
            padding: 0;
        }

        .checklist li {
            padding: 10px 0;
            padding-left: 35px;
            position: relative;
            transition: all 0.3s ease;
        }

        .checklist li:hover {
            background: rgba(255,255,255,0.5);
            border-radius: 6px;
            padding-left: 40px;
        }

        .checklist li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            width: 24px;
            height: 24px;
            background: var(--card-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .alert.danger {
            background: rgba(231, 76, 60, 0.1);
            border-left: 4px solid var(--danger);
        }

        .alert.warning {
            background: rgba(243, 156, 18, 0.1);
            border-left: 4px solid var(--warning);
        }

        .alert.info {
            background: rgba(52, 152, 219, 0.1);
            border-left: 4px solid var(--assessment);
        }

        .alert-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: white;
            box-shadow: var(--shadow);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .btn-primary { background: var(--primary); }
        .btn-success { background: var(--success); }
        .btn-warning { background: var(--warning); }
        .btn-danger { background: var(--danger); }

        /* Responsive */
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
            }
            
            .progress-sidebar {
                width: 100%;
                position: relative;
                top: 0;
                max-height: none;
            }
            
            .progress-items {
                display: flex;
                gap: 10px;
                overflow-x: auto;
                padding-bottom: 10px;
            }
            
            .progress-item {
                min-width: 200px;
                margin-bottom: 0;
            }
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 2em; }
            .card { padding: 20px; }
            .card-icon { width: 50px; height: 50px; font-size: 24px; }
            .card-title h2 { font-size: 1.5em; }
        }

        /* Loading animation */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Print styles */
        @media print {
            .progress-sidebar { display: none; }
            .card { page-break-inside: avoid; }
            .expand-icon { display: none; }
            .card-content { max-height: none !important; padding-top: 25px !important; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Whiplash Injury Management Algorithm</h1>
        <p>Interactive Clinical Decision Support | Based on NICE CKS Guidelines (2023)</p>
    </div>

    <div class="container">
        <!-- Progress Sidebar -->
        <aside class="progress-sidebar fade-in">
            <h3>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 11l3 3L22 4"></path>
                    <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"></path>
                </svg>
                Algorithm Progress
            </h3>
            <div class="progress-items">
                <div class="progress-item active" data-step="assessment">
                    <div class="progress-icon assessment">1</div>
                    <div>
                        <div style="font-weight: 600;">Assessment</div>
                        <small style="color: #7f8c8d;">History & Examination</small>
                    </div>
                </div>
                <div class="progress-item" data-step="diagnosis">
                    <div class="progress-icon diagnosis">2</div>
                    <div>
                        <div style="font-weight: 600;">Diagnosis</div>
                        <small style="color: #7f8c8d;">WAD Classification</small>
                    </div>
                </div>
                <div class="progress-item" data-step="treatment">
                    <div class="progress-icon treatment">3</div>
                    <div>
                        <div style="font-weight: 600;">Treatment</div>
                        <small style="color: #7f8c8d;">Management Plan</small>
                    </div>
                </div>
                <div class="progress-item" data-step="followup">
                    <div class="progress-icon followup">4</div>
                    <div>
                        <div style="font-weight: 600;">Follow-up</div>
                        <small style="color: #7f8c8d;">Monitoring & Referral</small>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ecf0f1;">
                <h4 style="margin-bottom: 15px; color: var(--dark);">Quick Actions</h4>
                <button class="btn btn-primary" style="width: 100%; margin-bottom: 10px;" onclick="expandAll()">
                    <span>üìã</span> Expand All
                </button>
                <button class="btn btn-warning" style="width: 100%; margin-bottom: 10px;" onclick="collapseAll()">
                    <span>üéØ</span> Collapse All
                </button>
                <button class="btn btn-success" style="width: 100%;" onclick="window.print()">
                    <span>üñ®Ô∏è</span> Print Algorithm
                </button>
            </div>

            <div style="margin-top: 20px; font-size: 0.85em; color: #7f8c8d;">
                <strong>Legend:</strong><br>
                <span style="display: inline-flex; align-items: center; gap: 5px; margin-top: 8px;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: var(--danger); border-radius: 50%;"></span> Urgent Referral
                </span><br>
                <span style="display: inline-flex; align-items: center; gap: 5px; margin-top: 4px;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: var(--warning); border-radius: 50%;"></span> Caution
                </span><br>
                <span style="display: inline-flex; align-items: center; gap: 5px; margin-top: 4px;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: var(--success); border-radius: 50%;"></span> Stable
                </span>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Assessment Card -->
            <div class="card assessment fade-in" id="assessment">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-icon">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                        </svg>
                    </div>
                    <div class="card-title">
                        <h2>Assessment & Initial Evaluation</h2>
                        <p>Comprehensive history and clinical examination for suspected whiplash injury</p>
                    </div>
                    <div class="expand-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                </div>
                <div class="card-content">
                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
                                </svg>
                            </div>
                            History Taking
                        </h3>
                        <div class="badges">
                            <span class="badge danger">Critical First Step</span>
                            <span class="badge warning">Exclude Red Flags</span>
                        </div>
                        <ul class="checklist">
                            <li><strong>Circumstances of injury:</strong> Type of collision (rear-end, side-impact), mechanism</li>
                            <li><strong>Symptom profile:</strong> Localisation, onset timing, pain intensity (VAS 0-10)</li>
                            <li><strong>Occupational history:</strong> Work demands, ability to return</li>
                            <li><strong>Medical history:</strong> Previous neck problems, chronic pain, cancer</li>
                            <li><strong>Psychological factors:</strong> Anxiety, depression, expectations of recovery</li>
                            <li><strong>Systemic symptoms:</strong> Fever, unexplained weight loss, night sweats</li>
                        </ul>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"></path>
                                </svg>
                            </div>
                            Red Flag Screening
                        </h3>
                        <div class="alert danger">
                            <span class="alert-icon">‚ö†Ô∏è</span>
                            <div>
                                <strong>URGENT REFERRAL TO A&E IF ANY PRESENT:</strong>
                                <ul style="margin-top: 10px; margin-left: 20px;">
                                    <li>Altered level of consciousness</li>
                                    <li>Focal neurological deficit or paraesthesia</li>
                                    <li>Midline cervical tenderness with high-risk mechanism</li>
                                    <li>Age ‚â•65 with significant trauma</li>
                                    <li>Dangerous mechanism (fall >1m, diving accident)</li>
                                    <li>Significant head or facial injury</li>
                                    <li>Inability to walk or sit after injury</li>
                                    <li>Rigid spinal disease (ankylosing spondylitis)</li>
                                </ul>
                            </div>
                        </div>
                        <div class="alert warning">
                            <span class="alert-icon">‚ö°</span>
                            <div>
                                <strong>SPINAL IMAGING INDICATORS:</strong>
                                <ul style="margin-top: 10px; margin-left: 20px;">
                                    <li>Canadian C-spine rule positive (age ‚â§65)</li>
                                    <li>Immediate onset neck pain</li>
                                    <li>Multiple fractures elsewhere</li>
                                    <li>Unable to actively rotate neck 45¬∞ bilaterally</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                                </svg>
                            </div>
                            Physical Examination
                        </h3>
                        <ul class="checklist">
                            <li><strong>Cervical range of motion:</strong> Active rotation, flexion/extension</li>
                            <li><strong>Neurological assessment:</strong> Sensation, strength, reflexes</li>
                            <li><strong>Palpation:</strong> Midline tenderness, muscle spasm</li>
                            <li><strong>Special tests:</strong> Kernig's/Brudzinski if meningitis suspected</li>
                            <li><strong>Associated injuries:</strong> Head, shoulder, temporomandibular joint</li>
                        </ul>
                        <div class="alert info">
                            <span class="alert-icon">üí°</span>
                            <strong>DO NOT examine neck movements until serious injury excluded</strong>
                        </div>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 11V6a3 3 0 0 1 6 0v5M9 11h6m-6 4h6m2 3v-2a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v2"></path>
                                </svg>
                            </div>
                            WAD Classification
                        </h3>
                        <div class="badges">
                            <span class="badge info">Quebec Task Force</span>
                        </div>
                        <ul class="checklist">
                            <li><strong>Grade I:</strong> Neck pain, no physical signs</li>
                            <li><strong>Grade II:</strong> Neck pain with physical signs, no neurology</li>
                            <li><strong>Grade III:</strong> Neck pain with neurological signs</li>
                            <li><strong>Grade IV:</strong> Neck pain with fracture/dislocation</li>
                        </ul>
                    </div>

                    <button class="btn btn-primary" onclick="scrollToSection('diagnosis')">
                        <span>‚Üí</span> Proceed to Diagnosis
                    </button>
                </div>
            </div>

            <!-- Diagnosis Card -->
            <div class="card diagnosis fade-in" id="diagnosis">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-icon">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 6v6l4 2"></path>
                        </svg>
                    </div>
                    <div class="card-title">
                        <h2>Diagnosis & Classification</h2>
                        <p>Establish diagnosis and differentiate from other conditions</p>
                    </div>
                    <div class="expand-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                </div>
                <div class="card-content">
                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                                </svg>
                            </div>
                            Differential Diagnosis
                        </h3>
                        <div class="badges">
                            <span class="badge warning">Consider Alternatives</span>
                        </div>
                        <ul class="checklist">
                            <li><strong>Acute torticollis:</strong> Spasm without clear cause</li>
                            <li><strong>Cervical radiculopathy:</strong> Radicular pain, neurological signs</li>
                            <li><strong>Cervical myelopathy:</strong> Spinal cord compression signs</li>
                            <li><strong>Acute disc prolapse:</strong> Severe secondary torticollis</li>
                            <li><strong>Fracture/dislocation:</strong> High-energy trauma, severe pain</li>
                            <li><strong>Non-specific neck pain:</strong> Mechanical, posture-related</li>
                            <li><strong>Infection:</strong> Fever, systemic signs</li>
                            <li><strong>Malignancy:</strong> History of cancer, weight loss</li>
                        </ul>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                            </div>
                            Diagnostic Criteria
                        </h3>
                        <div class="alert success">
                            <span class="alert-icon">‚úÖ</span>
                            <div>
                                <strong>WHIPLASH CONFIRMED IF:</strong>
                                <ul style="margin-top: 10px; margin-left: 20px;">
                                    <li>History of sudden acceleration-deceleration mechanism</li>
                                    <li>Neck pain and/or other symptoms consistent with WAD</li>
                                    <li>Clinical features match Quebec Task Force classification</li>
                                    <li>Imaging (if performed) shows no fracture/dislocation</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="19" y1="5" x2="5" y2="19"></line>
                                    <circle cx="6.5" cy="6.5" r="2.5"></circle>
                                    <circle cx="17.5" cy="17.5" r="2.5"></circle>
                                </svg>
                            </div>
                            Severity Assessment
                        </h3>
                        <ul class="checklist">
                            <li><strong>Pain intensity:</strong> Visual Analogue Scale (VAS 0-10)</li>
                            <li><strong>Disability level:</strong> Neck Disability Index (NDI 0-50)</li>
                            <li><strong>Functional impact:</strong> Work, ADLs, sleep</li>
                            <li><strong>Psychological impact:</strong> IES screening for PTSD symptoms</li>
                        </ul>
                    </div>

                    <button class="btn btn-success" onclick="scrollToSection('treatment')">
                        <span>‚Üí</span> Proceed to Treatment
                    </button>
                </div>
            </div>

            <!-- Treatment Card -->
            <div class="card treatment fade-in" id="treatment">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-icon">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                        </svg>
                    </div>
                    <div class="card-title">
                        <h2>Initial Management & Treatment</h2>
                        <p>Evidence-based interventions and patient education</p>
                    </div>
                    <div class="expand-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                </div>
                <div class="card-content">
                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                                </svg>
                            </div>
                            Self-Care Advice
                        </h3>
                        <div class="badges">
                            <span class="badge success">Essential First Step</span>
                            <span class="badge info">Patient Education</span>
                        </div>
                        <ul class="checklist">
                            <li><strong>Reassurance:</strong> Recovery usually occurs within 2-3 months</li>
                            <li><strong>Early mobilization:</strong> Encourage normal activities, avoid rest</li>
                            <li><strong>Stay active:</strong> Explain symptoms are normal reaction to injury</li>
                            <li><strong>Focus on function:</strong> Improvements in activity, not just pain</li>
                            <li><strong>Discourage immobilization:</strong> No soft collars or prolonged rest</li>
                        </ul>
                        <div class="alert warning">
                            <span class="alert-icon">üö´</span>
                            <strong>AVOID: Soft collars, rest, and activity restriction</strong>
                        </div>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                    <polyline points="10 9 9 9 8 9"></polyline>
                                </svg>
                            </div>
                            Analgesia
                        </h3>
                        <div class="badges">
                            <span class="badge info">Mild-Moderate Pain</span>
                            <span class="badge warning">Review Risk Factors</span>
                        </div>
                        <ul class="checklist">
                            <li><strong>First line:</strong> Paracetamol up to 1g q6h (max 4g/day)</li>
                            <li><strong>Second line:</strong> NSAID (e.g., ibuprofen 400mg q6-8h)</li>
                            <li><strong>Third line:</strong> Codeine ¬± paracetamol if severe</li>
                            <li><strong>Consider:</strong> Topical NSAIDs for localized pain</li>
                        </ul>
                        <div class="alert warning">
                            <span class="alert-icon">‚ö†Ô∏è</span>
                            <div>
                                <strong>NSAID PRECAUTIONS:</strong>
                                <ul style="margin-top: 10px; margin-left: 20px;">
                                    <li>GI, cardiovascular, renal risk assessment required</li>
                                    <li>Lowest effective dose for shortest duration</li>
                                    <li>PPI co-prescription for at-risk patients</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                                </svg>
                            </div>
                            Multimodal Treatment
                        </h3>
                        <div class="badges">
                            <span class="badge success">Recommended</span>
                        </div>
                        <ul class="checklist">
                            <li><strong>Physiotherapy:</strong> Range of motion, strengthening, manual therapy</li>
                            <li><strong>Psychological support:</strong> If poor recovery expectations or high distress</li>
                            <li><strong>Graded activity:</strong> Tailored exercise program</li>
                        </ul>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="12" y1="8" x2="12" y2="12"></line>
                                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                                </svg>
                            </div>
                            Treatments NOT Recommended
                        </h3>
                        <div class="badges">
                            <span class="badge danger">Avoid</span>
                        </div>
                        <ul class="checklist">
                            <li>Anti-seizure medications (e.g., pregabalin, gabapentin)</li>
                            <li>Antidepressants for acute pain</li>
                            <li>Muscle relaxants (diazepam, etc.)</li>
                            <li>Prolonged rest or collar use</li>
                        </ul>
                    </div>

                    <button class="btn btn-warning" onclick="scrollToSection('followup')">
                        <span>‚Üí</span> Proceed to Follow-up
                    </button>
                </div>
            </div>

            <!-- Follow-up Card -->
            <div class="card followup fade-in" id="followup">
                <div class="card-header" onclick="toggleCard(this)">
                    <div class="card-icon">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                        </svg>
                    </div>
                    <div class="card-title">
                        <h2>Follow-up & Monitoring</h2>
                        <p>Structured reassessment and referral criteria</p>
                    </div>
                    <div class="expand-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                </div>
                <div class="card-content">
                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                            </div>
                            Follow-up Schedule
                        </h3>
                        <div class="badges">
                            <span class="badge info">Structured Reviews</span>
                            <span class="badge warning">Monitor Progress</span>
                        </div>
                        <ul class="checklist">
                            <li><strong>7 days:</strong> Review VAS & NDI, assess treatment response</li>
                            <li><strong>3 weeks:</strong> Reassess if no improvement, consider IES screening</li>
                            <li><strong>6 weeks:</strong> Gradual treatment withdrawal if improving</li>
                            <li><strong>3 months:</strong> Resolution or referral to pain clinic</li>
                        </ul>
                        <div class="alert info">
                            <span class="alert-icon">üìä</span>
                            <strong>Success criteria: ‚â•10% reduction in VAS and/or NDI from baseline</strong>
                        </div>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                </svg>
                            </div>
                            Outcome Measures
                        </h3>
                        <ul class="checklist">
                            <li><strong>VAS Score:</strong> Pain intensity 0-10 scale</li>
                            <li><strong>NDI Score:</strong> Disability 0-50 scale</li>
                            <li><strong>IES Score:</strong> Post-traumatic stress symptoms</li>
                            <li><strong>Functional goals:</strong> Work, daily activities, sleep quality</li>
                        </ul>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                                    <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                                    <line x1="12" y1="22.08" x2="12" y2="12"></line>
                                </svg>
                            </div>
                            Referral Criteria
                        </h3>
                        <div class="badges">
                            <span class="badge danger">Urgent</span>
                            <span class="badge warning">Early</span>
                            <span class="badge info">Routine</span>
                        </div>
                        
                        <div class="alert danger">
                            <span class="alert-icon">üö®</span>
                            <div>
                                <strong>URGENT REFERRAL TO A&E:</strong>
                                <ul style="margin-top: 10px; margin-left: 20px;">
                                    <li>Suspected serious neck injury</li>
                                    <li>Neurological deficit</li>
                                    <li>Fracture/dislocation suspected</li>
                                </ul>
                            </div>
                        </div>

                        <div class="alert warning">
                            <span class="alert-icon">‚ö†Ô∏è</span>
                            <div>
                                <strong>EARLY REFERRAL (within 3 weeks):</strong>
                                <ul style="margin-top: 10px; margin-left: 20px;">
                                    <li>VAS >5/10 at initial assessment</li>
                                    <li>NDI >15/50 at initial assessment</li>
                                    <li>Poor expectation of recovery</li>
                                    <li>High distress or PTSD symptoms (IES >25)</li>
                                </ul>
                            </div>
                        </div>

                        <div class="alert info">
                            <span class="alert-icon">üìã</span>
                            <div>
                                <strong>ROUTINE REFERRAL (6-12 weeks):</strong>
                                <ul style="margin-top: 10px; margin-left: 20px;">
                                    <li>No improvement after 6 weeks with active treatment</li>
                                    <li>Developing chronic pain pattern</li>
                                    <li>Psychological comorbidity requiring specialist input</li>
                                    <li>Consider pain clinic multidisciplinary program at 12 weeks</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h3>
                            <div class="section-icon">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20z"></path>
                                    <path d="M8 12h8"></path>
                                    <path d="M12 8v8"></path>
                                </svg>
                            </div>
                            When to Stop Treatment
                        </h3>
                        <div class="badges">
                            <span class="badge success">Resolution</span>
                        </div>
                        <ul class="checklist">
                            <li>Patient reports symptom resolution</li>
                            <li>Functional goals achieved (return to work, activities)</li>
                            <li>VAS and NDI scores return to normal/baseline</li>
                            <li>Patient confident in self-management</li>
                        </ul>
                    </div>

                    <div class="alert success">
                        <span class="alert-icon">‚úÖ</span>
                        <div>
                            <strong>EXPECTED RECOVERY:</strong>
                            <ul style="margin-top: 10px; margin-left: 20px;">
                                <li>40% resolve by 6 weeks</li>
                                <li>50% substantially improved by 12 weeks</li>
                                <li>40% complete resolution by 12 weeks</li>
                                <li>50% fully recover within 6 months</li>
                            </ul>
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="resetAlgorithm()">
                        <span>üîÑ</span> Restart Algorithm
                    </button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Card toggle functionality
        function toggleCard(header) {
            const card = header.parentElement;
            card.classList.toggle('expanded');
            
            // Update progress tracking
            updateProgress();
            
            // Smooth scroll to card if not visible
            setTimeout(() => {
                card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
        }

        // Expand/collapse all
        function expandAll() {
            document.querySelectorAll('.card').forEach(card => {
                card.classList.add('expanded');
            });
            updateProgress();
        }

        function collapseAll() {
            document.querySelectorAll('.card').forEach(card => {
                card.classList.remove('expanded');
            });
            updateProgress();
        }

        // Scroll to section
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' });
                element.classList.add('expanded');
                setTimeout(() => updateProgress(), 300);
            }
        }

        // Progress tracking
        function updateProgress() {
            const cards = document.querySelectorAll('.card');
            const progressItems = document.querySelectorAll('.progress-item');
            
            cards.forEach((card, index) => {
                const isExpanded = card.classList.contains('expanded');
                const isInView = isElementInViewport(card);
                
                if (isInView && isExpanded) {
                    progressItems.forEach(item => item.classList.remove('active'));
                    progressItems[index].classList.add('active');
                    progressItems[index].classList.add('completed');
                } else if (isExpanded) {
                    progressItems[index].classList.add('completed');
                }
            });
        }

        // Check if element is in viewport
        function isElementInViewport(el) {
            const rect = el.getBoundingClientRect();
            return (
                rect.top >= 0 &&
                rect.left >= 0 &&
                rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                rect.right <= (window.innerWidth || document.documentElement.clientWidth)
            );
        }

        // Progress sidebar click handlers
        document.querySelectorAll('.progress-item').forEach((item, index) => {
            item.addEventListener('click', () => {
                const targetId = item.dataset.step;
                scrollToSection(targetId);
            });
        });

        // Reset algorithm
        function resetAlgorithm() {
            // Collapse all cards
            document.querySelectorAll('.card').forEach(card => {
                card.classList.remove('expanded');
                card.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    card.style.transform = '';
                }, 200);
            });
            
            // Reset progress
            document.querySelectorAll('.progress-item').forEach(item => {
                item.classList.remove('completed', 'active');
            });
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Set first item active
            setTimeout(() => {
                document.querySelector('.progress-item').classList.add('active');
            }, 500);
        }

        // Intersection Observer for scroll animations
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('fade-in');
                }
            });
        }, { threshold: 0.1 });

        // Observe all cards
        document.querySelectorAll('.card').forEach(card => {
            observer.observe(card);
        });

        // Auto-expand first card on load
        window.addEventListener('load', () => {
            setTimeout(() => {
                const firstCard = document.querySelector('.card');
                if (firstCard) {
                    firstCard.classList.add('expanded');
                    updateProgress();
                }
            }, 500);
        });

        // Update progress on scroll
        let scrollTimeout;
        window.addEventListener('scroll', () => {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(updateProgress, 50);
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowDown') {
                const activeItem = document.querySelector('.progress-item.active');
                const nextItem = activeItem?.nextElementSibling;
                if (nextItem) {
                    nextItem.click();
                }
            } else if (e.key === 'ArrowUp') {
                const activeItem = document.querySelector('.progress-item.active');
                const prevItem = activeItem?.previousElementSibling;
                if (prevItem) {
                    prevItem.click();
                }
            } else if (e.key === 'Home') {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else if (e.key === 'End') {
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
            }
        });

        // Add tooltips to badges
        document.querySelectorAll('.badge').forEach(badge => {
            badge.addEventListener('mouseenter', (e) => {
                const tooltip = document.createElement('div');
                tooltip.className = 'tooltip';
                tooltip.textContent = badge.textContent;
                tooltip.style.cssText = `
                    position: fixed;
                    background: rgba(0,0,0,0.8);
                    color: white;
                    padding: 5px 10px;
                    border-radius: 4px;
                    font-size: 12px;
                    z-index: 1000;
                    pointer-events: none;
                    white-space: nowrap;
                    left: ${e.clientX}px;
                    top: ${e.clientY - 30}px;
                    transform: translateX(-50%);
                `;
                document.body.appendChild(tooltip);
            });
            
            badge.addEventListener('mouseleave', () => {
                const tooltip = document.querySelector('.tooltip');
                if (tooltip) tooltip.remove();
            });
        });

        // Print functionality enhancements
        window.addEventListener('beforeprint', () => {
            expandAll();
        });

        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.style.setProperty('--dark', '#ecf0f1');
            document.documentElement.style.setProperty('--light', '#2c3e50');
        }

        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            if (e.matches) {
                document.documentElement.style.setProperty('--dark', '#ecf0f1');
                document.documentElement.style.setProperty('--light', '#2c3e50');
            } else {
                document.documentElement.style.setProperty('--dark', '#2c3e50');
                document.documentElement.style.setProperty('--light', '#f8f9fa');
            }
        });
    </script>
</body>
</html>