<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AN Clinical Reference Tool</title>
    <style>
        :root {
            /* Color Palette */
            --color-danger: #e74c3c;      /* Red for Critical/Emergency */
            --color-danger-bg: #fadbd8;
            --color-success: #27ae60;     /* Green for Safe/Resolution */
            --color-success-bg: #d5f5e3;
            --color-primary: #2980b9;     /* Blue for General Info */
            --color-primary-bg: #d6eaf8;
            --color-neutral: #7f8c8d;
            --color-bg: #f8f9fa;
            --color-card-bg: #ffffff;
            --color-text: #2c3e50;
            --border-radius: 8px;
            --shadow: 0 4px 6px rgba(0,0,0,0.05);
            --transition: all 0.3s ease;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text);
            line-height: 1.5;
            padding: 20px;
        }

        /* Layout Structure */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        /* Header */
        header {
            background: var(--color-card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border-left: 6px solid var(--color-primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        h1 {
            font-size: 1.5rem;
            color: var(--color-text);
        }

        .meta-tag {
            background: var(--color-primary-bg);
            color: var(--color-primary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        /* Navigation */
        nav {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }

        .nav-btn {
            background: var(--color-card-bg);
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            text-align: center;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .nav-btn.active {
            background-color: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        /* Section Visibility */
        section {
            display: none;
            animation: fadeIn 0.4s ease-in-out;
        }

        section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Grid Layouts for Content */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        /* Cards */
        .card {
            background: var(--color-card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border-top: 4px solid transparent;
        }

        .card h2 {
            font-size: 1.1rem;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Color Coding Classes */
        .card.danger { border-top-color: var(--color-danger); }
        .card.success { border-top-color: var(--color-success); }
        .card.info { border-top-color: var(--color-primary); }

        .bg-danger { background-color: var(--color-danger-bg); color: var(--color-danger); padding: 2px 6px; border-radius: 4px; }
        .bg-success { background-color: var(--color-success-bg); color: var(--color-success); padding: 2px 6px; border-radius: 4px; }

        /* Lists & Tables */
        ul.feature-list {
            list-style: none;
        }

        ul.feature-list li {
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
        }

        ul.feature-list li::before {
            content: "•";
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        th, td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #f8f9fa;
            color: var(--color-neutral);
            font-weight: 600;
        }

        /* Critical Alert Box */
        .alert-box {
            background-color: #fdf2f2;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .alert-icon {
            font-size: 1.5rem;
            color: var(--color-danger);
        }

        /* BMI Calculator Styles */
        .calc-container {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .input-group {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-size: 0.8rem;
            color: var(--color-neutral);
            margin-bottom: 4px;
        }

        input[type="number"] {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .bmi-result {
            margin-top: 15px;
            padding: 15px;
            text-align: center;
            border-radius: var(--border-radius);
            font-weight: bold;
            display: none; /* Hidden by default */
        }

        .severity-badge {
            display: inline-block;
            margin-top: 5px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
            color: white;
        }

        /* Checkbox Interactive */
        .checklist-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border: 1px solid #eee;
            margin-bottom: 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .checklist-item:hover {
            background-color: #f0f0f0;
        }

        .checklist-item.checked {
            background-color: var(--color-success-bg);
            border-color: var(--color-success);
            text-decoration: line-through;
            color: #555;
        }

        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--color-success);
        }

        /* Icons (Simple CSS Shapes/SVG placeholders) */
        .icon { width: 24px; height: 24px; fill: currentColor; }

        /* Footer */
        footer {
            margin-top: 30px;
            text-align: center;
            font-size: 0.8rem;
            color: var(--color-neutral);
            padding: 20px;
            border-top: 1px solid #eee;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .grid-2 { grid-template-columns: 1fr; }
            h1 { font-size: 1.2rem; }
            .calc-container { flex-direction: column; }
        }
    </style>
</head>
<body>

<div class="app-container">
    
    <!-- Header -->
    <header>
        <div>
            <h1>Anorexia Nervosa: Clinical Reference</h1>
            <p style="color: var(--color-neutral); font-size: 0.9rem;">Quick-scan decision support tool based on BMJ Best Practice</p>
        </div>
        <div>
            <span class="meta-tag">Updated: May 2025</span>
        </div>
    </header>

    <!-- Navigation -->
    <nav>
        <button class="nav-btn active" onclick="showTab('emergency')">
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 2L1 21h22L12 2zm0 3.99L19.53 19H4.47L12 5.99zM11 16h2v2h-2zm0-6h2v4h-2z"/></svg>
            Emergency Red Flags
        </button>
        <button class="nav-btn" onclick="showTab('diagnosis')">
            <svg class="icon" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
            Diagnosis & Criteria
        </button>
        <button class="nav-btn" onclick="showTab('investigations')">
            <svg class="icon" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"/></svg>
            Investigations & Labs
        </button>
        <button class="nav-btn" onclick="showTab('management')">
            <svg class="icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
            Management Overview
        </button>
    </nav>

    <!-- MAIN CONTENT AREA -->
    <main>
        
        <!-- SECTION 1: EMERGENCY & RED FLAGS -->
        <section id="emergency" class="active">
            
            <div class="alert-box">
                <div class="alert-icon">⚠️</div>
                <div>
                    <strong>IMMEDIATE MEDICAL RISK</strong>
                    <p style="font-size: 0.9rem;">If any red flags below are present, urgent inpatient admission is likely required. Do not rely solely on normal blood tests.</p>
                </div>
            </div>

            <div class="grid-2">
                <!-- Vital Signs Card -->
                <div class="card danger">
                    <h2>
                        <svg class="icon" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                        Critical Vital Signs
                    </h2>
                    <table>
                        <tr>
                            <td><strong>Heart Rate</strong></td>
                            <td><span class="bg-danger"> &lt; 40 bpm</span> (Resting)</td>
                        </tr>
                        <tr>
                            <td><strong>Blood Pressure</strong></td>
                            <td>Orthostatic hypotension + Syncope</td>
                        </tr>
                        <tr>
                            <td><strong>Temperature</strong></td>
                            <td><span class="bg-danger"> &lt; 35.5°C</span></td>
                        </tr>
                        <tr>
                            <td><strong>Weight Loss</strong></td>
                            <td>Loss &gt; 1 kg/week (2 consecutive weeks)</td>
                        </tr>
                    </table>
                </div>

                <!-- Physical Exam Red Flags -->
                <div class="card danger">
                    <h2>
                        <svg class="icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9v-2h2v2zm0-4H9V7h2v5z"/></svg>
                        Physical & Functional
                    </h2>
                    <ul class="feature-list">
                        <li><strong>SUSS Test Score:</strong> <span class="bg-danger">0 or 1</span> (Sit Up-Stand-Squat)</li>
                        <li><strong>BMI (Adult):</strong> <span class="bg-danger">&lt; 13 kg/m²</span></li>
                        <li><strong>BMI (Child):</strong> <span class="bg-danger">&lt; 70% predicted</span> for age</li>
                        <li><strong>ECG:</strong> Prolonged QTc, Arrhythmia</li>
                        <li><strong>Electrolytes:</strong> Hypophosphatemia (Refeeding risk)</li>
                    </ul>
                </div>
            </div>

            <!-- BMI Calculator Tool -->
            <div class="card info" style="margin-top: 20px;">
                <h2>Quick BMI & Severity Assessment (Adults)</h2>
                <div class="calc-container">
                    <div class="input-group">
                        <label>Height (cm)</label>
                        <input type="number" id="height" placeholder="e.g. 165">
                    </div>
                    <div class="input-group">
                        <label>Weight (kg)</label>
                        <input type="number" id="weight" placeholder="e.g. 45">
                    </div>
                    <div class="input-group" style="justify-content: flex-end;">
                        <button onclick="calculateBMI()" style="padding: 10px 20px; background: var(--color-primary); color: white; border: none; border-radius: 4px; cursor: pointer;">Calculate</button>
                    </div>
                </div>
                <div id="bmiResult" class="bmi-result"></div>
            </div>
        </section>

        <!-- SECTION 2: DIAGNOSIS -->
        <section id="diagnosis">
            <div class="grid-2">
                <!-- DSM-5 Checklist -->
                <div class="card info">
                    <h2>DSM-5 Diagnostic Criteria</h2>
                    <p style="font-size: 0.85rem; margin-bottom: 15px;">Check presence of symptoms:</p>
                    
                    <div class="checklist-item" onclick="toggleCheck(this)">
                        <input type="checkbox">
                        <span>Restriction of energy intake relative to requirements → Significantly low body weight.</span>
                    </div>
                    <div class="checklist-item" onclick="toggleCheck(this)">
                        <input type="checkbox">
                        <span>Intense fear of gaining weight or persistent behavior interfering with weight gain.</span>
                    </div>
                    <div class="checklist-item" onclick="toggleCheck(this)">
                        <input type="checkbox">
                        <span>Disturbance in self-evaluation of body weight/shape or lack of seriousness of low weight.</span>
                    </div>
                    
                    <div style="margin-top: 15px; padding: 10px; background: #eee; border-radius: 4px;">
                        <strong>Subtype Identification:</strong><br>
                        <span style="font-size: 0.9rem;">☐ Restricting Type</span><br>
                        <span style="font-size: 0.9rem;">☐ Binge-Eating/Purging Type</span>
                    </div>
                </div>

                <!-- Key Risk Factors -->
                <div class="card info">
                    <h2>Key Risk Factors</h2>
                    <ul class="feature-list">
                        <li><strong>Demographics:</strong> Female (70-90%), Late Adolescence (15-19 yrs).</li>
                        <li><strong>Comorbidities:</strong> Depression, Anxiety, OCD, Type 1 Diabetes.</li>
                        <li><strong>Social:</strong> Athletes, Western media exposure, perfectionist traits.</li>
                        <li><strong>History:</strong> Childhood maltreatment, appearance-related teasing.</li>
                    </ul>
                </div>
            </div>

            <!-- Severity Table -->
            <div class="card info" style="margin-top: 20px;">
                <h2>Disease Severity (BMI)</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Severity</th>
                            <th>BMI Range (Adults)</th>
                            <th>Action Level</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Mild</td>
                            <td>≥ 17 kg/m²</td>
                            <td style="color: var(--color-success);">Outpatient</td>
                        </tr>
                        <tr>
                            <td>Moderate</td>
                            <td>16 - 16.99 kg/m²</td>
                            <td>Consider higher care</td>
                        </tr>
                        <tr>
                            <td>Severe</td>
                            <td>15 - 15.99 kg/m²</td>
                            <td>Specialized ED program</td>
                        </tr>
                        <tr style="background-color: var(--color-danger-bg);">
                            <td>Extreme</td>
                            <td>&lt; 15 kg/m²</td>
                            <td style="color: var(--color-danger); font-weight: bold;">Inpatient Admission</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- SECTION 3: INVESTIGATIONS -->
        <section id="investigations">
            <div class="grid-2">
                <!-- 1st Line Tests -->
                <div class="card info">
                    <h2>1st Line Tests (All Patients)</h2>
                    <table>
                        <tr>
                            <td><strong>Full Blood Count</strong></td>
                            <td>Normocytic anemia, leukopenia</td>
                        </tr>
                        <tr>
                            <td><strong>Serum Chemistry</strong></td>
                            <td>Hypokalaemia, Hyponatraemia, Hypophosphataemia</td>
                        </tr>
                        <tr>
                            <td><strong>Thyroid Function</strong></td>
                            <td>Low T3 (sick euthyroid syndrome)</td>
                        </tr>
                        <tr>
                            <td><strong>Urinalysis</strong></td>
                            <td>Ketonuria (semi-starvation)</td>
                        </tr>
                    </table>
                </div>

                <!-- Additional Tests -->
                <div class="card info">
                    <h2>Additional Tests</h2>
                    <table>
                        <tr>
                            <td><strong>ECG</strong></td>
                            <td>Bradycardia, QTc prolongation, arrhythmia</td>
                        </tr>
                        <tr>
                            <td><strong>Bone Densitometry</strong></td>
                            <td>If amenorrhea >6-12m (or 2 yrs adults)</td>
                        </tr>
                        <tr>
                            <td><strong>Liver Function</strong></td>
                            <td>Transaminitis (improve with re-feeding)</td>
                        </tr>
                        <tr>
                            <td><strong>Glucose</strong></td>
                            <td>Hypoglycaemia (if <3 mmol/L, high risk)</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <div class="card danger" style="margin-top: 20px;">
                <h2><span style="color: var(--color-danger)">⚠</span> Imminent Risk to Life Labs</h2>
                <p>Immediate specific nutrient supplementation required for:</p>
                <ul class="feature-list" style="display: flex; flex-wrap: wrap; gap: 20px;">
                    <li><span class="bg-danger">Hypophosphataemia</span></li>
                    <li><span class="bg-danger">Potassium &lt; 2.5 mmol/L</span></li>
                    <li><span class="bg-danger">Glucose &lt; 3 mmol/L</span></li>
                </ul>
            </div>
        </section>

        <!-- SECTION 4: MANAGEMENT -->
        <section id="management">
            <div class="grid-2">
                <div class="card success">
                    <h2>Treatment Goals</h2>
                    <ul class="feature-list">
                        <li><strong>Weight Restoration:</strong> Essential to prevent sequelae (heart failure, osteoporosis).</li>
                        <li><strong>Re-feeding:</strong> Start low and go slow to prevent re-feeding syndrome.</li>
                        <li><strong>Psychotherapy:</strong> FBT (Family Based Therapy) for adolescents.</li>
                        <li><strong>Monitoring:</strong> Weekly appointments initially; daily electrolytes inpatients.</li>
                    </ul>
                </div>

                <div class="card info">
                    <h2>Patient Discussions</h2>
                    <ul class="feature-list">
                        <li><strong>Vegetarian/Vegan:</strong> If coincident with illness onset, discourage.</li>
                        <li><strong>Oral Contraceptives:</strong> Explain that they mask amenorrhea and do not protect bone health fully.</li>
                        <li><strong>Complications:</strong> Discuss risks of fertility issues and osteoporosis if untreated.</li>
                    </ul>
                </div>
            </div>

            <div class="card info" style="margin-top: 20px;">
                <h2>Prognosis</h2>
                <p>AN has one of the highest premature mortality rates among psychiatric illnesses (5x greater than peers).</p>
                <p><strong>Cause of death:</strong> Medical complications or Suicide (20% of adult deaths).</p>
            </div>
        </section>

    </main>

    <footer>
        <p>Disclaimer: This tool is for educational and quick-reference purposes only. It is based on BMJ Best Practice (May 2025). Always use professional clinical judgment.</p>
    </footer>

</div>

<script>
    // Tab Switching Logic
    function showTab(tabId) {
        // Hide all sections
        document.querySelectorAll('section').forEach(sec => {
            sec.classList.remove('active');
        });
        // Deactivate all buttons
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        // Show selected section
        document.getElementById(tabId).classList.add('active');
        
        // Activate button (finding the button that calls this function with specific ID is tricky, so we iterate)
        const btns = document.querySelectorAll('.nav-btn');
        if(tabId === 'emergency') btns[0].classList.add('active');
        if(tabId === 'diagnosis') btns[1].classList.add('active');
        if(tabId === 'investigations') btns[2].classList.add('active');
        if(tabId === 'management') btns[3].classList.add('active');
    }

    // BMI Calculator Logic
    function calculateBMI() {
        const h = document.getElementById('height').value;
        const w = document.getElementById('weight').value;
        const resultDiv = document.getElementById('bmiResult');
        
        if (h && w) {
            const heightInMeters = h / 100;
            const bmi = (w / (heightInMeters * heightInMeters)).toFixed(1);
            
            let colorClass = '';
            let severityText = '';
            
            // Severity Logic
            if (bmi < 13) {
                colorClass = 'bg-danger';
                severityText = 'EXTREME RISK (Hospitalization Needed)';
            } else if (bmi < 15) {
                colorClass = 'bg-danger';
                severityText = 'Extreme (BMI <15)';
            } else if (bmi < 16) {
                colorClass = 'bg-danger'; // Using red background for text visibility on alert
                severityText = 'Severe (BMI 15-15.99)';
            } else if (bmi < 17) {
                colorClass = 'bg-success'; // Using green bg, but usually orange/yellow for mod, defaulting to green for safety/success logic or modifying css. Let's use neutral/blue-ish for mod.
                severityText = 'Moderate (BMI 16-16.99)';
                colorClass = 'bg-info'; // Custom class handling below
            } else if (bmi >= 17) {
                colorClass = 'bg-success';
                severityText = 'Mild (BMI ≥17)';
            }

            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <div style="font-size: 1.5rem;">BMI: <strong>${bmi}</strong></div>
                <span class="severity-badge" style="background-color: var(--${bmi < 16 ? 'color-danger' : 'color-success'})">${severityText}</span>
            `;
        } else {
            resultDiv.style.display = 'none';
        }
    }

    // Checklist Interaction
    function toggleCheck(element) {
        const checkbox = element.querySelector('input[type="checkbox"]');
        // Toggle checkbox state if clicking the div
        if (event.target !== checkbox) {
            checkbox.checked = !checkbox.checked;
        }
        
        if (checkbox.checked) {
            element.classList.add('checked');
        } else {
            element.classList.remove('checked');
        }
    }
</script>

</body>
</html>