<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hereditary Spherocytosis - Interactive Clinical Algorithm</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
        }

        .header {
            grid-column: 1 / -1;
            background: white;
            padding: 25px 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            margin-bottom: 10px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.2rem;
            margin-bottom: 8px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .progress-sidebar {
            position: sticky;
            top: 20px;
            height: fit-content;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .progress-sidebar h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-item {
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
            color: #7f8c8d;
            background: #f8f9fa;
        }

        .progress-item:hover {
            transform: translateX(5px);
            background: #e9ecef;
        }

        .progress-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .progress-item i {
            width: 20px;
            text-align: center;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 0.6s ease forwards;
        }

        .card:nth-child(2) { animation-delay: 0.1s; }
        .card:nth-child(3) { animation-delay: 0.2s; }
        .card:nth-child(4) { animation-delay: 0.3s; }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .card-header {
            padding: 25px 30px;
            color: white;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .card-header:hover {
            filter: brightness(1.1);
        }

        .card-header.assessment {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .card-header.diagnosis {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
        }

        .card-header.treatment {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .card-header.followup {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.4rem;
            font-weight: 600;
        }

        .card-title i {
            font-size: 1.8rem;
        }

        .expand-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .card.expanded .card-content {
            max-height: 3000px;
        }

        .content-section {
            padding: 25px 30px;
            border-top: 1px solid #eee;
        }

        .content-section h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .severity-badges {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: white;
        }

        .badge.urgent {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .badge.caution {
            background: linear-gradient(135deg, #f39c12 0%, #d35400 100%);
        }

        .badge.stable {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .info-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .info-card h5 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .info-card ul {
            list-style: none;
            padding: 0;
        }

        .info-card li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .info-card li::before {
            content: "•";
            position: absolute;
            left: 0;
            color: #3498db;
            font-weight: bold;
        }

        .algorithm-step {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #667eea;
        }

        .step-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .step-content {
            color: #555;
            line-height: 1.7;
        }

        .highlight-box {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 1px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .warning-box {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border: 1px solid #dc3545;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .success-box {
            background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);
            border: 1px solid #17a2b8;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .classification-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .classification-table th {
            background: #2c3e50;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .classification-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .classification-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .classification-table tr:hover {
            background: #e9ecef;
        }

        .footer {
            grid-column: 1 / -1;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .progress-sidebar {
                position: relative;
                top: 0;
                margin-bottom: 25px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .card-title {
                font-size: 1.2rem;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-dna"></i> Hereditary Spherocytosis</h1>
            <p>Interactive Clinical Decision Algorithm | BMJ Best Practice Guidelines</p>
        </div>

        <div class="progress-sidebar">
            <h3><i class="fas fa-map-marked-alt"></i> Algorithm Progress</h3>
            <div class="progress-item active" data-step="assessment">
                <i class="fas fa-stethoscope"></i> Assessment
            </div>
            <div class="progress-item" data-step="diagnosis">
                <i class="fas fa-microscope"></i> Diagnosis
            </div>
            <div class="progress-item" data-step="treatment">
                <i class="fas fa-pills"></i> Treatment
            </div>
            <div class="progress-item" data-step="followup">
                <i class="fas fa-chart-line"></i> Follow-up
            </div>
        </div>

        <div class="main-content">
            <!-- Assessment Card -->
            <div class="card expanded" id="assessment-card">
                <div class="card-header assessment">
                    <div class="card-title">
                        <i class="fas fa-stethoscope"></i>
                        Assessment & Clinical Presentation
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="content-section">
                        <h4><i class="fas fa-exclamation-triangle"></i> Key Diagnostic Factors</h4>
                        <div class="severity-badges">
                            <span class="badge caution"><i class="fas fa-users"></i> Family History</span>
                            <span class="badge caution"><i class="fas fa-eye-dropper"></i> Pallor</span>
                            <span class="badge caution"><i class="fas fa-tint"></i> Jaundice</span>
                            <span class="badge caution"><i class="fas fa-hand-holding-medical"></i> Splenomegaly</span>
                        </div>
                        
                        <div class="info-grid">
                            <div class="info-card">
                                <h5>Risk Factors</h5>
                                <ul>
                                    <li>Northern European ancestry (1 in 5000)</li>
                                    <li>Family history of anemia, jaundice, or splenectomy</li>
                                    <li>Parent with known HS (75% autosomal dominant)</li>
                                    <li>Consanguinity (rare recessive forms)</li>
                                </ul>
                            </div>
                            <div class="info-card">
                                <h5>Physical Examination</h5>
                                <ul>
                                    <li>Splenomegaly (nearly universal)</li>
                                    <li>Mild jaundice (variable severity)</li>
                                    <li>Pallor (if anaemic)</li>
                                    <li>Signs of anaemia (fatigue, tachycardia)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="content-section">
                        <h4><i class="fas fa-baby"></i> Age-Specific Presentations</h4>
                        <table class="classification-table">
                            <thead>
                                <tr>
                                    <th>Age Group</th>
                                    <th>Presentation</th>
                                    <th>Clinical Severity</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Neonatal Period</strong></td>
                                    <td>Jaundice (within 24h), Hydrops fetalis (rare)</td>
                                    <td><span class="badge urgent">Severe</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Early Childhood</strong></td>
                                    <td>Severe hemolytic anemia</td>
                                    <td><span class="badge urgent">Severe</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Childhood</strong></td>
                                    <td>Anemia, Parvovirus B19 infection</td>
                                    <td><span class="badge caution">Moderate</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Adulthood</strong></td>
                                    <td>Incidental finding, Pregnancy-exacerbated anemia</td>
                                    <td><span class="badge stable">Mild</span></td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="warning-box">
                            <strong><i class="fas fa-virus"></i> Parvovirus B19 Infection:</strong> May unmask undiagnosed HS through aplastic crisis. Patients present with acute pallor, lethargy, fever. Hb typically 30-60 g/L with reticulocytes <1%.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Diagnosis Card -->
            <div class="card" id="diagnosis-card">
                <div class="card-header diagnosis">
                    <div class="card-title">
                        <i class="fas fa-microscope"></i>
                        Diagnostic Investigations
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="content-section">
                        <h4><i class="fas fa-vial"></i> Initial Laboratory Tests</h4>
                        <div class="info-grid">
                            <div class="info-card">
                                <h5>Full Blood Count</h5>
                                <ul>
                                    <li>Hb: Normal or reduced</li>
                                    <li>MCV: Normal or reduced</li>
                                    <li>MCHC: >350 g/L (key clue)</li>
                                    <li>Platelets/WBC: Usually normal</li>
                                </ul>
                            </div>
                            <div class="info-card">
                                <h5>Blood Smear</h5>
                                <ul>
                                    <li>Spherocytes (dense, no central pallor)</li>
                                    <li>Pincer cells (mushroom-shaped) with band 3 defects</li>
                                    <li>Polychromasia (reticulocytes)</li>
                                </ul>
                            </div>
                            <div class="info-card">
                                <h5>Additional Tests</h5>
                                <ul>
                                    <li>Reticulocytes: >3% (usually >6%)</li>
                                    <li>Bilirubin: Raised unconjugated</li>
                                    <li>DAT: Negative (rules out AIHA)</li>
                                    <li>LFTs: Usually normal</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="content-section">
                        <h4><i class="fas fa-flask"></i> Confirmatory Tests (if atypical)</h4>
                        <div class="algorithm-step">
                            <div class="step-title">
                                <i class="fas fa-atom"></i> Eosin-5-Maleimide (EMA) Binding Test
                            </div>
                            <div class="step-content">
                                Gold standard confirmatory test. Reduced fluorescence intensity indicates band 3 protein defect. 
                                <strong>Sensitivity 92.7%, Specificity 99.1%</strong>
                            </div>
                        </div>

                        <div class="algorithm-step">
                            <div class="step-title">
                                <i class="fas fa-snowflake"></i> Cryohaemolysis Test
                            </div>
                            <div class="step-content">
                                RBCs with membrane defects lyse when subjected to severe cold. 
                                <strong>Sensitivity 95%, Specificity 96%</strong> (threshold 15%)
                            </div>
                        </div>

                        <div class="algorithm-step">
                            <div class="step-title">
                                <i class="fas fa-dna"></i> Genetic Analysis
                            </div>
                            <div class="step-content">
                                Next-generation sequencing identifies mutations in spectrin, ankyrin, band 3, or protein 4.2 genes. 
                                Useful for atypical families or prenatal diagnosis.
                            </div>
                        </div>
                    </div>

                    <div class="content-section">
                        <h4><i class="fas fa-layer-group"></i> Severity Classification</h4>
                        <table class="classification-table">
                            <thead>
                                <tr>
                                    <th>Severity</th>
                                    <th>Haemoglobin</th>
                                    <th>Reticulocytes</th>
                                    <th>Bilirubin</th>
                                    <th>Splenectomy</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="badge stable">Trait</span></td>
                                    <td>Normal</td>
                                    <td>&lt;3%</td>
                                    <td>&lt;17 μmol/L</td>
                                    <td>Not required</td>
                                </tr>
                                <tr>
                                    <td><span class="badge stable">Mild</span></td>
                                    <td>110-150 g/L</td>
                                    <td>3-6%</td>
                                    <td>17-34 μmol/L</td>
                                    <td>Usually not</td>
                                </tr>
                                <tr>
                                    <td><span class="badge caution">Moderate</span></td>
                                    <td>80-120 g/L</td>
                                    <td>&gt;6%</td>
                                    <td>&gt;34 μmol/L</td>
                                    <td>May be necessary</td>
                                </tr>
                                <tr>
                                    <td><span class="badge urgent">Severe</span></td>
                                    <td>&lt;60-80 g/L</td>
                                    <td>&gt;10%</td>
                                    <td>&gt;51 μmol/L</td>
                                    <td>Necessary (delay &gt;6 years)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Treatment Card -->
            <div class="card" id="treatment-card">
                <div class="card-header treatment">
                    <div class="card-title">
                        <i class="fas fa-pills"></i>
                        Management & Treatment
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="content-section">
                        <h4><i class="fas fa-baby"></i> Neonatal Management (&lt;28 days)</h4>
                        <div class="warning-box">
                            <strong>Up to 76% require transfusions</strong> in first 6-12 months despite normal Hb at birth.
                        </div>
                        <div class="info-grid">
                            <div class="info-card">
                                <h5>Red Blood Cell Transfusions</h5>
                                <ul>
                                    <li>Maintain Hb 70-80 g/L</li>
                                    <li>Required until reticulocyte response improves</li>
                                    <li>Does not predict long-term severity</li>
                                </ul>
                            </div>
                            <div class="info-card">
                                <h5>Neonatal Jaundice</h5>
                                <ul>
                                    <li>Common, occurs within 24 hours</li>
                                    <li>Phototherapy if bilirubin high</li>
                                    <li>Exchange transfusion if severe</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="content-section">
                        <h4><i class="fas fa-procedures"></i> Severe HS Management</h4>
                        <div class="severity-badges">
                            <span class="badge urgent"><i class="fas fa-cut"></i> Splenectomy</span>
                            <span class="badge caution"><i class="fas fa-syringe"></i> Vaccinations</span>
                            <span class="badge caution"><i class="fas fa-pills"></i> Antibiotic Prophylaxis</span>
                        </div>

                        <div class="algorithm-step">
                            <div class="step-title">
                                <i class="fas fa-cut"></i> Splenectomy (Treatment of Choice)
                            </div>
                            <div class="step-content">
                                <strong>Timing:</strong> Delay until >6 years if possible (reduce sepsis risk). May consider >2 years if transfusion-dependent.<br>
                                <strong>Approach:</strong> Laparoscopic preferred (less pain, quicker recovery). Partial splenectomy may preserve immune function but higher recurrence risk.<br>
                                <strong>Outcome:</strong> Normal/near-normal Hb, reduced reticulocytes, spherocytes persist but lifespan normalizes.
                            </div>
                        </div>

                        <div class="algorithm-step">
                            <div class="step-title">
                                <i class="fas fa-syringe"></i> Pre-splenectomy Vaccinations
                            </div>
                            <div class="step-content">
                                <strong>Essential vaccines:</strong>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li>Pneumococcal: PCV15/PCV20/PCV21 or PPSV23</li>
                                    <li>Haemophilus influenzae type b (Hib)</li>
                                    <li>Neisseria meningitidis: MenACWY and MenB</li>
                                </ul>
                                Administer at least 2 weeks preoperatively.
                            </div>
                        </div>

                        <div class="algorithm-step">
                            <div class="step-title">
                                <i class="fas fa-pills"></i> Antibiotic Prophylaxis
                            </div>
                            <div class="step-content">
                                <strong>Penicillin V:</strong> 
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li>&lt;5 years: 125 mg BD</li>
                                    <li>≥5 years: 250 mg BD</li>
                                </ul>
                                Continue for <strong>minimum 3 years</strong>; consider lifelong in high-risk patients (age >50, immunosuppression, previous invasive pneumococcal disease).
                            </div>
                        </div>

                        <div class="highlight-box">
                            <i class="fas fa-apple-alt"></i> <strong>Folic Acid:</strong> 2-5 mg daily if reticulocytes >5% (prevents megaloblastic anemia). Not required post-splenectomy.
                        </div>
                    </div>

                    <div class="content-section">
                        <h4><i class="fas fa-chart-line"></i> Mild-to-Moderate HS</h4>
                        <div class="success-box">
                            <strong>General Approach:</strong> Supportive management with regular monitoring. Splenectomy only for quality of life issues (bothersome jaundice, fatigue, poor growth).
                        </div>
                        <div class="info-grid">
                            <div class="info-card">
                                <h5>When to Consider Splenectomy</h5>
                                <ul>
                                    <li>Recurrent hyperhemolytic crises</li>
                                    <li>Multiple transfusions required</li>
                                    <li>Poor quality of life (jaundice, fatigue)</li>
                                    <li>Growth/performance issues</li>
                                </ul>
                            </div>
                            <div class="info-card">
                                <h5>Gallstone Management</h5>
                                <ul>
                                    <li>50% have gallstones by age 50</li>
                                    <li>Ultrasound before splenectomy</li>
                                    <li>Symptomatic: Cholecystectomy + splenectomy</li>
                                    <li>Asymptomatic: Individualize decision</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Follow-up Card -->
            <div class="card" id="followup-card">
                <div class="card-header followup">
                    <div class="card-title">
                        <i class="fas fa-chart-line"></i>
                        Follow-up & Long-term Monitoring
                    </div>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="content-section">
                        <h4><i class="fas fa-calendar-alt"></i> Monitoring Schedule</h4>
                        <div class="info-grid">
                            <div class="info-card">
                                <h5>Infancy (First Year)</h5>
                                <ul>
                                    <li>FBC every 2-4 months if anaemic</li>
                                    <li>Monitor reticulocyte response</li>
                                    <li>Assess transfusion needs</li>
                                </ul>
                            </div>
                            <div class="info-card">
                                <h5>Childhood & Adulthood</h5>
                                <ul>
                                    <li>Annual FBC and clinical review</li>
                                    <li>Monitor spleen size</li>
                                    <li>Assymptom changes</li>
                                    <li>Gallbladder ultrasound every 3-5 years after age 5</li>
                                </ul>
                            </div>
                            <div class="info-card">
                                <h5>Post-Splenectomy</h5>
                                <ul>
                                    <li>Lifelong infection vigilance</li>
                                    <li>Annual review of prophylaxis</li>
                                    <li>Vaccination boosters as needed</li>
                                    <li>Monitor for vascular complications</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="content-section">
                        <h4><i class="fas fa-exclamation-circle"></i> Potential Complications</h4>
                        <div class="severity-badges">
                            <span class="badge urgent"><i class="fas fa-virus"></i> Aplastic Crisis</span>
                            <span class="badge caution"><i class="fas fa-gem"></i> Gallstones</span>
                            <span class="badge caution"><i class="fas fa-lungs"></i> Extramedullary Hematopoiesis</span>
                            <span class="badge urgent"><i class="fas fa-biohazard"></i> Post-Splenectomy Sepsis</span>
                        </div>

                        <div class="algorithm-step">
                            <div class="step-title">
                                <i class="fas fa-virus"></i> Aplastic Crisis (Parvovirus B19)
                            </div>
                            <div class="step-content">
                                <strong>Timeframe:</strong> Short-term | <strong>Likelihood:</strong> Medium<br>
                                Sudden onset pallor, lethargy, fever. Hb 30-60 g/L, reticulocytes &lt;1%. 
                                <strong>Action:</strong> Urgent transfusion, monitor recovery (reticulocyte rise in 10 days).
                            </div>
                        </div>

                        <div class="algorithm-step">
                            <div class="step-title">
                                <i class="fas fa-gem"></i> Gallstones
                            </div>
                            <div class="step-content">
                                <strong>Timeframe:</strong> Long-term | <strong>Likelihood:</strong> Medium<br>
                                Pigment stones due to chronic hemolysis. May cause biliary colic, obstruction. 
                                <strong>Management:</strong> Cholecystectomy if symptomatic; consider during splenectomy.
                            </div>
                        </div>

                        <div class="algorithm-step">
                            <div class="step-title">
                                <i class="fas fa-biohazard"></i> Overwhelming Post-Splenectomy Sepsis
                            </div>
                            <div class="step-content">
                                <strong>Timeframe:</strong> Long-term | <strong>Likelihood:</strong> Low but serious<br>
                                Caused by encapsulated organisms (especially pneumococcus). 
                                <strong>Prevention:</strong> Vaccination, antibiotic prophylaxis, emergency antibiotics for fever >38°C.
                            </div>
                        </div>

                        <div class="warning-box">
                            <strong><i class="fas fa-globe"></i> Travel Precautions:</strong> Asplenic patients at increased risk of severe malaria and babesiosis. Ensure adequate malaria prophylaxis and avoid tick exposure.
                        </div>
                    </div>

                    <div class="content-section">
                        <h4><i class="fas fa-users"></i> Patient Education & Counselling</h4>
                        <div class="info-grid">
                            <div class="info-card">
                                <h5>Recognizing Crises</h5>
                                <ul>
                                    <li>Increasing pallor/jaundice with fever</li>
                                    <li>Left upper quadrant pain (splenic enlargement)</li>
                                    <li>Fatigue out of proportion to baseline</li>
                                    <li>Contact healthcare provider promptly</li>
                                </ul>
                            </div>
                            <div class="info-card">
                                <h5>Post-Splenectomy Warning</h5>
                                <ul>
                                    <li>Fever >38°C requires urgent medical attention</li>
                                    <li>Car emergency antibiotics always</li>
                                    <li>Beware of dog bites and tick bites</li>
                                    <li>Inform all healthcare providers of asplenia</li>
                                </ul>
                            </div>
                            <div class="info-card">
                                <h5>Genetic Counselling</h5>
                                <ul>
                                    <li>75% autosomal dominant inheritance</li>
                                    <li>Each child: 50% risk if parent affected</li>
                                    <li>Consider molecular testing for family planning</li>
                                    <li>Screen first-degree relatives</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="content-section">
                        <h4><i class="fas fa-prognosis"></i> Prognosis</h4>
                        <div class="success-box">
                            <strong>Excellent outlook:</strong> Most patients live normal life expectancy. Post-splenectomy patients have normal Hb with minimal symptoms. Long-term risks (infection, thrombosis) are manageable with proper precautions.
                        </div>
                        <div class="highlight-box">
                            <strong>Quality of Life:</strong> Splenectomy markedly improves quality of life in moderate-severe disease. Partial splenectomy may be considered to balance hematological benefit with infection risk.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p><i class="fas fa-info-circle"></i> Based on BMJ Best Practice Guidelines (Last updated: April 17, 2025)</p>
            <p>For healthcare professionals only. Always verify local protocols and consult specialists when needed.</p>
        </div>
    </div>

    <script>
        // Card expansion functionality
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.card');
            const progressItems = document.querySelectorAll('.progress-item');

            // Toggle card expansion
            cards.forEach(card => {
                const header = card.querySelector('.card-header');
                header.addEventListener('click', function() {
                    const isExpanded = card.classList.contains('expanded');
                    
                    // Close all cards
                    cards.forEach(c => {
                        c.classList.remove('expanded');
                        c.style.transform = '';
                    });
                    
                    // Open clicked card if it wasn't already expanded
                    if (!isExpanded) {
                        card.classList.add('expanded');
                    }
                });
            });

            // Progress sidebar navigation
            progressItems.forEach(item => {
                item.addEventListener('click', function() {
                    const step = this.dataset.step;
                    const targetCard = document.getElementById(`${step}-card`);
                    
                    // Update active state
                    progressItems.forEach(p => p.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Expand target card and scroll to it
                    cards.forEach(c => c.classList.remove('expanded'));
                    targetCard.classList.add('expanded');
                    
                    // Smooth scroll with offset for sticky header
                    const headerOffset = 100;
                    const elementPosition = targetCard.offsetTop;
                    const offsetPosition = elementPosition - headerOffset;
                    
                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                });
            });

            // Update active progress item on scroll
            window.addEventListener('scroll', function() {
                const scrollPosition = window.scrollY + 150;
                
                cards.forEach(card => {
                    const cardTop = card.offsetTop;
                    const cardBottom = cardTop + card.offsetHeight;
                    const cardId = card.id.replace('-card', '');
                    
                    if (scrollPosition >= cardTop && scrollPosition <= cardBottom) {
                        progressItems.forEach(p => p.classList.remove('active'));
                        const activeItem = document.querySelector(`[data-step="${cardId}"]`);
                        if (activeItem) activeItem.classList.add('active');
                    }
                });
            });

            // Add hover effect to cards
            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    if (!this.classList.contains('expanded')) {
                        this.style.transform = 'translateY(-5px)';
                    }
                });
                
                card.addEventListener('mouseleave', function() {
                    if (!this.classList.contains('expanded')) {
                        this.style.transform = '';
                    }
                });
            });

            // Animate badges on hover
            const badges = document.querySelectorAll('.badge');
            badges.forEach(badge => {
                badge.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.05)';
                    this.style.transition = 'transform 0.2s ease';
                });
                
                badge.addEventListener('mouseleave', function() {
                    this.style.transform = '';
                });
            });

            // Smooth fade-in for content sections
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('fade-in');
                    }
                });
            }, observerOptions);

            document.querySelectorAll('.content-section').forEach(section => {
                observer.observe(section);
            });
        });
    </script>
</body>
</html>