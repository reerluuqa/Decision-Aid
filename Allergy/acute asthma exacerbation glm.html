<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acute Asthma Exacerbation - Quick Reference</title>
    <style>
        :root {
            /* Palette */
            --primary: #0284c7; /* Blue for general info */
            --primary-dark: #0369a1;
            --danger: #dc2626; /* Red for critical/red flags */
            --danger-bg: #fef2f2;
            --warning: #d97706; /* Orange/Amber for caution */
            --warning-bg: #fffbeb;
            --success: #16a34a; /* Green for safe/positive */
            --success-bg: #f0fdf4;
            --neutral: #4b5563;
            --light-bg: #f8fafc;
            --white: #ffffff;
            --border: #e2e8f0;
            
            /* Spacing & Radius */
            --radius-md: 8px;
            --radius-lg: 12px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--neutral);
            line-height: 1.5;
            padding-bottom: 2rem;
        }

        /* Utility Classes */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .text-danger { color: var(--danger); font-weight: 700; }
        .text-success { color: var(--success); font-weight: 700; }
        .text-warning { color: var(--warning); font-weight: 700; }
        .text-primary { color: var(--primary); }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }
        .badge-danger { background: var(--danger); color: white; }
        .badge-warning { background: var(--warning); color: white; }
        .badge-success { background: var(--success); color: white; }

        /* Header */
        header {
            background: var(--white);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        h1 {
            font-size: 1.25rem;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .meta-info {
            font-size: 0.875rem;
            color: var(--neutral);
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 0.5rem 1rem;
            font-weight: 600;
            color: var(--neutral);
            cursor: pointer;
            border-radius: var(--radius-md);
            transition: all 0.2s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tab-btn:hover { background: var(--light-bg); color: var(--primary); }
        .tab-btn.active { background: var(--primary); color: white; }

        /* Main Content Area */
        .tab-content { display: none; animation: fadeIn 0.3s ease-in-out; }
        .tab-content.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--light-bg);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Severity Matrix Grid */
        .severity-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        @media (min-width: 768px) {
            .severity-grid {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }

        .severity-col {
            padding: 1rem;
            border-radius: var(--radius-md);
            border-left: 5px solid transparent;
            background: var(--light-bg);
        }

        .severity-col.moderate { border-left-color: var(--success); }
        .severity-col.severe { border-left-color: var(--warning); }
        .severity-col.life-threatening { border-left-color: var(--danger); background: var(--danger-bg); }

        .severity-header {
            font-weight: 800;
            margin-bottom: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .severity-list {
            list-style: none;
        }

        .severity-list li {
            margin-bottom: 0.5rem;
            padding-left: 1.25rem;
            position: relative;
            font-size: 0.9rem;
        }

        .severity-list li::before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        .severity-col.life-threatening .severity-list li::before { color: var(--danger); }

        /* Emergency Banner */
        .emergency-banner {
            background: var(--danger);
            color: white;
            padding: 1.5rem;
            border-radius: var(--radius-lg);
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            box-shadow: 0 10px 25px -5px rgba(220, 38, 38, 0.4);
            animation: pulse-red 2s infinite;
        }

        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); }
        }

        .emergency-content h2 { margin-bottom: 0.5rem; font-size: 1.5rem; }
        .emergency-icon { font-size: 2.5rem; }

        /* Two Column Layouts */
        .two-col {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        @media (min-width: 768px) {
            .two-col { grid-template-columns: 1fr 1fr; }
        }

        /* Management Steps */
        .step-item {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .step-content h4 { margin-bottom: 0.25rem; color: var(--neutral); }
        .step-content p { font-size: 0.95rem; color: #64748b; }

        /* Risk Factors Interactive List */
        .risk-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 0.75rem;
        }

        .risk-item {
            background: white;
            border: 1px solid var(--border);
            padding: 0.75rem;
            border-radius: var(--radius-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: all 0.2s;
            user-select: none;
        }

        .risk-item:hover { border-color: var(--primary); }
        
        .risk-item.selected {
            background: var(--success-bg);
            border-color: var(--success);
            text-decoration: line-through;
            color: #86efac;
        }

        .risk-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid var(--neutral);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .risk-item.selected .risk-checkbox {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }
        
        .risk-item.selected .risk-checkbox::after {
            content: "‚úì";
            font-size: 12px;
        }

        /* Calculator/Tools */
        .tool-box {
            background: #f1f5f9;
            padding: 1rem;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            margin-top: 1rem;
        }

        .input-group {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .form-input {
            padding: 0.5rem;
            border: 1px solid #cbd5e1;
            border-radius: var(--radius-md);
            flex: 1;
        }

        .btn-calc {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 600;
        }
        
        .btn-calc:hover { background: var(--primary-dark); }

        .calc-result {
            font-weight: 700;
            font-size: 1.2rem;
            margin-left: 0.5rem;
        }

        /* Icons */
        .icon { width: 20px; height: 20px; fill: currentColor; }
    </style>
</head>
<body>

<header>
    <div class="container header-content">
        <h1>
            <svg class="icon" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
            </svg>
            Acute Asthma Exacerbation
        </h1>
        <div class="meta-info">Updated: Apr 15, 2025</div>
    </div>
    <div class="container">
        <nav class="nav-tabs">
            <button class="tab-btn active" onclick="switchTab('assessment')">
                <span>ü©∫</span> Assessment & Severity
            </button>
            <button class="tab-btn" onclick="switchTab('management')">
                <span>üíä</span> Management Plan
            </button>
            <button class="tab-btn" onclick="switchTab('risk')">
                <span>‚ö†Ô∏è</span> Risk Factors
            </button>
            <button class="tab-btn" onclick="switchTab('tools')">
                <span>üßÆ</span> Tools & Calc
            </button>
        </nav>
    </div>
</header>

<main class="container" style="margin-top: 1.5rem;">

    <!-- SECTION: ASSESSMENT -->
    <section id="assessment" class="tab-content active">
        
        <!-- Emergency Banner -->
        <div class="emergency-banner">
            <div class="emergency-icon">üö®</div>
            <div class="emergency-content">
                <h2>LIFE-THREATENING ASTHMA</h2>
                <p>Immediate admission required if ANY ONE sign is present: Silent chest, cyanosis, poor respiratory effort, altered consciousness, SpO2 &lt;92%, PEF &lt;33%, or 'Normal' PaCO2 (hypoventilation).</p>
            </div>
        </div>

        <!-- Severity Matrix -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">Severity Assessment Matrix</div>
                <span class="badge badge-primary">Clinical Decision</span>
            </div>
            <div class="severity-grid">
                <!-- Moderate -->
                <div class="severity-col moderate">
                    <div class="severity-header" style="color: var(--success);">
                        MODERATE 
                        <span class="badge badge-success">Stable</span>
                    </div>
                    <ul class="severity-list">
                        <li>Speech: Normal</li>
                        <li>Respiratory Rate: &lt;25 /min</li>
                        <li>Pulse Rate: &lt;110 /min</li>
                        <li>PEF: &gt;50% to 75% (best/predicted)</li>
                        <li>SpO2: &ge;92%</li>
                    </ul>
                </div>

                <!-- Acute Severe -->
                <div class="severity-col severe">
                    <div class="severity-header" style="color: var(--warning);">
                        ACUTE SEVERE
                        <span class="badge badge-warning">Admit</span>
                    </div>
                    <ul class="severity-list">
                        <li>Speech: Cannot complete sentences</li>
                        <li>Respiratory Rate: &ge;25 /min</li>
                        <li>Pulse Rate: &ge;110 /min</li>
                        <li>PEF: 33% to 50% (best/predicted)</li>
                        <li>SpO2: &ge;92%</li>
                    </ul>
                </div>

                <!-- Life Threatening -->
                <div class="severity-col life-threatening">
                    <div class="severity-header" style="color: var(--danger);">
                        LIFE-THREATENING
                        <span class="badge badge-danger">ICU/HDU</span>
                    </div>
                    <ul class="severity-list">
                        <li>Speech: Often too breathless</li>
                        <li><strong>Silent Chest</strong></li>
                        <li><strong>Cyanosis</strong></li>
                        <li><strong>Altered Consciousness</strong></li>
                        <li>PEF: &lt;33% (best/predicted)</li>
                        <li>SpO2: &lt;92%</li>
                        <li>PaCO2: 'Normal' (4.6-6.0 kPa) or Raised</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="two-col">
            <!-- Clinical Presentation -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Classic Presentation</div>
                </div>
                <p class="text-primary" style="margin-bottom: 1rem; font-weight:600;">Progressive worsening of symptoms</p>
                <ul class="severity-list">
                    <li>Shortness of breath</li>
                    <li>Wheeze (but beware 'silent chest')</li>
                    <li>Cough</li>
                    <li>Chest tightness</li>
                </ul>
                <div class="tool-box">
                    <strong>Key Exam Points:</strong><br>
                    <small>Check pulse, respiratory rate, accessory muscle use, and auscultation. PEF is the main objective measure.</small>
                </div>
            </div>

            <!-- Key Investigations -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Immediate Investigations</div>
                </div>
                <ul class="severity-list">
                    <li><strong>Peak Expiratory Flow (PEF):</strong> Main objective measure. Repeat 15-30 mins after treatment.</li>
                    <li><strong>Pulse Oximetry (SpO2):</strong> Monitor closely. &lt;92% requires urgent action.</li>
                    <li><strong>Arterial Blood Gas (ABG):</strong> ONLY if life-threatening features, SpO2 &lt;92%, or no response to treatment.</li>
                    <li><strong>Chest X-Ray:</strong> NOT routine. Only if pneumothorax/pneumonia suspected.</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- SECTION: MANAGEMENT -->
    <section id="management" class="tab-content">
        <div class="card" style="border-left: 5px solid var(--primary);">
            <div class="card-header">
                <div class="card-title">Management Algorithm Overview</div>
            </div>
            <p>Start treatment immediately in all cases while arranging transfer if severe. Do not delay for investigations.</p>
        </div>

        <div class="two-col">
            <!-- Immediate Actions -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <svg class="icon text-danger" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                        1. Immediate Actions
                    </div>
                </div>
                <div class="step-item">
                    <div class="step-number" style="background: var(--danger);">1</div>
                    <div class="step-content">
                        <h4>Assess ABC & Sit Up</h4>
                        <p>Check airway, breathing, circulation. Sit patient upright.</p>
                    </div>
                </div>
                <div class="step-item">
                    <div class="step-number" style="background: var(--danger);">2</div>
                    <div class="step-content">
                        <h4>Oxygen Therapy</h4>
                        <p>Target SpO2 94-98% (or 88-92% if at risk of hypercapnic respiratory failure). Use driven nebulizer if available.</p>
                    </div>
                </div>
                <div class="step-item">
                    <div class="step-number" style="background: var(--danger);">3</div>
                    <div class="step-content">
                        <h4>Bronchodilators (SABA)</h4>
                        <p>Salbutamol 4-10 puffs via spacer OR 5mg oxygen-driven nebulizer. Repeat every 15-20 mins.</p>
                    </div>
                </div>
            </div>

            <!-- Secondary Actions -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <svg class="icon text-primary" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
                        2. Systemic Treatment
                    </div>
                </div>
                <div class="step-item">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>Corticosteroids</h4>
                        <p>Prednisolone 40-50mg orally. Early administration prevents relapses.</p>
                    </div>
                </div>
                <div class="step-item">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h4>Ipratropium Bromide</h4>
                        <p>0.5mg nebulized (if acute severe or life-threatening asthma). Add to Salbutamol.</p>
                    </div>
                </div>
                <div class="step-item">
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <h4>IV Magnesium Sulfate</h4>
                        <p>2g IV over 20 mins. Consider for severe cases with no good initial response.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Critical Decision Tree -->
        <div class="card" style="background: var(--warning-bg); border-color: var(--warning);">
            <div class="card-header">
                <div class="card-title" style="color: var(--warning-dark);">Escalation & Referral</div>
            </div>
            <div class="two-col">
                <div>
                    <h4>Admit Immediately If:</h4>
                    <ul class="severity-list">
                        <li>Any features of life-threatening asthma</li>
                        <li>Acute severe asthma persisting after initial treatment</li>
                        <li>Pregnant patients with acute severe asthma</li>
                        <li>Previous history of near-fatal asthma</li>
                    </ul>
                </div>
                <div>
                    <h4>Consider Admission If:</h4>
                    <ul class="severity-list">
                        <li>PEF &lt;50% best/predicted after initial treatment</li>
                        <li>Living alone/social isolation</li>
                        <li>Psychological issues/poor adherence</li>
                        <li>Presentation at night</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION: RISK FACTORS -->
    <section id="risk" class="tab-content">
        <div class="card">
            <div class="card-header">
                <div class="card-title">Risk Factor Checklist</div>
                <span class="badge badge-warning">Click items to mark off</span>
            </div>
            <p style="margin-bottom: 1rem;">Identify modifiable and non-modifiable risks to assess likelihood of severe exacerbation or death.</p>
            
            <div class="risk-list">
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>History of near-fatal asthma (intubation/ICU)</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Hospitalization or ER visit in last year</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Using or recently stopped oral corticosteroids</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Not currently using Inhaled Corticosteroids (ICS)</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Over-use of SABA (e.g. >1 inhaler/month)</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Poor adherence to treatment or action plan</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Low FEV1 (especially &lt;60% predicted)</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Major psychosocial problems</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Confirmed food allergy</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Current smoker or e-cigarette user</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Exposure to allergens or occupational triggers</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Pregnancy</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Obesity</span>
                </div>
                <div class="risk-item" onclick="toggleRisk(this)">
                    <div class="risk-checkbox"></div>
                    <span>Viral respiratory infection</span>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION: TOOLS -->
    <section id="tools" class="tab-content">
        <div class="two-col">
            <!-- PEF Calculator -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">PEF Severity Calculator</div>
                </div>
                <p>Calculate percentage of Best or Predicted Peak Expiratory Flow.</p>
                <div class="tool-box">
                    <label style="display:block; margin-bottom:0.5rem; font-weight:600;">Patient's Best or Predicted PEF:</label>
                    <input type="number" id="pef-best" class="form-input" placeholder="e.g., 500">
                    
                    <label style="display:block; margin-bottom:0.5rem; margin-top:1rem; font-weight:600;">Current Measured PEF:</label>
                    <input type="number" id="pef-current" class="form-input" placeholder="e.g., 250">
                    
                    <button class="btn-calc" style="width: 100%; margin-top: 1rem;" onclick="calculatePEF()">Calculate %</button>
                    
                    <div id="pef-result" style="margin-top: 1rem; text-align: center; display:none;">
                        Result: <span id="pef-value" class="calc-result"></span>%
                        <div id="pef-msg"></div>
                    </div>
                </div>
            </div>

            <!-- Quick Differential Checklist -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Differential Diagnosis</div>
                </div>
                <p>Always consider alternative causes of acute breathlessness.</p>
                <ul class="severity-list">
                    <li><strong>Heart Failure:</strong> Check for pedal edema, bi-basal crackles.</li>
                    <li><strong>Pneumothorax:</strong> Sudden onset, absent breaths unilaterally.</li>
                    <li><strong>Pulmonary Embolism:</strong> Pleuritic chest pain, DVT signs.</li>
                    <li><strong>Anaphylaxis:</strong> Look for skin rash, hypotension, angioedema.</li>
                    <li><strong>Inhaled Foreign Body:</strong> Often unilateral wheeze/history of choking.</li>
                    <li><strong>Vocal Cord Dysfunction:</strong> Stridor usually louder than wheeze.</li>
                </ul>
            </div>
        </div>
    </section>

</main>

<footer>
    <div class="container" style="text-align: center; padding: 2rem 0; color: #94a3b8; font-size: 0.8rem;">
        <p>Disclaimer: This tool is based on BMJ Best Practice (Apr 15, 2025). It is for educational and quick-reference purposes only. Always rely on professional clinical judgment and local guidelines.</p>
    </div>
</footer>

<script>
    // Tab Switching Logic
    function switchTab(tabId) {
        // Hide all contents
        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
        });
        // Deactivate all buttons
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        // Show selected content
        document.getElementById(tabId).classList.add('active');
        // Activate button (finding the button that called this function via event bubbling or direct matching)
        // Simpler approach: Find button by onclick attribute text matching
        const btns = Array.from(document.querySelectorAll('.tab-btn'));
        const activeBtn = btns.find(btn => btn.getAttribute('onclick').includes(tabId));
        if(activeBtn) activeBtn.classList.add('active');
    }

    // Risk Factor Interactive Toggle
    function toggleRisk(element) {
        element.classList.toggle('selected');
    }

    // PEF Calculator Logic
    function calculatePEF() {
        const best = parseFloat(document.getElementById('pef-best').value);
        const current = parseFloat(document.getElementById('pef-current').value);
        const resultContainer = document.getElementById('pef-result');
        const valueSpan = document.getElementById('pef-value');
        const msgSpan = document.getElementById('pef-msg');

        if (!best || !current || best <= 0) {
            // Flash error or placeholder
            valueSpan.innerHTML = "--";
            valueSpan.style.color = "var(--neutral)";
            msgSpan.innerHTML = "Please enter valid numbers.";
            msgSpan.className = "text-neutral";
            resultContainer.style.display = "block";
            return;
        }

        const percentage = (current / best) * 100;
        valueSpan.innerText = percentage.toFixed(0);

        // Set Color and Message
        let colorClass = "";
        let message = "";

        if (percentage > 75) {
            colorClass = "text-success";
            message = "Moderate / Good";
        } else if (percentage >= 50) {
            colorClass = "text-warning";
            message = "Acute Severe Zone";
        } else if (percentage >= 33) {
            colorClass = "text-danger";
            message = "Acute Severe / Critical";
        } else {
            colorClass = "text-danger";
            message = "LIFE-THREATENING Zone";
        }

        valueSpan.className = "calc-result " + colorClass;
        msgSpan.innerHTML = `<span class="${colorClass}" style="font-weight:bold;">${message}</span>`;
        resultContainer.style.display = "block";
    }
</script>

</body>
</html>