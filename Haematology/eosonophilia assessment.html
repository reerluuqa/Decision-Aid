<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eosinophilia Clinical Assessment Tool (ECAT)</title>
    <style>
        :root {
            --emergency-red: #DC2626;
            --emergency-bg: #FEF2F2;
            --emergency-border: #FECACA;
            --urgent-orange: #D97706;
            --urgent-bg: #FFFBEB;
            --urgent-border: #FDE68A;
            --routine-green: #059669;
            --routine-bg: #ECFDF5;
            --routine-border: #A7F3D0;
            --info-blue: #2563EB;
            --info-bg: #EFF6FF;
            --info-border: #BFDBFE;
            --neutral-bg: #F8FAFC;
            --text-primary: #1E293B;
            --text-secondary: #475569;
            --text-muted: #64748B;
            --border-color: #E2E8F0;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #F1F5F9;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: white;
            border-radius: 12px;
            padding: 20px 24px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-md);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
            position: sticky;
            top: 10px;
            z-index: 100;
            border-left: 4px solid var(--info-blue);
        }

        .header h1 {
            font-size: 1.5rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-icon {
            width: 32px;
            height: 32px;
            fill: var(--info-blue);
        }

        .header-meta {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .disclaimer-badge {
            background: var(--info-bg);
            color: var(--info-blue);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            border: 1px solid var(--info-border);
        }

        /* Emergency Banner */
        .emergency-banner {
            background: var(--emergency-bg);
            border: 2px solid var(--emergency-red);
            border-radius: 12px;
            padding: 20px 24px;
            margin-bottom: 20px;
            animation: pulse-border 2s infinite;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .emergency-banner:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        @keyframes pulse-border {
            0%, 100% { border-color: var(--emergency-red); }
            50% { border-color: #F87171; }
        }

        .emergency-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .emergency-icon {
            width: 36px;
            height: 36px;
            fill: var(--emergency-red);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .emergency-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--emergency-red);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .emergency-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
        }

        .emergency-item {
            background: white;
            border-radius: 8px;
            padding: 16px;
            border-left: 4px solid var(--emergency-red);
            transition: all 0.3s ease;
        }

        .emergency-item:hover {
            box-shadow: var(--shadow-md);
            transform: translateX(4px);
        }

        .emergency-item h4 {
            color: var(--emergency-red);
            font-size: 0.9rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .emergency-item p {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .action-box {
            background: var(--emergency-red);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 10px;
            display: inline-block;
        }

        /* Quick Reference Cards */
        .quick-ref-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .ref-card {
            background: white;
            border-radius: 10px;
            padding: 16px;
            text-align: center;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            border-top: 3px solid var(--info-blue);
        }

        .ref-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }

        .ref-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--info-blue);
        }

        .ref-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .ref-card.severe {
            border-top-color: var(--emergency-red);
        }
        .ref-card.severe .ref-value {
            color: var(--emergency-red);
        }

        .ref-card.moderate {
            border-top-color: var(--urgent-orange);
        }
        .ref-card.moderate .ref-value {
            color: var(--urgent-orange);
        }

        .ref-card.mild {
            border-top-color: var(--routine-green);
        }
        .ref-card.mild .ref-value {
            color: var(--routine-green);
        }

        /* Main Content Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Card Styles */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-md);
        }

        .card-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-header.emergency {
            background: var(--emergency-bg);
            border-bottom-color: var(--emergency-border);
        }

        .card-header.urgent {
            background: var(--urgent-bg);
            border-bottom-color: var(--urgent-border);
        }

        .card-header.routine {
            background: var(--routine-bg);
            border-bottom-color: var(--routine-border);
        }

        .card-header.info {
            background: var(--info-bg);
            border-bottom-color: var(--info-border);
        }

        .card-header h2 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .card-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
        }

        .card-body {
            padding: 20px;
        }

        /* Algorithm Section */
        .algorithm-step {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            padding: 16px;
            background: var(--neutral-bg);
            border-radius: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .algorithm-step:hover {
            background: #E2E8F0;
            transform: translateX(4px);
        }

        .step-number {
            width: 36px;
            height: 36px;
            background: var(--info-blue);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        .step-content h3 {
            font-size: 0.95rem;
            color: var(--text-primary);
            margin-bottom: 6px;
        }

        .step-content p {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Two Column Layout */
        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .two-col {
                grid-template-columns: 1fr;
            }
        }

        /* Cause Categories */
        .cause-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .cause-item {
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .cause-item:hover {
            transform: scale(1.02);
            box-shadow: var(--shadow-sm);
        }

        .cause-item.common {
            background: var(--info-bg);
            color: var(--info-blue);
            border-color: var(--info-border);
        }

        .cause-item.important {
            background: var(--urgent-bg);
            color: var(--urgent-orange);
            border-color: var(--urgent-border);
        }

        .cause-item.rare {
            background: var(--neutral-bg);
            color: var(--text-secondary);
            border-color: var(--border-color);
        }

        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .data-table th {
            background: var(--neutral-bg);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 2px solid var(--border-color);
        }

        .data-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            transition: background 0.2s ease;
        }

        .data-table tr:hover td {
            background: var(--neutral-bg);
        }

        .data-table .urgent-row td {
            background: var(--urgent-bg);
        }

        .data-table .urgent-row:hover td {
            background: #FEF3C7;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-badge.emergency {
            background: var(--emergency-bg);
            color: var(--emergency-red);
        }

        .status-badge.urgent {
            background: var(--urgent-bg);
            color: var(--urgent-orange);
        }

        .status-badge.routine {
            background: var(--routine-bg);
            color: var(--routine-green);
        }

        /* Action Items */
        .action-list {
            list-style: none;
        }

        .action-list li {
            padding: 12px 16px;
            margin-bottom: 8px;
            background: var(--neutral-bg);
            border-radius: 8px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .action-list li:hover {
            background: #E2E8F0;
            transform: translateX(4px);
        }

        .action-icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .action-icon.red {
            fill: var(--emergency-red);
        }

        .action-icon.green {
            fill: var(--routine-green);
        }

        .action-icon.blue {
            fill: var(--info-blue);
        }

        /* Condition Cards */
        .condition-card {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            margin-bottom: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .condition-card:hover {
            box-shadow: var(--shadow-md);
        }

        .condition-header {
            padding: 14px 18px;
            background: var(--neutral-bg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .condition-header:hover {
            background: #E2E8F0;
        }

        .condition-title {
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .condition-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .condition-body {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: all 0.4s ease;
        }

        .condition-card.active .condition-body {
            padding: 18px;
            max-height: 500px;
        }

        .condition-detail {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            font-size: 0.85rem;
        }

        .detail-item h4 {
            color: var(--text-muted);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .detail-item p {
            color: var(--text-primary);
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Checklist */
        .checklist-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .checklist-item:hover {
            background: var(--neutral-bg);
            margin: 0 -12px;
            padding: 10px 12px;
            border-radius: 6px;
        }

        .checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 4px;
            flex-shrink: 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checklist-item:hover .checkbox {
            border-color: var(--info-blue);
            background: var(--info-bg);
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 24px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border-color);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 16px;
            padding-left: 20px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -20px;
            top: 6px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--info-blue);
            border: 2px solid white;
            box-shadow: var(--shadow-sm);
        }

        .timeline-item.urgent::before {
            background: var(--urgent-orange);
        }

        .timeline-item.emergency::before {
            background: var(--emergency-red);
        }

        .timeline-content {
            background: var(--neutral-bg);
            padding: 12px;
            border-radius: 8px;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .timeline-content:hover {
            box-shadow: var(--shadow-sm);
            transform: translateX(4px);
        }

        /* Footer */
        .footer {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-muted);
            box-shadow: var(--shadow-sm);
        }

        .footer-disclaimer {
            background: var(--urgent-bg);
            border: 1px solid var(--urgent-border);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 16px;
            font-size: 0.8rem;
            color: var(--urgent-orange);
        }

        /* Print Styles */
        @media print {
            .emergency-banner {
                border: 2px solid black;
                animation: none;
            }
            .header {
                position: static;
            }
            .card:hover {
                box-shadow: none;
                transform: none;
            }
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
            }
            .emergency-grid {
                grid-template-columns: 1fr;
            }
            .ref-card {
                padding: 12px;
            }
            .ref-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>
                <svg class="header-icon" viewBox="0 0 24 24">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58V19z"/>
                </svg>
                Eosinophilia Clinical Assessment Tool
            </h1>
            <div class="header-meta">
                <span class="disclaimer-badge">Clinical Decision Support</span>
                <span style="color: var(--text-muted); font-size: 0.8rem;">v2.0 | 2024</span>
            </div>
        </header>

        <!-- Emergency Banner -->
        <div class="emergency-banner" onclick="toggleSection('emergency-details')">
            <div class="emergency-header">
                <svg class="emergency-icon" viewBox="0 0 24 24">
                    <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
                </svg>
                <span class="emergency-title">Red Flags - Immediate Action Required</span>
            </div>
            <div class="emergency-grid">
                <div class="emergency-item">
                    <h4>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                        Cardiac Damage
                    </h4>
                    <p>Heart failure, valve damage, mural thrombus, pericarditis, or thromboembolic events with eosinophilia</p>
                    <span class="action-box">URGENT: Cardiac echo + Consider steroids</span>
                </div>
                <div class="emergency-item">
                    <h4>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"/></svg>
                        Extreme Eosinophilia
                    </h4>
                    <p>Eosinophil count > 100 × 10⁹/L (100,000/μL) - high risk of tissue damage</p>
                    <span class="action-box">URGENT: IV corticosteroids + Hematology consult</span>
                </div>
                <div class="emergency-item">
                    <h4>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                        DRESS Syndrome
                    </h4>
                    <p>Drug Reaction with Eosinophilia and Systemic Symptoms - mortality up to 10%</p>
                    <span class="action-box">IMMEDIATE: Stop drug + IV steroids + ICU if severe</span>
                </div>
                <div class="emergency-item">
                    <h4>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                        Suspected Malignancy
                    </h4>
                    <p>Blast cells on film, lymphadenopathy, hepatosplenomegaly with marked eosinophilia</p>
                    <span class="action-box">URGENT: Hematology referral + Bone marrow</span>
                </div>
            </div>
        </div>

        <!-- Quick Reference -->
        <section class="quick-ref-section">
            <div class="ref-card">
                <div class="ref-value">&lt;0.5</div>
                <div class="ref-label">Normal (×10⁹/L)</div>
            </div>
            <div class="ref-card mild">
                <div class="ref-value">0.5-1.5</div>
                <div class="ref-label">Mild / Atopy</div>
            </div>
            <div class="ref-card moderate">
                <div class="ref-value">1.5-5.0</div>
                <div class="ref-label">Marked</div>
            </div>
            <div class="ref-card severe">
                <div class="ref-value">&gt;5.0</div>
                <div class="ref-label">Severe</div>
            </div>
            <div class="ref-card severe">
                <div class="ref-value">&gt;100</div>
                <div class="ref-label">Critical</div>
            </div>
        </section>

        <!-- Main Content Grid -->
        <div class="main-grid">
            <!-- Left Column -->
            <div class="left-column">
                <!-- Assessment Algorithm -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-header info">
                        <svg class="card-icon" viewBox="0 0 24 24" fill="#2563EB"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                        <h2>Initial Assessment Algorithm</h2>
                    </div>
                    <div class="card-body">
                        <div class="algorithm-step" onclick="toggleStep(1)">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h3>Confirm & Quantify Eosinophilia</h3>
                                <p>Repeat CBC with differential. Check peripheral blood film for blasts, dysplasia, abnormal eosinophils.</p>
                            </div>
                        </div>
                        <div class="algorithm-step" onclick="toggleStep(2)">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h3>Assess for Secondary Causes</h3>
                                <p>Drug history (2-6 weeks), Travel history, Allergy history, Atopic diseases, Infection signs.</p>
                            </div>
                        </div>
                        <div class="algorithm-step" onclick="toggleStep(3)">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h3>Look for End-Organ Damage</h3>
                                <p>Cardiac echo, LFTs, Troponin, Creatine, CXR, Neuro exam. Highest priority!</p>
                            </div>
                        </div>
                        <div class="algorithm-step" onclick="toggleStep(4)">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h3>Escalate or Investigate Further</h3>
                                <p>If marked/severe: Serology, Stool O&P ×3, Tryptase, B12, Consider bone marrow.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Common Causes -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-header info">
                        <svg class="card-icon" viewBox="0 0 24 24" fill="#2563EB"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                        <h2>Common Causes by Category</h2>
                    </div>
                    <div class="card-body">
                        <div class="two-col">
                            <div>
                                <h4 style="color: var(--info-blue); margin-bottom: 12px; font-size: 0.85rem;">MOST COMMON</h4>
                                <div class="cause-grid">
                                    <div class="cause-item common">Asthma</div>
                                    <div class="cause-item common">Allergic Rhinitis</div>
                                    <div class="cause-item common">Atopic Dermatitis</div>
                                    <div class="cause-item common">Drug Reactions</div>
                                    <div class="cause-item common">Parasitic Infection</div>
                                    <div class="cause-item common">Urticaria</div>
                                </div>
                            </div>
                            <div>
                                <h4 style="color: var(--urgent-orange); margin-bottom: 12px; font-size: 0.85rem;">IMPORTANT NOT TO MISS</h4>
                                <div class="cause-grid">
                                    <div class="cause-item important">EGPA (Churg-Strauss)</div>
                                    <div class="cause-item important">Chronic Eosinophilic Leukemia</div>
                                    <div class="cause-item important">Hodgkin Lymphoma</div>
                                    <div class="cause-item important">DRESS Syndrome</div>
                                    <div class="cause-item important">ABPA</div>
                                    <div class="cause-item important">Eosinophilic GI Disease</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Key Tests Table -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-header info">
                        <svg class="card-icon" viewBox="0 0 24 24" fill="#2563EB"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"/></svg>
                        <h2>Diagnostic Tests by Context</h2>
                    </div>
                    <div class="card-body">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Suspected Cause</th>
                                    <th>First-Line Tests</th>
                                    <th>Additional Tests</th>
                                    <th>Priority</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="urgent-row">
                                    <td>Parasitic infection</td>
                                    <td>Stool O&P ×3, CBC</td>
                                    <td>Serology, Urine/ BAL</td>
                                    <td><span class="status-badge urgent">Urgent</span></td>
                                </tr>
                                <tr class="urgent-row">
                                    <td>Drug reaction</td>
                                    <td>Drug review, LFTs</td>
                                    <td>None specific</td>
                                    <td><span class="status-badge urgent">Urgent</span></td>
                                </tr>
                                <tr>
                                    <td>Allergy/Atopy</td>
                                    <td>IgE, Clinical history</td>
                                    <td>Skin prick, Specific IgE</td>
                                    <td><span class="status-badge routine">Routine</span></td>
                                </tr>
                                <tr>
                                    <td>EGPA/Vasculitis</td>
                                    <td>ANCA, ESR/CRP, CXR</td>
                                    <td>Biopsy, Eosinophil %</td>
                                    <td><span class="status-badge urgent">Urgent</span></td>
                                </tr>
                                <tr class="urgent-row">
                                    <td>Malignancy</td>
                                    <td>Blood film, Tryptase</td>
                                    <td>Bone marrow, Flow cytometry</td>
                                    <td><span class="status-badge emergency">Urgent</span></td>
                                </tr>
                                <tr>
                                    <td>Abpa</td>
                                    <td>IgE total, Aspergillus IgE</td>
                                    <td>CXR, HRCT chest</td>
                                    <td><span class="status-badge routine">Routine</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Specific Conditions Expandable -->
                <div class="card">
                    <div class="card-header info">
                        <svg class="card-icon" viewBox="0 0 24 24" fill="#2563EB"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
                        <h2>Key Conditions - Click to Expand</h2>
                    </div>
                    <div class="card-body">
                        <!-- DRESS Syndrome -->
                        <div class="condition-card">
                            <div class="condition-header" onclick="toggleCondition(this)">
                                <span class="condition-title">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="#DC2626"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
                                    DRESS Syndrome
                                </span>
                                <span class="condition-badge" style="background: var(--emergency-bg); color: var(--emergency-red);">LIFE THREATENING</span>
                            </div>
                            <div class="condition-body">
                                <div class="condition-detail">
                                    <div class="detail-item">
                                        <h4>Key Clues</h4>
                                        <p>Rash, fever, facial edema, lymphadenopathy (2+ sites), 2-6 weeks after new drug</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Common Drugs</h4>
                                        <p>Sulfonamides, anticonvulsants (carbamazepine), allopurinol, minocycline</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Lab Findings</h4>
                                        <p>Eosinophilia, atypical lymphocytes, elevated LFTs, proteinuria, interstitial nephritis</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Action</h4>
                                        <p>IMMEDIATE drug cessation + systemic corticosteroids + monitor organ function</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- EGPA -->
                        <div class="condition-card">
                            <div class="condition-header" onclick="toggleCondition(this)">
                                <span class="condition-title">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="#D97706"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                                    EGPA (Eosinophilic Granulomatosis with Polyangiitis)
                                </span>
                                <span class="condition-badge" style="background: var(--urgent-bg); color: var(--urgent-orange);">SERIOUS</span>
                            </div>
                            <div class="condition-body">
                                <div class="condition-detail">
                                    <div class="detail-item">
                                        <h4>Key Clues</h4>
                                        <p>Asthma history, eosinophilia >10%, mononeuritis multiplex, palpable purpura</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Diagnostic</h4>
                                        <p>ANCA positive (30-40%), elevated ESR/CRP, CXR: reticulonodular infiltrates</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Investigation</h4>
                                        <p>Tissue biopsy: necrotizing vasculitis with eosinophils and granulomas</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Action</h4>
                                        <p>Urgent rheumatology referral + immunosuppression (steroids + rituximab/mepolizumab)</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Chronic Eosinophilic Leukemia -->
                        <div class="condition-card">
                            <div class="condition-header" onclick="toggleCondition(this)">
                                <span class="condition-title">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="#D97706"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                                    Chronic Eosinophilic Leukemia (CEL)
                                </span>
                                <span class="condition-badge" style="background: var(--urgent-bg); color: var(--urgent-orange);">URGENT</span>
                            </div>
                            <div class="condition-body">
                                <div class="condition-detail">
                                    <div class="detail-item">
                                        <h4>Key Clues</h4>
                                        <p>Persistent eosinophilia ≥4 weeks, blast cells ≥2%, cytogenetic abnormalities</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Molecular</h4>
                                        <p>FIP1L1-PDGFRA fusion (clonal), PDGFRB rearrangement - TKI sensitive</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Features</h4>
                                        <p>Hepatosplenomegaly, fatigue, dyspnea, cough, elevated tryptase >20 ng/mL</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Action</h4>
                                        <p>URGENT hematology referral - treat with imatinib if FIP1L1-PDGFRA positive</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Strongyloidiasis -->
                        <div class="condition-card">
                            <div class="condition-header" onclick="toggleCondition(this)">
                                <span class="condition-title">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="#2563EB"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93z"/></svg>
                                    Strongyloidiasis
                                </span>
                                <span class="condition-badge" style="background: var(--info-bg); color: var(--info-blue);">COMMON</span>
                            </div>
                            <div class="condition-body">
                                <div class="condition-detail">
                                    <div class="detail-item">
                                        <h4>Risk Factors</h4>
                                        <p>Tropical/subtropical travel, soil exposure, Appalachian Mountains, Mediterranean</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Symptoms</h4>
                                        <p>Abdominal pain, diarrhea, larva currens, pruritus, cough/wheeze, weight loss</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Tests</h4>
                                        <p>Stool O&P ×3, Serology (sensitive), sputum/BAL if hyperinfection suspected</p>
                                    </div>
                                    <div class="detail-item">
                                        <h4>Critical Action</h4>
                                        <p>Treat BEFORE steroids/immunosuppression to prevent fatal hyperinfection syndrome</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column - Sidebar -->
            <div class="sidebar">
                <!-- Action Checklist -->
                <div class="card">
                    <div class="card-header info">
                        <svg class="card-icon" viewBox="0 0 24 24" fill="#2563EB"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                        <h2>Initial Workup Checklist</h2>
                    </div>
                    <div class="card-body">
                        <div class="checklist-item">
                            <div class="checkbox"><svg width="12" height="12" viewBox="0 0 24 24" fill="#2563EB"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div>
                            <span>Complete blood count with differential</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox"><svg width="12" height="12" viewBox="0 0 24 24" fill="#2563EB"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div>
                            <span>Peripheral blood film review</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox"><svg width="12" height="12" viewBox="0 0 24 24" fill="#2563EB"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div>
                            <span>Comprehensive drug history (all medications)</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox"><svg width="12" height="12" viewBox="0 0 24 24" fill="#2563EB"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div>
                            <span>Travel and exposure history</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox"><svg width="12" height="12" viewBox="0 0 24 24" fill="#2563EB"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div>
                            <span>Allergy and atopy assessment</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox"><svg width="12" height="12" viewBox="0 0 24 24" fill="#2563EB"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div>
                            <span>Cardiac assessment (echo if count >1.5)</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox"><svg width="12" height="12" viewBox="0 0 24 24" fill="#2563EB"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div>
                            <span>Serum tryptase (if malignancy suspected)</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox"><svg width="12" height="12" viewBox="0 0 24 24" fill="#2563EB"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div>
                            <span>Liver function tests</span>
                        </div>
                    </div>
                </div>

                <!-- Referral Guide -->
                <div class="card">
                    <div class="card-header urgent">
                        <svg class="card-icon" viewBox="0 0 24 24" fill="#D97706"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                        <h2>When to Refer</h2>
                    </div>
                    <div class="card-body">
                        <div class="timeline">
                            <div class="timeline-item emergency">
                                <div class="timeline-content">
                                    <strong style="color: var(--emergency-red);">IMMEDIATE (Same Day)</strong>
                                    <p style="margin-top: 6px;">Suspected CEL, blast cells present, cardiac involvement, DRESS syndrome</p>
                                </div>
                            </div>
                            <div class="timeline-item urgent">
                                <div class="timeline-content">
                                    <strong style="color: var(--urgent-orange);">URGENT (Within 1 Week)</strong>
                                    <p style="margin-top: 6px;">Marked/severe eosinophilia (>5.0), EGPA, lymphoma suspicion, unclear cause</p>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-content">
                                    <strong style="color: var(--info-blue);">ROUTINE</strong>
                                    <p style="margin-top: 6px;">Persistent eosinophilia >3 months with no identified cause, suspected eosinophilic GI disease</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Drug Triggers -->
                <div class="card">
                    <div class="card-header urgent">
                        <svg class="card-icon" viewBox="0 0 24 24" fill="#D97706"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                        <h2>Common Drug Triggers</h2>
                    </div>
                    <div class="card-body">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                            <div class="cause-item important" style="font-size: 0.75rem;">Carbamazepine</div>
                            <div class="cause-item important" style="font-size: 0.75rem;">Allopurinol</div>
                            <div class="cause-item important" style="font-size: 0.75rem;">Sulfonamides</div>
                            <div class="cause-item important" style="font-size: 0.75rem;">Phenytoin</div>
                            <div class="cause-item important" style="font-size: 0.75rem;">Penicillin</div>
                            <div class="cause-item important" style="font-size: 0.75rem;">Gold salts</div>
                            <div class="cause-item important" style="font-size: 0.75rem;">Minocycline</div>
                            <div class="cause-item important" style="font-size: 0.75rem;">Nitrofurantoin</div>
                        </div>
                        <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 12px;">Remember: Check OTC meds, supplements, and recently started drugs (2-6 weeks ago).</p>
                    </div>
                </div>

                <!-- Parasite Endemic Areas -->
                <div class="card">
                    <div class="card-header info">
                        <svg class="card-icon" viewBox="0 0 24 24" fill="#2563EB"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93z"/></svg>
                        <h2>Key Parasite Endemic Areas</h2>
                    </div>
                    <div class="card-body">
                        <div style="font-size: 0.85rem;">
                            <div style="margin-bottom: 10px; padding: 8px; background: var(--neutral-bg); border-radius: 6px;">
                                <strong>Strongyloides:</strong> Tropics, Subtropics, SE Asia, Appalachian Mountains, Mediterranean
                            </div>
                            <div style="margin-bottom: 10px; padding: 8px; background: var(--neutral-bg); border-radius: 6px;">
                                <strong>Schistosoma:</strong> Sub-Saharan Africa, many tropical areas, freshwater exposure
                            </div>
                            <div style="margin-bottom: 10px; padding: 8px; background: var(--neutral-bg); border-radius: 6px;">
                                <strong>Filariasis:</strong> Tropical Africa, Asia, South America
                            </div>
                            <div style="margin-bottom: 10px; padding: 8px; background: var(--neutral-bg); border-radius: 6px;">
                                <strong>Clonorchis/Opisthorchis:</strong> Korea, China, Taiwan, Vietnam, SE Asia
                            </div>
                            <div style="padding: 8px; background: var(--neutral-bg); border-radius: 6px;">
                                <strong>Coccidioides:</strong> California, Arizona, southwestern US
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-disclaimer">
                <strong>⚠️ CLINICAL DISCLAIMER:</strong> This tool is for educational and decision support purposes only. 
                Always exercise clinical judgment and refer to local protocols. Not a substitute for specialist consultation.
            </div>
            <p>Based on current best practice guidelines. Last updated: 2024. | Reference: BMI Best Practice - Assessment of Eosinophilia</p>
            <p style="margin-top: 8px;">© 2024 Clinical Decision Support Tool</p>
        </footer>
    </div>

    <script>
        // Toggle condition card expansion
        function toggleCondition(header) {
            const card = header.parentElement;
            const wasActive = card.classList.contains('active');
            
            // Close all other cards
            document.querySelectorAll('.condition-card').forEach(c => {
                c.classList.remove('active');
            });
            
            // Toggle current card
            if (!wasActive) {
                card.classList.add('active');
            }
        }

        // Toggle algorithm step
        function toggleStep(stepNum) {
            // Visual feedback for algorithm steps
            const steps = document.querySelectorAll('.algorithm-step');
            steps.forEach((step, index) => {
                if (index < stepNum) {
                    step.style.background = '#DBEAFE';
                    step.style.borderLeft = '3px solid var(--info-blue)';
                } else {
                    step.style.background = 'var(--neutral-bg)';
                    step.style.borderLeft = 'none';
                }
            });
        }

        // Emergency banner toggle
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Add interactive hover effects for all cards
        document.querySelectorAll('.card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-2px)';
            });
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });

        // Initialize - show first algorithm step
        document.addEventListener('DOMContentLoaded', function() {
            toggleStep(0);
        });

        // Keyboard navigation for accessibility
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.querySelectorAll('.condition-card').forEach(c => {
                    c.classList.remove('active');
                });
            }
        });

        // Add click handlers for all cause items to show details
        document.querySelectorAll('.cause-item').forEach(item => {
            item.addEventListener('click', function() {
                // Visual feedback
                this.style.transform = 'scale(0.98)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 150);
            });
        });
    </script>
</body>
</html>