<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCA Biopsychosocial Revision Assistant</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #27ae60;
            --warning: #f39c12;
            --info: #3498db;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        h1 {
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 25px;
        }
        
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .sidebar {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 20px;
            height: fit-content;
        }
        
        .content-area {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            min-height: 600px;
        }
        
        .category-list {
            list-style-type: none;
        }
        
        .category-item {
            padding: 14px 16px;
            margin-bottom: 10px;
            background-color: var(--light);
            border-left: 5px solid var(--secondary);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .category-item:hover {
            transform: translateX(5px);
            background-color: #e3f2fd;
        }
        
        .category-item.active {
            background-color: #e3f2fd;
            border-left-color: var(--accent);
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }
        
        .category-icon {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .category-title {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light);
        }
        
        .category-title h2 {
            color: var(--primary);
        }
        
        .info-card {
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 25px;
            border-left: 5px solid var(--info);
        }
        
        .services-list, .phrases-list, .stations-list {
            margin-left: 20px;
            margin-bottom: 20px;
        }
        
        .services-list li, .phrases-list li, .stations-list li {
            margin-bottom: 10px;
            padding-left: 10px;
        }
        
        .services-list li::marker, .phrases-list li::marker {
            color: var(--secondary);
            font-weight: bold;
        }
        
        .highlight {
            background-color: #fff9c4;
            padding: 3px 6px;
            border-radius: 4px;
            font-weight: 600;
            color: #333;
        }
        
        .exam-tip {
            background-color: #e8f5e9;
            border-left: 5px solid var(--success);
            padding: 18px;
            border-radius: var(--border-radius);
            margin: 25px 0;
            font-style: italic;
        }
        
        .tab-container {
            display: flex;
            border-bottom: 2px solid var(--light);
            margin-bottom: 25px;
        }
        
        .tab {
            padding: 12px 20px;
            cursor: pointer;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            border-bottom-color: var(--accent);
            color: var(--accent);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .search-box {
            width: 100%;
            padding: 14px;
            border: 2px solid #ddd;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .search-box:focus {
            outline: none;
            border-color: var(--secondary);
        }
        
        .quick-reference {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }
        
        .reference-card {
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
        }
        
        .reference-card:hover {
            transform: translateY(-5px);
        }
        
        .reference-card h4 {
            color: var(--primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
        }
        
        .reference-card h4 span {
            margin-right: 10px;
            font-size: 1.3rem;
        }
        
        .practice-section {
            background-color: #f0f7ff;
            padding: 25px;
            border-radius: var(--border-radius);
            margin-top: 30px;
        }
        
        .scenario {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.05);
        }
        
        .btn {
            padding: 12px 24px;
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
            margin-top: 15px;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--secondary);
            color: var(--secondary);
        }
        
        .btn-outline:hover {
            background-color: var(--secondary);
            color: white;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
            font-size: 0.9rem;
        }
        
        .hidden {
            display: none;
        }
        
        .trigger-item {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .trigger-item:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
            border-color: var(--secondary);
        }
        
        .trigger-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
        }
        
        .trigger-services {
            font-size: 0.95rem;
            color: #555;
            margin-top: 10px;
        }
        
        .key-phrase {
            background-color: #fff8e1;
            padding: 15px;
            border-radius: var(--border-radius);
            margin: 15px 0;
            border-left: 4px solid #ffd54f;
            font-style: italic;
        }
        
        .banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
            margin-bottom: 25px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SCA Biopsychosocial Revision Assistant</h1>
            <p class="subtitle">Master the psychosocial domains for GP practice with this comprehensive exam-focused tool. Based on analysis of 181 Native SCA stations.</p>
        </header>
        
        <div class="banner">
            <span>ðŸ”¥ HIGH-YIELD TIP: You don't need to refer everyone, but you MUST show you thought about it!</span>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <h3>Referral Categories</h3>
                <ul class="category-list" id="categoryList">
                    <!-- Categories will be populated by JavaScript -->
                </ul>
                
                <div style="margin-top: 30px;">
                    <h4>Quick Tools</h4>
                    <button class="btn" id="randomScenarioBtn" style="width: 100%; margin-bottom: 10px;">Random Practice Scenario</button>
                    <button class="btn btn-outline" id="quickCheckBtn" style="width: 100%;">10-Second End-of-Station Check</button>
                </div>
                
                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
                    <h4>Exam Mantra</h4>
                    <p style="font-style: italic; color: #666; font-size: 0.95rem;">"Given the red-flag features, this needs urgent secondary care assessment under the appropriate pathway."</p>
                </div>
            </div>
            
            <div class="content-area">
                <div class="tab-container">
                    <div class="tab active" data-tab="overview">Category Overview</div>
                    <div class="tab" data-tab="triggers">Trigger â†’ Service Pairs</div>
                    <div class="tab" data-tab="phrases">High-Scoring Phrases</div>
                    <div class="tab" data-tab="practice">Practice Scenarios</div>
                </div>
                
                <input type="text" class="search-box" id="searchBox" placeholder="Search for services, triggers, or phrases...">
                
                <!-- Overview Tab -->
                <div class="tab-content active" id="overviewTab">
                    <div class="category-title">
                        <span class="category-icon" id="categoryIcon">ðŸ”´</span>
                        <h2 id="categoryName">Select a Category</h2>
                    </div>
                    
                    <div id="categoryContent">
                        <p>Select a category from the sidebar to view detailed information about expected services, exam phrases, and example stations.</p>
                        
                        <div class="quick-reference" id="quickReference">
                            <!-- Quick reference cards will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
                
                <!-- Triggers Tab -->
                <div class="tab-content" id="triggersTab">
                    <h2>Trigger â†’ Service Pairs</h2>
                    <p>These are the high-yield connections that examiners expect you to recognize and articulate.</p>
                    
                    <div id="triggersList">
                        <!-- Trigger items will be populated by JavaScript -->
                    </div>
                </div>
                
                <!-- Phrases Tab -->
                <div class="tab-content" id="phrasesTab">
                    <h2>High-Scoring, Non-Rehearsed Phrases</h2>
                    <p>Use these natural-sounding phrases to demonstrate clinical reasoning in GP language.</p>
                    
                    <div id="phrasesList">
                        <!-- Phrases will be populated by JavaScript -->
                    </div>
                    
                    <div class="exam-tip">
                        <strong>ðŸ”¥ ONE SENTENCE THAT RESCUES BORDERLINE STATIONS:</strong><br>
                        <em>"At the moment we can manage this in primary care, but I'd want to involve additional support if things don't improve or if the impact on you increases."</em>
                    </div>
                </div>
                
                <!-- Practice Tab -->
                <div class="tab-content" id="practiceTab">
                    <h2>Practice Scenarios</h2>
                    <p>Test your knowledge with these exam-style scenarios. Think about the biopsychosocial approach before revealing the answer.</p>
                    
                    <div class="scenario" id="scenario1">
                        <h4>Scenario 1: Chronic Pain & Isolation</h4>
                        <p>A 58-year-old retired teacher presents with chronic lower back pain that's been worsening over the past 6 months. She lives alone since her husband died two years ago. She mentions she's been struggling to get out of the house and feels very isolated. She's tried paracetamol and ibuprofen with limited effect.</p>
                        
                        <div class="hidden" id="answer1">
                            <div class="key-phrase">
                                <strong>Key exam phrase:</strong> "I can hear how heavy the burden of isolation is weighing on you right now. As your doctor, I'm concerned that this stress is acting like a fuel for your pain, making it much harder for medical treatments to work effectively."
                            </div>
                            
                            <h5>Expected Biopsychosocial Approach:</h5>
                            <ul class="services-list">
                                <li><span class="highlight">Medical:</span> Consider referral to pain clinic, physiotherapy, medication review</li>
                                <li><span class="highlight">Psychological:</span> Referral to IAPT for coping strategies, consider bereavement counseling (Cruse)</li>
                                <li><span class="highlight">Social:</span> <strong>Social prescriber</strong> to address isolation, consider local community groups, exercise referral</li>
                            </ul>
                            
                            <p><strong>Why this scores well:</strong> Links the social factor (isolation) directly to the medical condition (chronic pain) and offers practical, patient-centered solutions.</p>
                        </div>
                        
                        <button class="btn" onclick="toggleAnswer('answer1')">Show Approach</button>
                    </div>
                    
                    <div class="scenario" id="scenario2">
                        <h4>Scenario 2: Teenage Depression with School Issues</h4>
                        <p>A 16-year-old presents with low mood, poor sleep, and dropping grades at school. He admits to feeling overwhelmed and having thoughts that "life isn't worth it" but denies active suicidal intent. His parents are concerned but he's reluctant to engage with help.</p>
                        
                        <div class="hidden" id="answer2">
                            <div class="key-phrase">
                                <strong>Key exam phrase:</strong> "Because of your age and the changes you're describing, I think specialist input is the safest option. This isn't something I'd want to sit on."
                            </div>
                            
                            <h5>Expected Biopsychosocial Approach:</h5>
                            <ul class="services-list">
                                <li><span class="highlight">Medical:</span> Safety assessment, consider medication only if moderate-severe depression</li>
                                <li><span class="highlight">Psychological:</span> <strong>CAMHS referral</strong> (urgent if risk), school counseling service</li>
                                <li><span class="highlight">Social:</span> Involve <strong>school nurse</strong> for in-school support, discuss with parents about creating supportive environment</li>
                            </ul>
                            
                            <p><strong>Why this scores well:</strong> Recognizes the need for age-appropriate services (CAMHS not adult MH), addresses risk appropriately, and involves the school system for holistic care.</p>
                        </div>
                        
                        <button class="btn" onclick="toggleAnswer('answer2')">Show Approach</button>
                    </div>
                    
                    <div class="scenario" id="scenario3">
                        <h4>Scenario 3: Domestic Violence Disclosure</h4>
                        <p>A 32-year-old woman presents with anxiety symptoms and frequent attendances for minor complaints. During consultation, she breaks down and discloses that her partner has been physically abusive on several occasions. She has two children aged 4 and 6. She's afraid to leave because of financial dependence.</p>
                        
                        <div class="hidden" id="answer3">
                            <div class="key-phrase">
                                <strong>Key exam phrase:</strong> "I appreciate you trusting me with this information. My role here is to make sure everyone is safe and supported. Safeguarding isn't about getting anyone into troubleâ€”it allows us to bring in extra support."
                            </div>
                            
                            <h5>Expected Biopsychosocial Approach:</h5>
                            <ul class="services-list">
                                <li><span class="highlight">Medical:</span> Document injuries, address any physical health issues</li>
                                <li><span class="highlight">Psychological:</span> Trauma-informed support, referral to specialist domestic abuse counseling</li>
                                <li><span class="highlight">Social:</span> <strong>Mandatory safeguarding referral</strong> (children), refer to <strong>IDVA</strong>, discuss Women's Aid, safety planning</li>
                            </ul>
                            
                            <p><strong>Why this scores well:</strong> Demonstrates understanding of mandatory reporting while framing it as supportive, not punitive. Shows knowledge of specific services (IDVA).</p>
                        </div>
                        
                        <button class="btn" onclick="toggleAnswer('answer3')">Show Approach</button>
                    </div>
                    
                    <button class="btn" id="newScenarioBtn" style="margin-top: 20px;">Generate New Random Scenario</button>
                </div>
            </div>
        </div>
        
        <div class="practice-section">
            <h3>10-Second End-of-Station Check</h3>
            <p>Use this quick mental checklist at the end of EVERY station to ensure biopsychosocial coverage:</p>
            
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 20px;">
                <div style="background-color: #e8f5e9; padding: 20px; border-radius: var(--border-radius); text-align: center;">
                    <h4>1. MEDICAL</h4>
                    <p>Who treats the disease?</p>
                    <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">Specialist clinics, diagnostics, acute pathways</p>
                </div>
                
                <div style="background-color: #e3f2fd; padding: 20px; border-radius: var(--border-radius); text-align: center;">
                    <h4>2. PSYCHOLOGICAL</h4>
                    <p>Who supports coping/behavior?</p>
                    <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">Mental health, counseling, addiction services</p>
                </div>
                
                <div style="background-color: #f3e5f5; padding: 20px; border-radius: var(--border-radius); text-align: center;">
                    <h4>3. SOCIAL</h4>
                    <p>Who helps them function safely?</p>
                    <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">Safeguarding, benefits, housing, carers support</p>
                </div>
            </div>
            
            <div class="exam-tip" style="margin-top: 25px;">
                <strong>REMEMBER:</strong> If you can name one team/service for each of these three domains, you will not fail on biopsychosocial grounds.
            </div>
        </div>
        
        <footer>
            <p>SCA Biopsychosocial Revision Assistant â€¢ Based on analysis of 181 Native SCA stations â€¢ For educational purposes only</p>
            <p style="margin-top: 10px; font-size: 0.8rem;">Always refer to official guidelines and your clinical judgement in practice.</p>
        </footer>
    </div>

    <script>
        // Data extracted from the provided documents
        const categories = [
            {
                id: 1,
                name: "Acute / Red-Flag Presentations",
                icon: "ðŸ”´",
                color: "#e74c3c",
                stations: ["Bleeding in pregnancy", "Chest pain", "Haematuria", "Neurological symptoms", "Weight loss + anaemia", "Suspected malignancy", "Hypercalcaemia", "Myeloma", "Jaundice", "PR bleed", "Haemoptysis", "Syncope", "Severe headache"],
                services: ["Same-day secondary care referral", "EPAU (early pregnancy)", "Acute medical unit / A&E", "2-Week-Wait cancer pathway", "Haematology / Oncology", "Neurology", "Gastroenterology", "Urology", "Radiology via urgent pathways"],
                phrases: ["Given the red-flag features, this needs urgent secondary care assessment under the appropriate pathway.", "This isn't something we can monitor in primary care given these symptoms."],
                triggers: [
                    { trigger: "Bleeding in pregnancy", services: "EPAU (urgent), Community midwives" },
                    { trigger: "Chest pain with red flags", services: "A&E, Acute medical unit" },
                    { trigger: "Suspected cancer (weight loss, anaemia)", services: "2WW cancer pathway, Relevant specialty" },
                    { trigger: "Neurological deficit (acute)", services: "Neurology, A&E, Urgent CT/MRI" }
                ]
            },
            {
                id: 2,
                name: "Chronic Disease Management",
                icon: "ðŸ«",
                color: "#3498db",
                stations: ["COPD flares", "Poorly controlled COPD", "Asthma", "Uncontrolled diabetes", "Insulin initiation", "CKD", "HF", "Abnormal TFTs", "Lipid reviews"],
                services: ["COPD nurse", "Asthma nurse", "Diabetes specialist nurse", "HF nurse", "Pulmonary rehabilitation", "Podiatry (diabetes)", "Dietitian", "Renal clinic", "Endocrinology (shared care)"],
                phrases: ["I'd involve the specialist nurse team to support optimisation and self-management.", "We need to look at both the medical control and the impact on your daily life."],
                triggers: [
                    { trigger: "COPD exacerbation", services: "COPD nurse, Pulmonary rehab" },
                    { trigger: "Uncontrolled diabetes", services: "Diabetes specialist nurse, Dietitian, Podiatry" },
                    { trigger: "CKD stage 3b+", services: "Renal clinic (shared care)" },
                    { trigger: "Heart failure symptoms", services: "Community HF nurses, Cardiology" }
                ]
            },
            {
                id: 3,
                name: "Mental Health - Adult",
                icon: "ðŸ§ ",
                color: "#9b59b6",
                stations: ["Depression with firearms", "Low mood", "Anxiety episodes", "Insomnia", "Gambling disorder", "PTSD", "Psychosis in adult"],
                services: ["IAPT / Talking Therapies", "Community Mental Health Team (CMHT)", "Crisis Resolution & Home Treatment Team", "Veterans' Mental Health Service", "Addiction services (gambling/alcohol)"],
                phrases: ["Psychological support alongside medical management is essential here.", "Some people find it helpful to have space to talk this through with someone neutral."],
                triggers: [
                    { trigger: "Depression with suicidal thoughts", services: "Crisis team, CMHT" },
                    { trigger: "Anxiety affecting function", services: "IAPT / Talking Therapies" },
                    { trigger: "Psychosis (first episode)", services: "Early Intervention Team, CMHT" },
                    { trigger: "PTSD in veteran", services: "Veterans' Mental Health Service, Op Courage" }
                ]
            },
            {
                id: 4,
                name: "Mental Health - Child & Adolescent",
                icon: "ðŸ§’",
                color: "#1abc9c",
                stations: ["Teen depression", "Psychosis in teenager", "Eating disorder", "Gender dysphoria", "Substance misuse", "Safeguarding concerns"],
                services: ["CAMHS", "CAMHS crisis team", "School nursing", "Safeguarding / social care", "Youth substance misuse services"],
                phrases: ["Because of age and risk, this needs urgent CAMHS involvement.", "This isn't something I'd want to sit on given your age."],
                triggers: [
                    { trigger: "Teenager with depression", services: "CAMHS, School counselor" },
                    { trigger: "Eating disorder in teen", services: "CAMHS eating disorder service" },
                    { trigger: "Child with behavioral issues", services: "CAMHS, Educational psychology" },
                    { trigger: "Adolescent substance misuse", services: "Youth substance misuse service, CAMHS" }
                ]
            },
            {
                id: 5,
                name: "Safeguarding & Domestic Abuse",
                icon: "ðŸ›¡ï¸",
                color: "#e67e22",
                stations: ["Domestic violence", "Safeguarding child", "Safeguarding older adult", "FGM risk", "Coercive relationships", "Missed appointments"],
                services: ["Safeguarding team (children or adults)", "Social services", "MARAC", "IDVA", "Police (only if immediate risk)"],
                phrases: ["Safeguarding here is supportive and protective, not punitive.", "My role here is to make sure everyone is safe and supported."],
                triggers: [
                    { trigger: "Domestic violence disclosure", services: "IDVA, MARAC, Safeguarding" },
                    { trigger: "Child at risk (bruises, neglect)", services: "Children's safeguarding, Social services" },
                    { trigger: "Vulnerable adult at risk", services: "Adult safeguarding, Social services" },
                    { trigger: "FGM concerns", services: "Safeguarding, Specialist FGM clinic" }
                ]
            },
            {
                id: 6,
                name: "Women's Health & Pregnancy",
                icon: "ðŸ¤°",
                color: "#e84393",
                stations: ["Bleeding in pregnancy", "Teenage pregnancy", "Abortion request", "Antenatal concerns", "Post-partum issues"],
                services: ["Early Pregnancy Assessment Unit (EPAU)", "Community midwives", "Sexual health / GUM clinic", "Safeguarding (if vulnerability)"],
                phrases: ["I'd link you in with midwifery services early for coordinated care.", "Early multi-disciplinary input improves outcomes."],
                triggers: [
                    { trigger: "Early pregnancy bleeding", services: "EPAU (urgent)" },
                    { trigger: "Teenage pregnancy", services: "Midwifery, Safeguarding" },
                    { trigger: "Postnatal depression", services: "Perinatal mental health team, Health visitor" },
                    { trigger: "Contraception needs", services: "Sexual health clinic, Community contraception" }
                ]
            },
            {
                id: 7,
                name: "Paediatrics (Non-Mental Health)",
                icon: "ðŸ‘¶",
                color: "#f1c40f",
                stations: ["Ear infections", "UTIs", "Enuresis", "Asthma", "Obesity", "Constipation", "Failure to thrive"],
                services: ["Health visitor", "School nurse", "Paediatric outpatient referral", "Dietitian", "Safeguarding (if non-attendance)"],
                phrases: ["We need to support the family unit, not just treat the child.", "Let's think about how this affects the whole family."],
                triggers: [
                    { trigger: "Child with recurrent infections", services: "Paediatrics, Health visitor" },
                    { trigger: "Childhood obesity", services: "Dietitian, Weight management service" },
                    { trigger: "Bedwetting (enuresis)", services: "ERIC charity, School nurse" },
                    { trigger: "Failure to thrive", services: "Paediatrics, Dietitian, Safeguarding" }
                ]
            },
            {
                id: 8,
                name: "Palliative & End-of-Life Care",
                icon: "ðŸŒ¿",
                color: "#27ae60",
                stations: ["Palliative pain", "Breathlessness", "DNACPR discussions", "Advance care planning"],
                services: ["Community palliative care team", "Hospice", "District nurses", "Gold Standards Framework", "SR1 (DS1500)", "Social prescriber"],
                phrases: ["The focus here is comfort, dignity, and respecting patient preferences.", "At this stage, the priority is comfort and quality of life."],
                triggers: [
                    { trigger: "Advanced cancer symptoms", services: "Community palliative care, Macmillan nurses" },
                    { trigger: "End-of-life care at home", services: "District nurses, Palliative care team" },
                    { trigger: "DNACPR discussion", services: "Palliative care team, Gold Standards Framework" },
                    { trigger: "Financial stress at end of life", services: "SR1 (DS1500), Social prescriber" }
                ]
            },
            {
                id: 9,
                name: "Social & Functional Issues",
                icon: "ðŸ ",
                color: "#8e44ad",
                stations: ["Sick notes", "Work stress", "Carers struggling", "Release from prison", "Benefits issues"],
                services: ["Social prescriber", "Occupational health", "Fit note / amended duties", "Carers' support services", "Local authority housing"],
                phrases: ["Addressing the social context is key to improving outcomes.", "Sometimes the practical side is what makes everything else harder."],
                triggers: [
                    { trigger: "Financial stress affecting health", services: "Social prescriber, Citizens Advice" },
                    { trigger: "Work-related stress", services: "Occupational health, Fit note for amended duties" },
                    { trigger: "Carer strain", services: "Carers' support services, Respite care" },
                    { trigger: "Housing insecurity", services: "Local authority housing, Social prescriber" }
                ]
            },
            {
                id: 10,
                name: "Sexual Health & Confidentiality",
                icon: "â¤ï¸",
                color: "#d63031",
                stations: ["STIs", "HIV testing", "Erectile dysfunction", "Confidentiality concerns"],
                services: ["GUM / Sexual health clinic", "HIV services", "Confidential records restriction", "Counselling"],
                phrases: ["Sexual health services are confidential and patient-led.", "Care is confidential and patient-led."],
                triggers: [
                    { trigger: "STI symptoms", services: "GUM clinic (confidential)" },
                    { trigger: "HIV testing request", services: "Sexual health clinic, HIV services" },
                    { trigger: "Contraception needs (complex)", services: "Sexual health clinic" },
                    { trigger: "Confidentiality concerns (teenager)", services: "Confidential records, GUM clinic" }
                ]
            }
        ];

        // High-scoring phrases data
        const highScoringPhrases = [
            {
                title: "Medical â†’ Psychological Bridge",
                phrase: "Medically, I know what to do next, but I'm also conscious this is taking a toll on you.",
                tip: "Scores without naming a service yet."
            },
            {
                title: "Introducing Mental Health Support",
                phrase: "Some people find it helpful to have space to talk this through with someone neutral. Support doesn't mean there's something 'wrong' â€” it's about coping better.",
                tip: "Non-threatening way to introduce psychological support."
            },
            {
                title: "Safeguarding (Supportive Approach)",
                phrase: "Safeguarding isn't about getting anyone into trouble. It allows us to bring in extra support rather than leaving you to manage alone.",
                tip: "Frames safeguarding as protective, not punitive."
            },
            {
                title: "CAMHS / Crisis Referral",
                phrase: "Because of your age and the changes you're describing, I think specialist input today is the safest option. I'd feel uncomfortable not getting extra support involved.",
                tip: "Examiners love 'I'd feel uncomfortable not...'"
            },
            {
                title: "Social Prescriber / Practical Support",
                phrase: "Sometimes the practical side is what makes everything else harder. There may be help available that doesn't involve more medication.",
                tip: "Addresses often-missed social factors."
            },
            {
                title: "Shared Decision-Making",
                phrase: "How does that plan sound to you? What feels most important for you right now?",
                tip: "Turns management into collaboration."
            },
            {
                title: "Safety-Netting (Not Robotic)",
                phrase: "If you notice X or Y, I'd want you to seek urgent help. I'll be clear about what would worry me.",
                tip: "Better than 'if things get worse, go to A&E'"
            },
            {
                title: "Follow-up (Signals Ownership)",
                phrase: "I don't want this to feel like a one-off conversation. Let's keep this under review.",
                tip: "Shows continuity of care."
            },
            {
                title: "End-of-Station Summary",
                phrase: "So, just to summarise â€” we've got a clear medical plan, we've talked about how this is affecting you emotionally, and we've identified some extra support to help you manage day to day.",
                tip: "Ticks all three biopsychosocial domains in one sentence."
            }
        ];

        // Practice scenarios
        const practiceScenarios = [
            {
                title: "Chronic Pain & Social Isolation",
                content: "A 65-year-old retired carpenter presents with chronic knee pain from osteoarthritis. He lives alone and has become increasingly isolated since his wife died. He's stopped going to his usual social club due to pain and embarrassment about using a walking stick.",
                answer: {
                    medical: "Consider orthopaedic referral for severe OA, physiotherapy for strengthening, analgesia review",
                    psychological: "IAPT for coping with chronic pain, bereavement counseling (Cruse)",
                    social: "Social prescriber to address isolation, local walking groups, home adaptations referral"
                }
            },
            {
                title: "Young Adult with Health Anxiety",
                content: "A 24-year-old graduate student presents for the 5th time in 3 months with various somatic complaints (headaches, palpitations, tingling). He's convinced he has a serious neurological condition despite normal investigations. He's struggling to complete his dissertation.",
                answer: {
                    medical: "Appropriate investigations to rule out pathology, then one GP for continuity",
                    psychological: "IAPT for health anxiety, consider CBT specifically for health anxiety",
                    social: "Social prescriber to help with study/work balance, student support services"
                }
            },
            {
                title: "Elderly Patient with Frequent Falls",
                content: "An 82-year-old woman with mild dementia presents with her daughter after her 3rd fall in 2 months. She lives alone and wants to remain independent. Her daughter is worried but works full-time.",
                answer: {
                    medical: "Falls clinic assessment, medication review (especially sedatives), bone health assessment",
                    psychological: "Memory clinic follow-up, carer support for daughter",
                    social: "OT for home safety assessment, social services for care package, day centre referral"
                }
            },
            {
                title: "Postpartum Mother with Low Mood",
                content: "A 28-year-old mother presents 8 weeks postpartum with low mood, tearfulness, and feeling overwhelmed. She has a supportive partner but no family nearby. She's struggling with breastfeeding and feels like 'a failure'.",
                answer: {
                    medical: "Exclude medical causes (thyroid, anaemia), contraceptive discussion",
                    psychological: "Health visitor for support, Perinatal mental health team, IAPT",
                    social: "Mother and baby groups, breastfeeding support groups, social prescriber for isolation"
                }
            }
        ];

        // DOM Elements
        let currentCategory = categories[0];
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            renderCategories();
            renderCategoryContent(currentCategory);
            renderTriggers();
            renderPhrases();
            renderQuickReference();
            setupEventListeners();
        });
        
        // Render category list in sidebar
        function renderCategories() {
            const categoryList = document.getElementById('categoryList');
            categoryList.innerHTML = '';
            
            categories.forEach(category => {
                const li = document.createElement('li');
                li.className = 'category-item';
                li.innerHTML = `<span class="category-icon">${category.icon}</span> ${category.name}`;
                li.addEventListener('click', () => {
                    // Remove active class from all items
                    document.querySelectorAll('.category-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Add active class to clicked item
                    li.classList.add('active');
                    
                    // Update content
                    currentCategory = category;
                    renderCategoryContent(category);
                    
                    // Switch to overview tab
                    switchTab('overview');
                });
                
                categoryList.appendChild(li);
            });
            
            // Activate first category by default
            if (categoryList.firstChild) {
                categoryList.firstChild.classList.add('active');
            }
        }
        
        // Render category content
        function renderCategoryContent(category) {
            const categoryName = document.getElementById('categoryName');
            const categoryIcon = document.getElementById('categoryIcon');
            const categoryContent = document.getElementById('categoryContent');
            
            categoryName.textContent = category.name;
            categoryIcon.textContent = category.icon;
            
            let stationsHTML = '';
            if (category.stations && category.stations.length > 0) {
                stationsHTML = `<h4>Example Stations:</h4><ul class="stations-list">`;
                category.stations.forEach(station => {
                    stationsHTML += `<li>${station}</li>`;
                });
                stationsHTML += `</ul>`;
            }
            
            let servicesHTML = '';
            if (category.services && category.services.length > 0) {
                servicesHTML = `<h4>Expected Services:</h4><ul class="services-list">`;
                category.services.forEach(service => {
                    servicesHTML += `<li>${service}</li>`;
                });
                servicesHTML += `</ul>`;
            }
            
            let phrasesHTML = '';
            if (category.phrases && category.phrases.length > 0) {
                phrasesHTML = `<h4>Key Exam Phrases:</h4><ul class="phrases-list">`;
                category.phrases.forEach(phrase => {
                    phrasesHTML += `<li>${phrase}</li>`;
                });
                phrasesHTML += `</ul>`;
            }
            
            categoryContent.innerHTML = `
                <p>${getCategoryDescription(category.id)}</p>
                ${stationsHTML}
                ${servicesHTML}
                ${phrasesHTML}
                
                <div class="exam-tip">
                    <strong>EXAM TIP:</strong> You don't need to list all services. Name 1-2 appropriate teams and explain why their involvement improves safety or care.
                </div>
            `;
        }
        
        // Get description for each category
        function getCategoryDescription(id) {
            const descriptions = [
                "Presentations with potential serious pathology requiring urgent assessment. Focus on recognizing red flags and initiating appropriate urgent pathways.",
                "Long-term conditions requiring ongoing management, self-care support, and multidisciplinary input to prevent complications and admissions.",
                "Psychological distress, mental illness, or behavioral issues in adults. Focus on combining medical management with psychological support.",
                "Mental health issues in children and adolescents requiring age-appropriate services. Always consider safeguarding alongside psychological needs.",
                "Situations where patients or others are at risk of harm. Focus on protective, supportive approach while fulfilling mandatory responsibilities.",
                "Pregnancy-related issues and women's health concerns. Early multidisciplinary involvement improves outcomes significantly.",
                "Physical health issues in children. Always consider family context and developmental stage in management.",
                "Care for patients with advanced, life-limiting illness. Focus shifts to quality of life, symptom control, and patient preferences.",
                "Non-medical factors affecting health - housing, finances, work, caring responsibilities. Addressing these improves medical outcomes.",
                "Sensitive issues requiring confidentiality and specialist expertise. Sexual health services operate with separate, confidential records."
            ];
            
            return descriptions[id-1] || "This category covers key psychosocial aspects of patient care in general practice.";
        }
        
        // Render quick reference cards
        function renderQuickReference() {
            const quickReference = document.getElementById('quickReference');
            quickReference.innerHTML = '';
            
            const quickCategories = [
                { icon: "ðŸ’¡", title: "Social Prescriber", desc: "Ace in the hole for non-medical issues: isolation, debt, housing, benefits" },
                { icon: "ðŸ§ ", title: "IAPT / Talking Therapies", desc: "Mild-moderate anxiety/depression. CBT gives practical coping skills" },
                { icon: "ðŸ›¡ï¸", title: "Safeguarding", desc: "Mandatory for risk to children/vulnerable adults. Frame as support, not policing" },
                { icon: "ðŸ¥", title: "EPAU", desc: "Early Pregnancy Assessment Unit - urgent referral for bleeding in pregnancy" },
                { icon: "ðŸ‘µ", title: "Memory Clinic", desc: "Refer even with normal screening if clinical suspicion of dementia" },
                { icon: "ðŸ’¼", title: "Occupational Health", desc: "For work-related issues. Fit notes with amended duties better than complete sick leave" },
                { icon: "ðŸ ", title: "District Nurses", desc: "Wound care, palliative support, insulin administration for visually impaired" },
                { icon: "ðŸŽ“", title: "School Nurse", desc: "Bridges health and education for children. Discreet support in school environment" }
            ];
            
            quickCategories.forEach(item => {
                const card = document.createElement('div');
                card.className = 'reference-card';
                card.innerHTML = `
                    <h4><span>${item.icon}</span> ${item.title}</h4>
                    <p>${item.desc}</p>
                `;
                quickReference.appendChild(card);
            });
        }
        
        // Render trigger-service pairs
        function renderTriggers() {
            const triggersList = document.getElementById('triggersList');
            triggersList.innerHTML = '';
            
            // Combine all triggers from all categories
            let allTriggers = [];
            categories.forEach(category => {
                if (category.triggers) {
                    category.triggers.forEach(trigger => {
                        allTriggers.push({
                            ...trigger,
                            category: category.name,
                            icon: category.icon
                        });
                    });
                }
            });
            
            // Render each trigger
            allTriggers.forEach(trigger => {
                const item = document.createElement('div');
                item.className = 'trigger-item';
                item.innerHTML = `
                    <div class="trigger-title">
                        <span>${trigger.icon} ${trigger.trigger}</span>
                        <span style="font-size: 0.85rem; color: #666;">${trigger.category}</span>
                    </div>
                    <div class="trigger-services">
                        <strong>Expected services:</strong> ${trigger.services}
                    </div>
                `;
                
                triggersList.appendChild(item);
            });
        }
        
        // Render high-scoring phrases
        function renderPhrases() {
            const phrasesList = document.getElementById('phrasesList');
            phrasesList.innerHTML = '';
            
            highScoringPhrases.forEach((phrase, index) => {
                const item = document.createElement('div');
                item.className = 'info-card';
                item.innerHTML = `
                    <h4>${index + 1}. ${phrase.title}</h4>
                    <div class="key-phrase">${phrase.phrase}</div>
                    <p><strong>Why it works:</strong> ${phrase.tip}</p>
                `;
                
                phrasesList.appendChild(item);
            });
        }
        
        // Tab switching functionality
        function switchTab(tabName) {
            // Update tab UI
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.tab === tabName) {
                    tab.classList.add('active');
                }
            });
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.id === `${tabName}Tab`) {
                    content.classList.add('active');
                }
            });
        }
        
        // Toggle answer visibility in practice scenarios
        function toggleAnswer(answerId) {
            const answerElement = document.getElementById(answerId);
            answerElement.classList.toggle('hidden');
            
            const button = answerElement.previousElementSibling;
            if (answerElement.classList.contains('hidden')) {
                button.textContent = 'Show Approach';
            } else {
                button.textContent = 'Hide Approach';
            }
        }
        
        // Generate random scenario
        function generateRandomScenario() {
            const randomIndex = Math.floor(Math.random() * practiceScenarios.length);
            const scenario = practiceScenarios[randomIndex];
            
            const newScenarioHTML = `
                <div class="scenario">
                    <h4>${scenario.title}</h4>
                    <p>${scenario.content}</p>
                    
                    <div class="hidden">
                        <div class="key-phrase">
                            <strong>Biopsychosocial Approach:</strong>
                        </div>
                        
                        <h5>Expected Services:</h5>
                        <ul class="services-list">
                            <li><span class="highlight">Medical:</span> ${scenario.answer.medical}</li>
                            <li><span class="highlight">Psychological:</span> ${scenario.answer.psychological}</li>
                            <li><span class="highlight">Social:</span> ${scenario.answer.social}</li>
                        </ul>
                        
                        <p><strong>Exam focus:</strong> Link the social/psychological factors directly to the medical presentation and offer patient-centered solutions.</p>
                    </div>
                    
                    <button class="btn" onclick="toggleAnswer(this)">Show Approach</button>
                </div>
            `;
            
            // Add to practice tab
            const practiceTab = document.getElementById('practiceTab');
            const firstScenario = practiceTab.querySelector('.scenario');
            if (firstScenario) {
                practiceTab.insertBefore(createElementFromHTML(newScenarioHTML), firstScenario);
            }
        }
        
        // Helper to create element from HTML string
        function createElementFromHTML(htmlString) {
            const div = document.createElement('div');
            div.innerHTML = htmlString.trim();
            return div.firstChild;
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Tab switching
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.dataset.tab;
                    switchTab(tabName);
                });
            });
            
            // Search functionality
            document.getElementById('searchBox').addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                
                if (searchTerm.length < 2) return;
                
                // Search in current tab
                const activeTab = document.querySelector('.tab-content.active');
                
                if (activeTab.id === 'overviewTab') {
                    // Search in categories
                    const categories = document.querySelectorAll('.category-item');
                    categories.forEach(cat => {
                        const text = cat.textContent.toLowerCase();
                        if (text.includes(searchTerm)) {
                            cat.style.backgroundColor = '#fff9c4';
                        } else {
                            cat.style.backgroundColor = '';
                        }
                    });
                } else if (activeTab.id === 'triggersTab') {
                    // Search in triggers
                    const triggers = document.querySelectorAll('.trigger-item');
                    triggers.forEach(trigger => {
                        const text = trigger.textContent.toLowerCase();
                        if (text.includes(searchTerm)) {
                            trigger.style.backgroundColor = '#fff9c4';
                        } else {
                            trigger.style.backgroundColor = '';
                        }
                    });
                }
            });
            
            // Random scenario button
            document.getElementById('randomScenarioBtn').addEventListener('click', function() {
                switchTab('practice');
                generateRandomScenario();
            });
            
            // New scenario button
            document.getElementById('newScenarioBtn').addEventListener('click', generateRandomScenario);
            
            // Quick check button
            document.getElementById('quickCheckBtn').addEventListener('click', function() {
                alert("10-SECOND END-OF-STATION CHECK:\n\n1. MEDICAL - Who treats the disease?\n2. PSYCHOLOGICAL - Who supports coping/behavior?\n3. SOCIAL - Who helps them function safely?\n\nIf you can name ONE service/team for EACH, you pass the biopsychosocial domain!");
            });
        }
    </script>
</body>
</html>