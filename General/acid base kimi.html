<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acid-Base & Electrolyte Disorders - Interactive Algorithm</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            min-height: 100vh;
        }

        /* Sidebar Progress Tracker */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 2rem 1rem;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .sidebar h2 {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .progress-item {
            display: flex;
            align-items: center;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            opacity: 0.6;
        }

        .progress-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            opacity: 1;
            transform: translateX(5px);
        }

        .progress-item.completed {
            opacity: 1;
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
        }

        .progress-item i {
            margin-right: 0.8rem;
            font-size: 1.2rem;
        }

        .progress-bar {
            height: 4px;
            background: #e0e0e0;
            border-radius: 2px;
            margin: 1.5rem 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .header {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
            font-size: 2.2rem;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        /* Card Styles */
        .card-section {
            margin-bottom: 2.5rem;
            scroll-margin-top: 2rem;
        }

        .card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .card-header {
            padding: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .card-header.assessment {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .card-header.diagnosis {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
        }

        .card-header.treatment {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
        }

        .card-header.followup {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
        }

        .card-header:hover {
            filter: brightness(110%);
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .card-title i {
            font-size: 1.5rem;
        }

        .expand-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .card-header.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, padding 0.4s ease;
        }

        .card-content.expanded {
            max-height: 2000px;
            padding: 1.5rem;
        }

        .subsection {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #ecf0f1;
        }

        .subsection:last-child {
            border-bottom: none;
        }

        .subsection h3 {
            color: #2c3e50;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 0.2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .badge-urgent {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .badge-caution {
            background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
            color: #2c3e50;
        }

        .badge-stable {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
        }

        .badge-info {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .condition-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .condition-item {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        .condition-item h4 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .condition-item p {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 0.5rem;
        }

        .alert-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .alert-box i {
            color: #f39c12;
            margin-top: 2px;
        }

        .emergency-box {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .emergency-box i {
            color: #e74c3c;
            margin-top: 2px;
        }

        .abg-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .abg-table th,
        .abg-table td {
            padding: 0.8rem;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .abg-table th {
            background: #3498db;
            color: white;
            font-weight: 600;
        }

        .abg-table tr:hover {
            background: #f8f9fa;
        }

        .button-group {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
            color: #2c3e50;
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                position: static;
                transform: translateY(-100%);
            }

            .sidebar.mobile-open {
                transform: translateY(0);
            }

            .main-content {
                padding: 1rem;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .condition-grid {
                grid-template-columns: 1fr;
            }
        }

        .floating-menu {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .menu-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        .menu-toggle:hover {
            transform: scale(1.1);
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .highlight {
            background: #fff3cd;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-weight: 600;
        }

        .calc-input {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            margin: 0.5rem 0;
        }

        .calc-input input {
            padding: 0.5rem;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            width: 80px;
            text-align: center;
            font-weight: 600;
        }

        .calc-result {
            background: #e8f5e9;
            padding: 0.5rem;
            border-radius: 4px;
            margin-top: 0.5rem;
            font-weight: 600;
            color: #2e7d32;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sticky Progress Sidebar -->
        <aside class="sidebar" id="sidebar">
            <h2><i class="fas fa-tasks"></i> Algorithm Progress</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-item active" data-section="assessment" onclick="scrollToSection('assessment')">
                <i class="fas fa-stethoscope"></i>
                <span>Initial Assessment</span>
            </div>
            <div class="progress-item" data-section="diagnosis" onclick="scrollToSection('diagnosis')">
                <i class="fas fa-microscope"></i>
                <span>Differential Diagnosis</span>
            </div>
            <div class="progress-item" data-section="treatment" onclick="scrollToSection('treatment')">
                <i class="fas fa-heartbeat"></i>
                <span>Management</span>
            </div>
            <div class="progress-item" data-section="followup" onclick="scrollToSection('followup')">
                <i class="fas fa-user-check"></i>
                <span>Monitoring & Follow-up</span>
            </div>
            <div class="progress-item" data-section="calculators" onclick="scrollToSection('calculators')">
                <i class="fas fa-calculator"></i>
                <span>Calculators</span>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <div class="header">
                <h1><i class="fas fa-flask"></i> Acid-Base & Electrolyte Disorders</h1>
                <p>Interactive Clinical Decision Support Algorithm | BMJ Best Practice</p>
            </div>

            <!-- Assessment Section -->
            <section class="card-section" id="assessment">
                <div class="card fade-in">
                    <div class="card-header assessment" onclick="toggleCard(this)">
                        <div class="card-title">
                            <i class="fas fa-stethoscope"></i>
                            Initial Assessment & Red Flags
                        </div>
                        <i class="fas fa-chevron-down expand-icon"></i>
                    </div>
                    <div class="card-content">
                        <div class="subsection">
                            <h3><i class="fas fa-clipboard-list"></i> Focused History</h3>
                            <div class="condition-grid">
                                <div class="condition-item">
                                    <h4>Respiratory Symptoms</h4>
                                    <p>Dyspnea, Kussmaul breathing, hyperventilation, accessory muscle use</p>
                                    <span class="badge badge-caution"><i class="fas fa-exclamation-triangle"></i> Assess Urgency</span>
                                </div>
                                <div class="condition-item">
                                    <h4>GI Symptoms</h4>
                                    <p>Vomiting, diarrhea, nausea, abdominal pain</p>
                                    <span class="badge badge-info"><i class="fas fa-info-circle"></i> Volume Status</span>
                                </div>
                                <div class="condition-item">
                                    <h4>Neurologic Symptoms</h4>
                                    <p>Confusion, lethargy, seizures, tetany, paresthesia</p>
                                    <span class="badge badge-urgent"><i class="fas fa-bell"></i> Severe</span>
                                </div>
                                <div class="condition-item">
                                    <h4>Cardiac Symptoms</h4>
                                    <p>Palpitations, arrhythmias, weakness, fatigue</p>
                                    <span class="badge badge-urgent"><i class="fas fa-heartbeat"></i> ECG Urgent</span>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-pills"></i> Medication & Risk Factor Review</h3>
                            <div class="button-group">
                                <button class="btn btn-warning" onclick="highlightText('diuretics')">
                                    <i class="fas fa-water"></i> Diuretics
                                </button>
                                <button class="btn btn-warning" onclick="highlightText('ace-inhibitors')">
                                    <i class="fas fa-heart"></i> ACE Inhibitors
                                </button>
                                <button class="btn btn-warning" onclick="highlightText('nsaids')">
                                    <i class="fas fa-pills"></i> NSAIDs
                                </button>
                                <button class="btn btn-danger" onclick="highlightText('metformin')">
                                    <i class="fas fa-syringe"></i> Metformin
                                </button>
                            </div>
                            <p class="mt-2">Key risk factors: CKD, diabetes, COPD, heart failure, malignancy, alcohol use</p>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-exclamation-triangle"></i> Critical Red Flags - Immediate Action Required</h3>
                            <div class="emergency-box">
                                <i class="fas fa-ambulance"></i>
                                <div>
                                    <strong>Severe Hyperkalemia >6.0 mmol/L:</strong> Risk of ventricular fibrillation. Obtain ECG immediately.
                                    <div class="badge badge-urgent">EMERGENCY</div>
                                </div>
                            </div>
                            <div class="emergency-box">
                                <i class="fas fa-brain"></i>
                                <div>
                                    <strong>Severe Hyponatremia <120 mmol/L:</strong> Risk of cerebral edema, seizures, coma.
                                    <div class="badge badge-urgent">EMERGENCY</div>
                                </div>
                            </div>
                            <div class="emergency-box">
                                <i class="fas fa-lungs"></i>
                                <div>
                                    <strong>Severe Metabolic Acidosis pH <7.0:</strong> Hemodynamic instability, Kussmaul breathing.
                                    <div class="badge badge-urgent">CRITICAL</div>
                                </div>
                            </div>
                            <div class="emergency-box">
                                <i class="fas fa-tint"></i>
                                <div>
                                    <strong>Severe Hypercalcemia >3.2 mmol/L:</strong> Dehydration, confusion, cardiac arrest risk.
                                    <div class="badge badge-urgent">URGENT</div>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-vial"></i> Initial Laboratory Workup</h3>
                            <table class="abg-table">
                                <thead>
                                    <tr>
                                        <th>Test</th>
                                        <th>Critical Values</th>
                                        <th>Timeline</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Arterial Blood Gas</td>
                                        <td>pH <7.2 or >7.6</td>
                                        <td>Stat</td>
                                    </tr>
                                    <tr>
                                        <td>Serum Electrolytes</td>
                                        <td>K <2.5 or >6.0, Na <120 or >155</td>
                                        <td>Within 1 hour</td>
                                    </tr>
                                    <tr>
                                        <td>BMP/CMP</td>
                                        <td>Creatinine, glucose</td>
                                        <td>Within 2 hours</td>
                                    </tr>
                                    <tr>
                                        <td>ECG</td>
                                        <td>If K >5.5 or symptomatic</td>
                                        <td>Immediate</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Diagnosis Section -->
            <section class="card-section" id="diagnosis">
                <div class="card fade-in">
                    <div class="card-header diagnosis" onclick="toggleCard(this)">
                        <div class="card-title">
                            <i class="fas fa-microscope"></i>
                            Diagnostic Approach & ABG Interpretation
                        </div>
                        <i class="fas fa-chevron-down expand-icon"></i>
                    </div>
                    <div class="card-content">
                        <div class="subsection">
                            <h3><i class="fas fa-calculator"></i> Stepwise ABG Interpretation</h3>
                            <div class="condition-grid">
                                <div class="condition-item">
                                    <h4>Step 1: pH Assessment</h4>
                                    <p><strong>Normal:</strong> 7.35-7.45</p>
                                    <p><strong>Acidosis:</strong> <7.35</p>
                                    <p><strong>Alkalosis:</strong> >7.45</p>
                                    <span class="badge badge-info">Start Here</span>
                                </div>
                                <div class="condition-item">
                                    <h4>Step 2: CO₂ Direction</h4>
                                    <p>CO₂ <35: Respiratory alkalosis</p>
                                    <p>CO₂ 35-45: Normal</p>
                                    <p>CO₂ >45: Respiratory acidosis</p>
                                    <span class="badge badge-caution">Check Compensation</span>
                                </div>
                                <div class="condition-item">
                                    <h4>Step 3: HCO₃ Direction</h4>
                                    <p>HCO₃ <22: Metabolic acidosis</p>
                                    <p>HCO₃ 22-28: Normal</p>
                                    <p>HCO₃ >28: Metabolic alkalosis</p>
                                    <span class="badge badge-caution">Match pH</span>
                                </div>
                                <div class="condition-item">
                                    <h4>Step 4: Anion Gap</h4>
                                    <p>AG = Na - (Cl + HCO₃)</p>
                                    <p>Normal: 6-12 mmol/L</p>
                                    <p>High: >12 mmol/L</p>
                                    <span class="badge badge-info">For Metabolic Acidosis</span>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-cogs"></i> Compensation Rules</h3>
                            <table class="abg-table">
                                <thead>
                                    <tr>
                                        <th>Primary Disorder</th>
                                        <th>Expected Compensation</th>
                                        <th>Formula</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Metabolic Acidosis</td>
                                        <td>↓ PCO₂</td>
                                        <td>PCO₂ = 1.5 × HCO₃ + 8 (±2)</td>
                                    </tr>
                                    <tr>
                                        <td>Metabolic Alkalosis</td>
                                        <td>↑ PCO₂</td>
                                        <td>PCO₂ ↑ 0.7 per 1 ↑ HCO₃ (max 55)</td>
                                    </tr>
                                    <tr>
                                        <td>Respiratory Acidosis</td>
                                        <td>↑ HCO₃</td>
                                        <td>Acute: ↑1 per 10 ↑CO₂; Chronic: ↑3.5 per 10 ↑CO₂</td>
                                    </tr>
                                    <tr>
                                        <td>Respiratory Alkalosis</td>
                                        <td>↓ HCO₃</td>
                                        <td>Acute: ↓2 per 10 ↓CO₂; Chronic: ↓4 per 10 ↓CO₂</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-chart-line"></i> Disorder Differentiation</h3>
                            <div class="condition-grid">
                                <div class="condition-item">
                                    <h4>High Anion Gap Metabolic Acidosis</h4>
                                    <p><strong>MUDPILES:</strong></p>
                                    <p>• Methanol, Metformin</p>
                                    <p>• Uremia</p>
                                    <p>• DKA, Alcoholic KA</p>
                                    <p>• Paracetamol, Paraldehyde</p>
                                    <p>• Iron, Isoniazid</p>
                                    <p>• Lactic acidosis</p>
                                    <p>• Ethylene glycol</p>
                                    <p>• Salicylates</p>
                                    <span class="badge badge-urgent">Check Osmolar Gap</span>
                                </div>
                                <div class="condition-item">
                                    <h4>Normal Anion Gap Metabolic Acidosis</h4>
                                    <p><strong>HARDUP:</strong></p>
                                    <p>• Hyperchloremia</p>
                                    <p>• Acetazolamide</p>
                                    <p>• Renal Tubular Acidosis</p>
                                    <p>• Diarrhea</p>
                                    <p>• Ureteroenterostomy</p>
                                    <p>• Pancreatic fistula</p>
                                    <span class="badge badge-caution">Check Urine AG</span>
                                </div>
                                <div class="condition-item">
                                    <h4>Metabolic Alkalosis</h4>
                                    <p><strong>Saline Responsive:</strong></p>
                                    <p>• Vomiting, NG suction</p>
                                    <p>• Diuretics</p>
                                    <p>• Post-hypercapnia</p>
                                    <p><strong>Saline Resistant:</strong></p>
                                    <p>• Hyperaldosteronism</p>
                                    <p>• Severe K/Mg deficiency</p>
                                    <span class="badge badge-info">Urine Cl <25 vs >40</span>
                                </div>
                                <div class="condition-item">
                                    <h4>Respiratory Disorders</h4>
                                    <p><strong>Acidosis:</strong></p>
                                    <p>• COPD exacerbation</p>
                                    <p>• Opioid overdose</p>
                                    <p>• Neuromuscular weakness</p>
                                    <p><strong>Alkalosis:</strong></p>
                                    <p>• Pulmonary embolism</p>
                                    <p>• Sepsis, anxiety</p>
                                    <p>• Pregnancy, altitude</p>
                                    <span class="badge badge-caution">Check A-a gradient</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Treatment Section -->
            <section class="card-section" id="treatment">
                <div class="card fade-in">
                    <div class="card-header treatment" onclick="toggleCard(this)">
                        <div class="card-title">
                            <i class="fas fa-heartbeat"></i>
                            Management Protocols & Treatment
                        </div>
                        <i class="fas fa-chevron-down expand-icon"></i>
                    </div>
                    <div class="card-content">
                        <div class="subsection">
                            <h3><i class="fas fa-bolt"></i> Emergency Interventions</h3>
                            
                            <div class="condition-grid">
                                <div class="condition-item">
                                    <h4>Severe Hyperkalemia >6.0 or ECG Changes</h4>
                                    <span class="badge badge-urgent">STAT</span>
                                    <ul style="margin-top: 0.5rem;">
                                        <li>Calcium gluconate 10%: 10 mL IV over 2 min (stabilize membrane)</li>
                                        <li>Insulin 10 units + 50 mL D50W (shift K intracellular)</li>
                                        <li>Sodium bicarbonate if pH <7.2</li>
                                        <li>Beta-agonist (albuterol 10-20 mg nebulized)</li>
                                        <li>Furosemide 20-40 mg IV (enhance excretion)</li>
                                    </ul>
                                </div>
                                <div class="condition-item">
                                    <h4>Severe Hyponatremia <120 with Symptoms</h4>
                                    <span class="badge badge-urgent">3% Saline</span>
                                    <ul style="margin-top: 0.5rem;">
                                        <li>3% saline 100 mL IV over 10 min (repeat x2 if needed)</li>
                                        <li>Target: ↑Na 4-6 mmol/L in first 6 hours</li>
                                        <li>Limit total increase to <8 mmol/L/24h</li>
                                        <li>Check Na q2h initially</li>
                                    </ul>
                                </div>
                                <div class="condition-item">
                                    <h4>DKA Management</h4>
                                    <span class="badge badge-urgent">IV Fluids</span>
                                    <ul style="margin-top: 0.5rem;">
                                        <li>Fluid: 1L NS over 1h, then 500 mL/h</li>
                                        <li>Insulin: 0.1 U/kg/h IV after K >3.3</li>
                                        <li>K: Add 20-30 mmol/L when <5.5</li>
                                        <li>Bicarbonate: Only if pH <7.0</li>
                                    </ul>
                                </div>
                                <div class="condition-item">
                                    <h4>HHS Management</h4>
                                    <span class="badge badge-urgent">Slow Correction</span>
                                    <ul style="margin-top: 0.5rem;">
                                        <li>Fluid: 1L NS over 1h, then 250-500 mL/h</li>
                                        <li>Glucose target: ↓3-4 mmol/L/h</li>
                                        <li>Osmolality target: ↓<3 mOsm/kg/h</li>
                                        <li>Anticoagulation: Consider prophylaxis</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-prescription-bottle-alt"></i> Electrolyte Replacement Protocols</h3>
                            <table class="abg-table">
                                <thead>
                                    <tr>
                                        <th>Electrolyte</th>
                                        <th>Replacement</th>
                                        <th>Monitoring</th>
                                        <th>Rate</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Potassium</td>
                                        <td>KCl IV/PO</td>
                                        <td>q2-4h</td>
                                        <td>Max 20 mmol/h (peripheral)</td>
                                    </tr>
                                    <tr>
                                        <td>Magnesium</td>
                                        <td>MgSO₄ 2g IV</td>
                                        <td>Symptoms, Mg level</td>
                                        <td>Over 15 min (emergency)</td>
                                    </tr>
                                    <tr>
                                        <td>Calcium</td>
                                        <td>Ca gluconate 1-2g IV</td>
                                        <td>QT interval</td>
                                        <td>Over 10-20 min</td>
                                    </tr>
                                    <tr>
                                        <td>Phosphate</td>
                                        <td>KPhos 15 mmol IV</td>
                                        <td>Ca, PO₄ levels</td>
                                        <td>Over 4-6 hours</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-tint"></i> Fluid Management</h3>
                            <div class="condition-grid">
                                <div class="condition-item">
                                    <h4>Hypovolemic Hyponatremia</h4>
                                    <span class="badge badge-stable">NS 0.9%</span>
                                    <p>Replace volume with isotonic saline. Once euvolemic, manage free water intake.</p>
                                </div>
                                <div class="condition-item">
                                    <h4>Euvolemic Hyponatremia</h4>
                                    <span class="badge badge-caution">Fluid Restriction</span>
                                    <p>Restrict fluids to 800-1000 mL/day. Consider vaptans if severe.</p>
                                </div>
                                <div class="condition-item">
                                    <h4>Hypervolemic Hyponatremia</h4>
                                    <span class="badge badge-caution">Diuretics</span>
                                    <p>Loop diuretics + salt restriction. Treat underlying cause (CHF, cirrhosis).</p>
                                </div>
                                <div class="condition-item">
                                    <h4>Hypernatremia</h4>
                                    <span class="badge badge-caution">Hypotonic Fluids</span>
                                    <p>D5W or 0.45% NS. Target ↓Na <0.5 mmol/L/h to prevent cerebral edema.</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-lungs"></i> Respiratory Disorder Management</h3>
                            <div class="condition-grid">
                                <div class="condition-item">
                                    <h4>Respiratory Acidosis</h4>
                                    <span class="badge badge-caution">↑Ventilation</span>
                                    <p>• Treat underlying cause (COPD, opioids)</p>
                                    <p>• Non-invasive ventilation if severe</p>
                                    <p>• Avoid excessive O₂ in COPD</p>
                                </div>
                                <div class="condition-item">
                                    <h4>Respiratory Alkalosis</h4>
                                    <span class="badge badge-stable">↓Ventilation</span>
                                    <p>• Treat anxiety, pain, fever</p>
                                    <p>• Manage PE, sepsis, hypoxia</p>
                                    <p>• Rebreathing bag if severe</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Follow-up Section -->
            <section class="card-section" id="followup">
                <div class="card fade-in">
                    <div class="card-header followup" onclick="toggleCard(this)">
                        <div class="card-title">
                            <i class="fas fa-user-check"></i>
                            Monitoring, Follow-up & Prevention
                        </div>
                        <i class="fas fa-chevron-down expand-icon"></i>
                    </div>
                    <div class="card-content">
                        <div class="subsection">
                            <h3><i class="fas fa-chart-line"></i> Monitoring Frequency</h3>
                            <table class="abg-table">
                                <thead>
                                    <tr>
                                        <th>Disorder Severity</th>
                                        <th>Electrolytes</th>
                                        <th>ABG</th>
                                        <th>Clinical Review</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Severe (ICU)</td>
                                        <td>q2-4h</td>
                                        <td>q4-6h</td>
                                        <td>Continuous</td>
                                    </tr>
                                    <tr>
                                        <td>Moderate (Inpatient)</td>
                                        <td>q6-12h</td>
                                        <td>q12-24h</td>
                                        <td>q4-6h</td>
                                    </tr>
                                    <tr>
                                        <td>Mild (Stable)</td>
                                        <td>Daily</td>
                                        <td>PRN</td>
                                        <td>q8-12h</td>
                                    </tr>
                                    <tr>
                                        <td>Outpatient</td>
                                        <td>3-7 days</td>
                                        <td>PRN</td>
                                        <td>1-2 weeks</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-user-md"></i> Referral Criteria</h3>
                            <div class="condition-grid">
                                <div class="condition-item">
                                    <h4>Endocrinology</h4>
                                    <span class="badge badge-caution">DKA/HHS</span>
                                    <p>• Recurrent DKA</p>
                                    <p>• HHS requiring insulin</p>
                                    <p>• Adrenal insufficiency</p>
                                    <p>• Primary hyperparathyroidism</p>
                                </div>
                                <div class="condition-item">
                                    <h4>Nephrology</h4>
                                    <span class="badge badge-caution">Dialysis</span>
                                    <p>• AKI requiring RRT</p>
                                    <p>• Severe RTA</p>
                                    <p>• Refractory electrolyte disorders</p>
                                    <p>• CKD Stage 4+</p>
                                </div>
                                <div class="condition-item">
                                    <h4>ICU</h4>
                                    <span class="badge badge-urgent"> unstable</span>
                                    <p>• pH <7.1</p>
                                    <p>• K >6.5 or <2.5</p>
                                    <p>• Hemodynamic instability</p>
                                    <p>• Altered mental status</p>
                                </div>
                                <div class="condition-item">
                                    <h4>Dietary</h4>
                                    <span class="badge badge-stable">Education</span>
                                    <p>• Chronic potassium issues</p>
                                    <p>• Sodium restrictions</p>
                                    <p>• Magnesium deficiency</p>
                                    <p>• Fluid management</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-shield-alt"></i> Prevention Strategies</h3>
                            <div class="alert-box">
                                <i class="fas fa-lightbulb"></i>
                                <div>
                                    <strong>Iatrogenic Prevention:</strong> 40% of hospital electrolyte disturbances are preventable. Key measures include:
                                </div>
                            </div>
                            <div class="condition-grid">
                                <div class="condition-item">
                                    <h4>Fluid Prescribing</h4>
                                    <span class="badge badge-stable">0.9% NS Default</span>
                                    <p>Avoid hypotonic fluids in elderly, post-op patients. Use isotonic saline as default maintenance.</p>
                                </div>
                                <div class="condition-item">
                                    <h4>Medication Review</h4>
                                    <span class="badge badge-caution">High-Risk Drugs</span>
                                    <p>Diuretics, ACE-I, ARBs, NSAIDs, metformin (eGFR <30). Check renal function regularly.</p>
                                </div>
                                <div class="condition-item">
                                    <h4>Monitoring Protocols</h4>
                                    <span class="badge badge-info">EHR Alerts</span>
                                    <p>Automatic electrolyte checks for high-risk patients after medication changes or procedures.</p>
                                </div>
                                <div class="condition-item">
                                    <h4>Patient Education</h4>
                                    <span class="badge badge-stable">Discharge Planning</span>
                                    <p>Dietary counseling, medication adherence, warning signs, follow-up scheduling.</p>
                                </div>
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-pills"></i> Medication Adjustment Protocols</h3>
                            <table class="abg-table">
                                <thead>
                                    <tr>
                                        <th>Drug Class</th>
                                        <th>When to Hold</th>
                                        <th>When to Restart</th>
                                        <th>Monitoring</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>ACE-I/ARB</td>
                                        <td>K >5.5, AKI, dehydration</td>
                                        <td>K <5.0, stable renal function</td>
                                        <td>K, creatinine q3-5d</td>
                                    </tr>
                                    <tr>
                                        <td>Diuretics</td>
                                        <td>Na <130, hypotension</td>
                                        <td>Na >135, euvolemic</td>
                                        <td>Daily weights, BP, electrolytes</td>
                                    </tr>
                                    <tr>
                                        <td>Metformin</td>
                                        <td>eGFR <30, contrast, DKA risk</td>
                                        <td>eGFR stable >45, no AKI</td>
                                        <td>eGFR annually</td>
                                    </tr>
                                    <tr>
                                        <td>Digoxin</td>
                                        <td>K <3.5, K >5.5, AKI</td>
                                        <td>K 4.0-5.0, stable renal function</td>
                                        <td>Digoxin level, K, ECG</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Calculators Section -->
            <section class="card-section" id="calculators">
                <div class="card fade-in">
                    <div class="card-header diagnosis" onclick="toggleCard(this)">
                        <div class="card-title">
                            <i class="fas fa-calculator"></i>
                            Interactive Clinical Calculators
                        </div>
                        <i class="fas fa-chevron-down expand-icon"></i>
                    </div>
                    <div class="card-content">
                        <div class="subsection">
                            <h3><i class="fas fa-calculator"></i> Anion Gap Calculator</h3>
                            <div class="calc-input">
                                <label>Na:</label>
                                <input type="number" id="na" placeholder="140" oninput="calculateAG()">
                                <label>Cl:</label>
                                <input type="number" id="cl" placeholder="105" oninput="calculateAG()">
                                <label>HCO₃:</label>
                                <input type="number" id="hco3" placeholder="24" oninput="calculateAG()">
                            </div>
                            <div class="calc-result" id="agResult">
                                Anion Gap: -- mmol/L
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-water"></i> Sodium Correction in Hyperglycemia</h3>
                            <div class="calc-input">
                                <label>Measured Na:</label>
                                <input type="number" id="measuredNa" placeholder="130" oninput="correctNa()">
                                <label>Glucose:</label>
                                <input type="number" id="glucose" placeholder="20" oninput="correctNa()">
                                <label>mmol/L</label>
                            </div>
                            <div class="calc-result" id="correctedNaResult">
                                Corrected Na: -- mmol/L
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-tint"></i> Osmolar Gap Calculator</h3>
                            <div class="calc-input">
                                <label>Measured Osm:</label>
                                <input type="number" id="measuredOsm" placeholder="300" oninput="calculateOsmGap()">
                                <label>Na:</label>
                                <input type="number" id="osmNa" placeholder="140" oninput="calculateOsmGap()">
                                <label>Glucose:</label>
                                <input type="number" id="osmGlucose" placeholder="5" oninput="calculateOsmGap()">
                                <label>UREA:</label>
                                <input type="number" id="urea" placeholder="5" oninput="calculateOsmGap()">
                            </div>
                            <div class="calc-result" id="osmGapResult">
                                Osmolar Gap: -- mOsm/kg
                            </div>
                        </div>

                        <div class="subsection">
                            <h3><i class="fas fa-heartbeat"></i> A-a Gradient Calculator</h3>
                            <div class="calc-input">
                                <label>FiO₂:</label>
                                <input type="number" id="fio2" placeholder="21" oninput="calculateAA()">
                                <label>PaCO₂:</label>
                                <input type="number" id="paco2" placeholder="40" oninput="calculateAA()">
                                <label>PaO₂:</label>
                                <input type="number" id="pao2" placeholder="80" oninput="calculateAA()">
                            </div>
                            <div class="calc-result" id="aaResult">
                                A-a Gradient: -- mmHg (Normal: < age/4 + 4)
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <div style="height: 100px;"></div>
        </main>
    </div>

    <!-- Floating Mobile Menu -->
    <div class="floating-menu">
        <button class="menu-toggle" onclick="toggleMobileMenu()">
            <i class="fas fa-bars"></i>
        </button>
    </div>

    <script>
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            setupScrollListener();
            
            // Auto-expand first card
            const firstCard = document.querySelector('.card-header');
            if (firstCard) {
                setTimeout(() => toggleCard(firstCard), 500);
            }
        });

        // Card Toggle Function
        function toggleCard(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('.expand-icon');
            
            // Close all other cards
            document.querySelectorAll('.card-content').forEach(c => {
                if (c !== content) {
                    c.classList.remove('expanded');
                    c.previousElementSibling.classList.remove('expanded');
                }
            });
            
            // Toggle current card
            content.classList.toggle('expanded');
            header.classList.toggle('expanded');
            
            // Update progress
            updateProgress();
            
            // Scroll to card
            setTimeout(() => {
                header.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        // Scroll to Section
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                // Auto-expand card
                const cardHeader = section.querySelector('.card-header');
                if (cardHeader && !cardHeader.classList.contains('expanded')) {
                    setTimeout(() => toggleCard(cardHeader), 300);
                }
            }
            
            // Update active progress item
            document.querySelectorAll('.progress-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.section === sectionId) {
                    item.classList.add('active');
                }
            });
            
            // Close mobile menu
            document.getElementById('sidebar').classList.remove('mobile-open');
        }

        // Progress Tracker
        function updateProgress() {
            const sections = document.querySelectorAll('.card-section');
            const progressItems = document.querySelectorAll('.progress-item');
            const progressFill = document.getElementById('progressFill');
            
            let completed = 0;
            
            sections.forEach((section, index) => {
                const rect = section.getBoundingClientRect();
                const isVisible = rect.top < window.innerHeight * 0.5;
                
                if (isVisible) {
                    completed = index + 1;
                    progressItems.forEach((item, i) => {
                        item.classList.toggle('active', i === index);
                        item.classList.toggle('completed', i < index);
                    });
                }
            });
            
            const percentage = (completed / sections.length) * 100;
            progressFill.style.width = percentage + '%';
        }

        // Scroll Listener
        function setupScrollListener() {
            let ticking = false;
            
            function handleScroll() {
                if (!ticking) {
                    requestAnimationFrame(() => {
                        updateProgress();
                        ticking = false;
                    });
                    ticking = true;
                }
            }
            
            window.addEventListener('scroll', handleScroll);
        }

        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('mobile-open');
        }

        // Highlight Text
        function highlightText(type) {
            const cards = document.querySelectorAll('.card-content');
            cards.forEach(card => {
                const text = card.innerHTML;
                const regex = new RegExp(`\\b${type}\\b`, 'gi');
                card.innerHTML = text.replace(regex, `<span class="highlight">$&</span>`);
            });
            
            // Remove highlights after 3 seconds
            setTimeout(() => {
                document.querySelectorAll('.highlight').forEach(span => {
                    span.outerHTML = span.innerHTML;
                });
            }, 3000);
        }

        // Calculator Functions
        function calculateAG() {
            const na = parseFloat(document.getElementById('na').value) || 0;
            const cl = parseFloat(document.getElementById('cl').value) || 0;
            const hco3 = parseFloat(document.getElementById('hco3').value) || 0;
            
            const ag = na - (cl + hco3);
            const result = document.getElementById('agResult');
            
            if (na > 0 && cl > 0 && hco3 > 0) {
                let interpretation = '';
                if (ag > 12) interpretation = ' ↑ High AG metabolic acidosis';
                else if (ag >= 6) interpretation = ' Normal';
                else interpretation = ' ↓ Low AG';
                
                result.innerHTML = `Anion Gap: ${ag.toFixed(1)} mmol/L${interpretation}`;
                
                // Color code result
                if (ag > 12) result.style.background = '#f8d7da';
                else if (ag >= 6) result.style.background = '#e8f5e9';
                else result.style.background = '#fff3cd';
            } else {
                result.innerHTML = 'Anion Gap: -- mmol/L';
                result.style.background = '#e8f5e9';
            }
        }

        function correctNa() {
            const measuredNa = parseFloat(document.getElementById('measuredNa').value) || 0;
            const glucose = parseFloat(document.getElementById('glucose').value) || 0;
            const result = document.getElementById('correctedNaResult');
            
            // Corrected Na = Measured Na + 0.4 × (Glucose - 5.5)
            const correctedNa = measuredNa + 0.4 * (glucose - 5.5);
            
            if (measuredNa > 0 && glucose > 0) {
                result.innerHTML = `Corrected Na: ${correctedNa.toFixed(1)} mmol/L (for hyperglycemia)`;
            } else {
                result.innerHTML = 'Corrected Na: -- mmol/L';
            }
        }

        function calculateOsmGap() {
            const measuredOsm = parseFloat(document.getElementById('measuredOsm').value) || 0;
            const na = parseFloat(document.getElementById('osmNa').value) || 0;
            const glucose = parseFloat(document.getElementById('osmGlucose').value) || 0;
            const urea = parseFloat(document.getElementById('urea').value) || 0;
            
            // Calculated Osm = 2×Na + Glucose + Urea
            const calculatedOsm = 2 * na + glucose + urea;
            const osmGap = measuredOsm - calculatedOsm;
            const result = document.getElementById('osmGapResult');
            
            if (measuredOsm > 0 && na > 0) {
                let interpretation = '';
                if (osmGap > 10) interpretation = ' ↑ Toxic alcohol ingestion';
                else if (osmGap >= -5) interpretation = ' Normal';
                else interpretation = ' ↓ Calculation error';
                
                result.innerHTML = `Osmolar Gap: ${osmGap.toFixed(1)} mOsm/kg${interpretation}`;
                
                // Color code result
                if (osmGap > 10) result.style.background = '#f8d7da';
                else if (osmGap >= -5) result.style.background = '#e8f5e9';
                else result.style.background = '#fff3cd';
            } else {
                result.innerHTML = 'Osmolar Gap: -- mOsm/kg';
                result.style.background = '#e8f5e9';
            }
        }

        function calculateAA() {
            const fio2 = parseFloat(document.getElementById('fio2').value) || 21;
            const paco2 = parseFloat(document.getElementById('paco2').value) || 0;
            const pao2 = parseFloat(document.getElementById('pao2').value) || 0;
            
            // PAO2 = FiO2 × 7.5 - (PCO2 × 1.25)
            const pao2_calc = (fio2 * 7.5) - (paco2 * 1.25);
            const aa_gradient = pao2_calc - pao2;
            const result = document.getElementById('aaResult');
            
            if (paco2 > 0 && pao2 > 0) {
                result.innerHTML = `A-a Gradient: ${aa_gradient.toFixed(1)} mmHg (Normal: < age/4 + 4)`;
                
                // Color code result
                if (aa_gradient > 30) result.style.background = '#f8d7da';
                else if (aa_gradient > 15) result.style.background = '#fff3cd';
                else result.style.background = '#e8f5e9';
            } else {
                result.innerHTML = 'A-a Gradient: -- mmHg (Normal: < age/4 + 4)';
                result.style.background = '#e8f5e9';
            }
        }

        // Add fade-in animation to cards on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('fade-in');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.card').forEach(card => {
            observer.observe(card);
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowDown') {
                const currentActive = document.querySelector('.progress-item.active');
                const next = currentActive?.nextElementSibling;
                if (next && next.classList.contains('progress-item')) {
                    scrollToSection(next.dataset.section);
                }
            } else if (e.key === 'ArrowUp') {
                const currentActive = document.querySelector('.progress-item.active');
                const prev = currentActive?.previousElementSibling;
                if (prev && prev.classList.contains('progress-item')) {
                    scrollToSection(prev.dataset.section);
                }
            } else if (e.key === 'Home') {
                scrollToSection('assessment');
            } else if (e.key === 'End') {
                scrollToSection('calculators');
            }
        });

        // Store user preferences
        function savePreferences() {
            const expandedCards = Array.from(document.querySelectorAll('.card-header.expanded')).map(h => h.textContent.trim());
            localStorage.setItem('acidBaseExpandedCards', JSON.stringify(expandedCards));
        }

        // Load preferences on page load
        window.addEventListener('beforeunload', savePreferences);

        // Add print functionality
        function printAlgorithm() {
            window.print();
        }

        // Add button to header
        const printBtn = document.createElement('button');
        printBtn.className = 'btn btn-primary';
        printBtn.innerHTML = '<i class="fas fa-print"></i> Print Algorithm';
        printBtn.onclick = printAlgorithm;
        printBtn.style.marginLeft = '1rem';
        document.querySelector('.header').appendChild(printBtn);

        // Print styles
        const printStyles = `
            @media print {
                .sidebar, .floating-menu, .btn { display: none; }
                .main-content { padding: 0; }
                .card-content { max-height: none !important; }
                .card { page-break-inside: avoid; }
            }
        `;
        
        const styleSheet = document.createElement('style');
        styleSheet.textContent = printStyles;
        document.head.appendChild(styleSheet);
    </script>
</body>
</html>