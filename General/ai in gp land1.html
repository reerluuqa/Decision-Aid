<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI in GP Land: Opportunities & Risks</title>
    <style>
        :root {
            /* Base Dimensions */
            --sidebar-width: 320px;
            --header-height: 70px;
            
            /* Default Theme (Opportunities) */
            --primary: #0284c7; 
            --primary-dark: #0369a1;
            --secondary: #0ea5e9;
            --bg-body: #f1f5f9;
            --bg-card: #ffffff;
            --text-main: #0f172a;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --accent-glow: rgba(2, 132, 199, 0.1);
            --card-border-color: var(--secondary);
        }

        /* Risk Theme Overrides */
        body.theme-risks {
            --primary: #d97706; /* Amber/Orange */
            --primary-dark: #b45309;
            --secondary: #f59e0b;
            --accent-glow: rgba(217, 119, 6, 0.1);
            --card-border-color: var(--secondary);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s;
        }

        /* --- Layout --- */
        header {
            background-color: var(--bg-card);
            border-bottom: 1px solid var(--border);
            padding: 0 1.5rem;
            height: var(--header-height);
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 10;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--text-main);
        }

        .brand svg {
            width: 28px;
            height: 28px;
            color: var(--primary);
            transition: color 0.3s;
        }

        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* --- Sidebar Navigation --- */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--bg-card);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            flex-shrink: 0;
            transition: transform 0.3s ease;
        }

        .search-container {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            background: var(--bg-card);
            z-index: 5;
        }

        .search-input {
            width: 100%;
            padding: 0.6rem 1rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.9rem;
            background-color: var(--bg-body);
            transition: all 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px var(--accent-glow);
        }

        /* Category Tabs */
        .tabs {
            display: flex;
            padding: 0.5rem;
            border-bottom: 1px solid var(--border);
        }

        .tab-btn {
            flex: 1;
            padding: 0.5rem;
            text-align: center;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-muted);
            border-radius: 6px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .tab-btn.active {
            background-color: var(--bg-body);
            color: var(--primary);
            font-weight: 700;
        }

        .tab-btn:hover:not(.active) {
            background-color: #f8fafc;
        }

        .nav-list {
            list-style: none;
            padding: 1rem;
        }

        .nav-item {
            padding: 0.85rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            font-size: 0.9rem;
            color: var(--text-muted);
            border: 1px solid transparent;
        }

        .nav-item:hover {
            background-color: var(--bg-body);
            color: var(--primary);
        }

        .nav-item.active {
            background-color: var(--accent-glow);
            color: var(--primary-dark);
            border-color: var(--secondary);
            font-weight: 600;
        }

        .nav-icon {
            flex-shrink: 0;
            margin-top: 2px;
            width: 18px;
            height: 18px;
        }

        /* --- Content Area --- */
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        .content-wrapper {
            max-width: 900px;
            margin: 0 auto;
            padding-bottom: 4rem;
        }

        .hero-banner {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .category-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            background-color: var(--primary);
            color: white;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 1rem;
            transition: background-color 0.3s;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            line-height: 1.2;
            color: var(--text-main);
        }

        .summary-text {
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-muted);
            margin-bottom: 2rem;
            background: #fff;
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }

        h2 {
            font-size: 1.25rem;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-dark);
            transition: color 0.3s;
        }

        h2 svg {
            width: 24px;
            height: 24px;
        }

        .detail-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
        }

        .detail-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.05);
        }

        /* Left border color based on theme */
        .detail-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background-color: var(--card-border-color);
            transition: background-color 0.3s;
        }

        .detail-title {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-main);
        }

        .detail-desc {
            font-size: 0.95rem;
            line-height: 1.5;
            color: var(--text-muted);
        }

        /* --- Footer --- */
        .footer-info {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        /* --- Mobile Responsive --- */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-main);
        }

        @media (max-width: 768px) {
            .mobile-menu-btn { display: block; }
            .sidebar {
                position: absolute;
                left: 0; top: 0; bottom: 0;
                z-index: 100;
                transform: translateX(-100%);
                box-shadow: 4px 0 12px rgba(0,0,0,0.1);
            }
            .sidebar.open { transform: translateX(0); }
            .overlay {
                display: none; position: fixed; inset: 0;
                background: rgba(0,0,0,0.4); z-index: 90;
            }
            .overlay.active { display: block; }
            h1 { font-size: 1.5rem; }
            .hero-banner { height: 150px; }
            .content-area { padding: 1rem; }
        }

        /* --- Animations --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

    </style>
</head>
<body>

    <header>
        <div class="brand">
            <svg id="brandIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/></svg>
            AI in GP Land
        </div>
        <button class="mobile-menu-btn" id="menuBtn" aria-label="Toggle Menu">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" x2="21" y1="6" y2="6"/><line x1="3" x2="21" y1="12" y2="12"/><line x1="3" x2="21" y1="18" y2="18"/></svg>
        </button>
    </header>

    <div class="main-container">
        <div class="overlay" id="overlay"></div>

        <aside class="sidebar" id="sidebar">
            <div class="tabs">
                <div class="tab-btn active" id="tabOpp" onclick="switchCategory('opportunities')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                    Themes
                </div>
                <div class="tab-btn" id="tabRisk" onclick="switchCategory('risks')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>
                    Risks
                </div>
            </div>
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="Search...">
            </div>
            <ul class="nav-list" id="navList">
                <!-- Nav Items Injected JS -->
            </ul>
        </aside>

        <main class="content-area" id="contentArea">
            <!-- Content Injected JS -->
        </main>
    </div>

    <script>
        // --- Data Source: Opportunities ---
        const opportunitiesData = [
            {
                id: 0,
                title: "Meeting Overview",
                summary: "The meeting was fundamentally about re-engineering primary care using AI and digital infrastructure—not to replace clinicians, but to preserve clinical judgment, reduce burnout, improve safety, and keep general practice viable in a collapsing system.",
                details: [
                    { title: "Goal", text: "Preserve clinical judgment and reduce burnout." },
                    { title: "Method", text: "Re-engineering primary care via AI infrastructure." }
                ],
                imageSeed: "medical"
            },
            {
                id: 1,
                title: "System Pressure & Burnout",
                summary: "Discussion of escalating workload, rising patients per GP, and unfunded demand. Technology is positioned as a burnout-mitigation and safety tool, not simply a productivity lever.",
                details: [
                    { title: "Workload Data", text: "Quantified pressure at <strong>~2,273 patients per GP</strong>, representing a ~17% rise since 2015." },
                    { title: "Strategic Shift", text: "Reframing tech adoption as a burnout-reduction strategy rather than a throughput tool." }
                ],
                imageSeed: "stress"
            },
            {
                id: 2,
                title: "Digital Triage & Demand",
                summary: "Experience with total triage systems, including 'rag rating' and gamification. Results show reduction in unnecessary appointments, improved staff psychological safety, and safer waiting list management.",
                details: [
                    { title: "Implementation", text: "Total triage using RAG rating and gamification to standardise decision-making." },
                    { title: "Scale", text: "Direct support of 50–60 practices nationally to migrate to total triage." }
                ],
                imageSeed: "triage"
            },
            {
                id: 3,
                title: "AI Scribes & Voice Tech",
                summary: "Current and future use of AI scribes to reduce cognitive load, documentation time, and error rates. Integration with EPRs as a step toward true clinical co-pilot functionality.",
                details: [
                    { title: "Auto-population", text: "Live use of AI scribes (e.g. Heidi, Tortoise) to auto-populate history and plan fields." },
                    { title: "Efficiency", text: "Generate referrals and advice & guidance automatically." }
                ],
                imageSeed: "voice"
            },
            {
                id: 4,
                title: "Governance & Safety",
                summary: "Clinical Safety Officer (CSO) training as an emerging core skill. Need for proportionate governance, DPIAs, and ongoing monitoring without stifling innovation.",
                details: [
                    { title: "Compliance", text: "Adoption of NHS-approved AI whitelist products compliant with DCB0129/0160." },
                    { title: "Monitoring", text: "Implementation of ongoing monitoring, likened to a Yellow Card system for drugs." }
                ],
                imageSeed: "shield"
            },
            {
                id: 5,
                title: "EPR Transformation",
                summary: "Critique of the current EPR duopoly and migration to modern, cloud-based EPRs (notably Medicus) using open interoperability standards (FHIR).",
                details: [
                    { title: "Migration", text: "Full migration from EMIS to Medicus over a single weekend with zero clinical downtime." },
                    { title: "Impact", text: "Measured impact: <strong>45–60 minutes of GP time saved per day</strong>." }
                ],
                imageSeed: "tech"
            },
            {
                id: 6,
                title: "Point-of-Care Diagnostics",
                summary: "Adoption of portable, AI-enabled ultrasound (POCUS) in primary care. Use cases include heart failure assessment, DVT, and procedural confirmation.",
                details: [
                    { title: "Hardware", text: "Use of handheld GE vScan ultrasound (~£4k) in primary care." },
                    { title: "AI Guidance", text: "Real-time probe positioning prompts and automated ejection fraction calculation." }
                ],
                imageSeed: "ultrasound"
            },
            {
                id: 7,
                title: "Remote Monitoring & Wearables",
                summary: "AI-supported remote monitoring post-COVID and evolution toward consumer wearables (CGM, BP, AF detection). Concept of 'shift left / stay left'.",
                details: [
                    { title: "Care Homes", text: "Pandemic-era remote monitoring kits (BP, pulse, auscultation) with AI trend analysis." },
                    { title: "Consumer Tech", text: "Use of Apple/Samsung watches for AF detection and early intervention." }
                ],
                imageSeed: "watch"
            },
            {
                id: 8,
                title: "Automation & Agentic AI",
                summary: "Use of AI agents and custom GPTs to automate repetitive admin tasks. Explicit focus on preventing unsafe workload transfer from secondary to primary care.",
                details: [
                    { title: "Custom GPTs", text: "Auto-generate letters rejecting inappropriate workload transfer, quoting GMC guidance." },
                    { title: "No-Code", text: "Building internal tools using 'vibe coding' without developers." }
                ],
                imageSeed: "robot"
            },
            {
                id: 9,
                title: "Education & Workforce",
                summary: "AI-enhanced GP registrar training, including real-time feedback on consultations aligned with exam criteria. Potential to accelerate learning.",
                details: [
                    { title: "Exam Prep", text: "AI tools to record consultations and score against CSA/AKT-style criteria." },
                    { title: "Insights", text: "Analysis of ~40,000 consultations to support IMG performance." }
                ],
                imageSeed: "graduation"
            },
            {
                id: 10,
                title: "Communication & Advocacy",
                summary: "Use of AI-supported media creation to counter negative portrayals of general practice. Patient education and transparency about system pressures.",
                details: [
                    { title: "Chatbots", text: "Practice-built AI chatbot answering admin questions only." },
                    { title: "Media", text: "AI-assisted video production for public education and countering negative narratives." }
                ],
                imageSeed: "communication"
            }
        ];

        // --- Data Source: Risks ---
        const risksData = [
            {
                id: 0,
                title: "Risk Overview",
                summary: "AI itself is not the primary risk — poor implementation, broken systems, perverse incentives, and passive governance are. The greatest danger is adopting AI on top of failing infrastructure or allowing others to define its purpose (productivity over safety).",
                details: [
                    { title: "Primary Danger", text: "Not moving too fast, but moving blindly on broken infrastructure." },
                    { title: "Perverse Incentives", text: "Using AI to justify higher demand with no resource uplift." }
                ],
                imageSeed: "warning"
            },
            {
                id: 1,
                title: "Bureaucratic Friction",
                summary: "Complex and evolving regulatory landscape (DCB0129/0160) and variable local interpretations of national guidance often lead to delays and innovation paralysis.",
                details: [
                    { title: "Obstacle", text: "Variable local interpretations of national guidance leading to blanket 'no' decisions." },
                    { title: "Risk", text: "Innovation paralysis while workload and risk continue to increase." }
                ],
                imageSeed: "law"
            },
            {
                id: 2,
                title: "Legacy Infrastructure",
                summary: "Poor underlying data quality in legacy EPRs and proprietary APIs limit AI effectiveness. High failure demand caused by slow, unstable systems.",
                details: [
                    { title: "Obstacle", text: "Outdated system architecture (EMIS/SystemOne duopoly) and poor data quality." },
                    { title: "Risk", text: "AI amplifying existing errors rather than correcting them; 'Rearranging deckchairs'." }
                ],
                imageSeed: "server"
            },
            {
                id: 3,
                title: "Black-Box Accountability",
                summary: "Limited transparency in how AI systems reach conclusions. Clinicians remain fully accountable despite opaque decision pathways.",
                details: [
                    { title: "Obstacle", text: "Difficulty interrogating model logic in real time." },
                    { title: "Risk", text: "Automation bias and difficulty defending decisions medico-legally." }
                ],
                imageSeed: "mystery"
            },
            {
                id: 4,
                title: "Clinical Deskilling",
                summary: "Risk that registrars and early-career GPs may bypass core skills (history synthesis, documentation) if AI is relied upon too heavily.",
                details: [
                    { title: "Obstacle", text: "Trainers’ concern that AI-generated notes reduce learning opportunities." },
                    { title: "Risk", text: "Long-term erosion of clinical reasoning and clinicians unable to function without AI." }
                ],
                imageSeed: "braining"
            },
            {
                id: 5,
                title: "Workload Creep",
                summary: "Stakeholders viewing AI as a tool to increase patient throughput rather than reduce harm. Risk of AI being used to justify higher demand with no resource uplift.",
                details: [
                    { title: "Obstacle", text: "Senior stakeholders focusing on productivity over safety." },
                    { title: "Risk", text: "Accelerated burnout despite 'efficiency gains' and work dumping into primary care." }
                ],
                imageSeed: "graph"
            },
            {
                id: 6,
                title: "Digital Exclusion",
                summary: "Variable patient digital literacy and access. Over-reliance on online triage, portals, wearables, and chatbots may systematically disadvantage certain groups.",
                details: [
                    { title: "Obstacle", text: "Over-reliance on tech for populations lacking access or literacy." },
                    { title: "Risk", text: "Systematically disadvantaging the elderly, cognitively impaired, and socioeconomically deprived." }
                ],
                imageSeed: "exclusion"
            },
            {
                id: 7,
                title: "Data Security & IG",
                summary: "AI scribes sending data to external servers, uncertainty about data residency, and variation in vendor transparency pose significant confidentiality risks.",
                details: [
                    { title: "Obstacle", text: "Uncertainty about data residency and long-term storage." },
                    { title: "Risk", text: "Breach of confidentiality, GDPR non-compliance, and loss of patient trust." }
                ],
                imageSeed: "lock"
            },
            {
                id: 8,
                title: "Financial Misalignment",
                summary: "High upfront costs (ultrasound, licences), lack of reimbursement in GMS contracts, and unclear ROI for preventive technologies.",
                details: [
                    { title: "Obstacle", text: "Lack of reimbursement mechanisms within GMS contracts." },
                    { title: "Risk", text: "Financial unsustainability and unequal adoption favouring wealthier practices." }
                ],
                imageSeed: "money"
            },
            {
                id: 9,
                title: "Cultural Resistance",
                summary: "Managers lacking technical understanding, risk-averse culture defaulting to prohibition, and staff anxiety about job displacement.",
                details: [
                    { title: "Obstacle", text: "Risk-averse culture defaulting to prohibition." },
                    { title: "Risk", text: "Fragmented adoption, sabotage-by-non-engagement, and missed safety gains." }
                ],
                imageSeed: "culture"
            },
            {
                id: 10,
                title: "Hallucinations & Errors",
                summary: "AI outputs can be plausible but wrong. Need for constant human verification. Examples of unchecked creative outputs becoming inappropriate or unsafe.",
                details: [
                    { title: "Obstacle", text: "AI outputs can be plausible but wrong; need for constant verification." },
                    { title: "Risk", text: "Incorrect documentation, advice, or correspondence leading to patient harm." }
                ],
                imageSeed: "error"
            }
        ];

        // --- DOM Elements ---
        const navList = document.getElementById('navList');
        const contentArea = document.getElementById('contentArea');
        const searchInput = document.getElementById('searchInput');
        const menuBtn = document.getElementById('menuBtn');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const tabOpp = document.getElementById('tabOpp');
        const tabRisk = document.getElementById('tabRisk');
        const brandIcon = document.getElementById('brandIcon');

        // --- State ---
        let currentCategory = 'opportunities'; // 'opportunities' or 'risks'
        let currentId = 0;
        let currentData = opportunitiesData;

        // --- Icons ---
        const icons = {
            opp: {
                0: '<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/>',
                1: '<circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/>',
                2: '<path d="M22 12h-4l-3 9L9 3l-3 9H2"/>',
                3: '<path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="23"/>',
                4: '<path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>',
                5: '<rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" x2="16" y1="21" y2="21"/><line x1="12" x2="12" y1="17" y2="21"/>',
                6: '<path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>',
                7: '<path d="M22 12h-4l-3 9L9 3l-3 9H2"/>',
                8: '<rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" x2="16" y1="21" y2="21"/><line x1="12" x2="12" y1="17" y2="21"/><polyline points="12 2 12 12"/><polyline points="12 12 16 8"/><polyline points="12 12 8 8"/>',
                9: '<path d="M22 10v6M2 10v6"/><path d="M20 20a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8l8-5 8 5v12z"/><circle cx="12" cy="14" r="4"/>',
                10: '<path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>'
            },
            risk: {
                0: '<path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/>',
                1: '<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><polyline points="10 9 9 9 8 9"/>',
                2: '<rect x="2" y="2" width="20" height="8" rx="2" ry="2"/><rect x="2" y="14" width="20" height="8" rx="2" ry="2"/><line x1="6" x2="6.01" y1="6" y2="6"/><line x1="6" x2="6.01" y1="18" y2="18"/>',
                3: '<path d="M2 12h20"/><path d="M20 12v6a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-6"/><path d="M9 4v16"/><path d="M15 4v16"/>',
                4: '<path d="M2 12h10"/><path d="M9 4v16"/><path d="M3 20h18"/><path d="M14 8h6"/><path d="M14 16h6"/>', // Abstract broken skill
                5: '<path d="M23 6l-9.5 9.5-5-5L1 18"/><path d="M17 6h6v6"/>', // Graph going up (bad for burnout)
                6: '<circle cx="12" cy="12" r="10"/><line x1="4.93" x2="19.07" y1="4.93" y2="19.07"/>',
                7: '<rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/>',
                8: '<line x1="12" x2="12" y1="1" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>',
                9: '<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>',
                10: '<path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>'
            }
        };

        function getIcon(type, id) {
            const set = type === 'opportunities' ? icons.opp : icons.risk;
            return `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${set[id] || set[0]}</svg>`;
        }

        // --- Initialization ---
        function init() {
            renderNav(currentData);
            loadContent(0);
            setupEventListeners();
        }

        // --- Render Navigation ---
        function renderNav(data) {
            navList.innerHTML = '';
            if (data.length === 0) {
                navList.innerHTML = '<li style="padding:1rem; color:#64748b;">No results found.</li>';
                return;
            }

            data.forEach(item => {
                const li = document.createElement('li');
                li.className = `nav-item ${item.id === currentId ? 'active' : ''}`;
                li.onclick = () => {
                    loadContent(item.id);
                    if (window.innerWidth <= 768) toggleSidebar();
                };
                li.innerHTML = `
                    <div class="nav-icon">${getIcon(currentCategory, item.id)}</div>
                    <span>${item.title}</span>
                `;
                navList.appendChild(li);
            });
        }

        // --- Switch Category ---
        function switchCategory(category) {
            currentCategory = category;
            currentData = category === 'opportunities' ? opportunitiesData : risksData;
            currentId = 0; // Reset to overview
            
            // Update UI State
            if (category === 'opportunities') {
                tabOpp.classList.add('active');
                tabRisk.classList.remove('active');
                document.body.classList.remove('theme-risks');
                brandIcon.innerHTML = '<path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/>';
            } else {
                tabOpp.classList.remove('active');
                tabRisk.classList.add('active');
                document.body.classList.add('theme-risks');
                brandIcon.innerHTML = '<path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/>';
            }

            // Clear search
            searchInput.value = '';
            
            renderNav(currentData);
            loadContent(0);
        }

        // --- Load Content ---
        function loadContent(id) {
            currentId = id;
            const item = currentData.find(d => d.id === id);
            if (!item) return;

            // Update Nav Active State
            const navItems = document.querySelectorAll('.nav-item');
            // Since we re-render nav on search, we just iterate and check text or index match
            // But strictly speaking, we can re-render nav to ensure sync is easiest, or just toggle classes
            // Re-rendering is expensive for just a class change, let's toggle
            if (searchInput.value === '') {
                const index = currentData.findIndex(d => d.id === id);
                if(index > -1 && navItems[index]) {
                    navItems.forEach(el => el.classList.remove('active'));
                    navItems[index].classList.add('active');
                }
            }

            contentArea.innerHTML = '';
            const wrapper = document.createElement('div');
            wrapper.className = 'content-wrapper fade-in';

            const imgSrc = `https://picsum.photos/seed/${item.imageSeed}/900/200`;
            const sectionLabel = currentCategory === 'opportunities' ? 'Thematic Area' : 'Risk Domain';
            
            let detailsHtml = '';
            if (!item.isOverview) {
                detailsHtml = `
                    <h2>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            ${currentCategory === 'opportunities' 
                                ? '<polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>' 
                                : '<path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>'}
                        </svg>
                        ${currentCategory === 'opportunities' ? 'Practical Examples' : 'Key Risks & Obstacles'}
                    </h2>
                `;
                item.details.forEach(d => {
                    detailsHtml += `
                        <div class="detail-card">
                            <div class="detail-title">${d.title}</div>
                            <div class="detail-desc">${d.text}</div>
                        </div>
                    `;
                });
            } else {
                // Overview specific styling
                detailsHtml = `
                    <div class="detail-card" style="border-left-width: 4px;">
                        <div class="detail-desc" style="font-size: 1.1rem;">${item.summary}</div>
                    </div>
                    <p style="margin-top:1rem; color:var(--text-muted)">Select a topic from the sidebar to view details.</p>
                `;
            }

            wrapper.innerHTML = `
                <img src="${imgSrc}" alt="${item.title}" class="hero-banner">
                <span class="category-badge">${item.id === 0 ? 'Summary' : sectionLabel}</span>
                <h1>${item.title}</h1>
                ${item.id !== 0 ? `<div class="summary-text">${item.summary}</div>` : ''}
                ${detailsHtml}
                <div class="footer-info">
                    AI in GP Land &copy; <span id="year"></span> | Curated Meeting Insights
                </div>
            `;

            contentArea.appendChild(wrapper);
            document.getElementById('year').textContent = new Date().getFullYear();
        }

        // --- Event Listeners ---
        function setupEventListeners() {
            searchInput.addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = currentData.filter(item => 
                    item.title.toLowerCase().includes(term) || 
                    item.summary.toLowerCase().includes(term)
                );
                renderNav(filtered);
            });

            menuBtn.addEventListener('click', toggleSidebar);
            overlay.addEventListener('click', toggleSidebar);
        }

        function toggleSidebar() {
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        init();
    </script>
</body>
</html>