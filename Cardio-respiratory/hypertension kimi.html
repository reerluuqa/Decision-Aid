<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hypertension Management Algorithm | NICE CKS</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --dark: #1e293b;
            --light: #f8fafc;
            --card-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 280px;
            gap: 2rem;
        }

        .header {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-radius: var(--card-radius);
            box-shadow: var(--shadow-lg);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .algorithm-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            height: fit-content;
        }

        .stage-card {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: var(--shadow-md);
            overflow: hidden;
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid #e2e8f0;
        }

        .stage-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .stage-card.active {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .card-header {
            padding: 1.5rem;
            color: white;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: var(--transition);
        }

        .assessment-header { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
        .diagnosis-header { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); }
        .treatment-header { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .followup-header { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }

        .card-icon {
            font-size: 2rem;
            width: 56px;
            height: 56px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .stage-card:hover .card-icon {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.3);
        }

        .card-title {
            flex: 1;
        }

        .card-title h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .card-title p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .expand-icon {
            font-size: 1.25rem;
            transition: var(--transition);
            background: rgba(255, 255, 255, 0.2);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stage-card.active .expand-icon {
            transform: rotate(180deg);
        }

        .card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
        }

        .stage-card.active .card-content {
            max-height: 2000px;
        }

        .content-section {
            padding: 1.5rem;
            border-top: 1px solid #f1f5f9;
            transition: var(--transition);
        }

        .content-section:hover {
            background: #f8fafc;
        }

        .section-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-content {
            color: var(--secondary);
            font-size: 0.95rem;
        }

        .severity-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            transition: var(--transition);
        }

        .badge-danger {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            color: #991b1b;
            border: 1px solid #f87171;
        }

        .badge-warning {
            background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%);
            color: #92400e;
            border: 1px solid #fbbf24;
        }

        .badge-success {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            color: #065f46;
            border: 1px solid #34d399;
        }

        .badge-info {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            color: #1e40af;
            border: 1px solid #60a5fa;
        }

        .sidebar {
            position: sticky;
            top: 2rem;
            height: fit-content;
        }

        .progress-card {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            border: 1px solid #e2e8f0;
        }

        .progress-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .progress-steps {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: 8px;
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid #e2e8f0;
        }

        .progress-step:hover {
            background: #f8fafc;
            transform: translateX(4px);
        }

        .progress-step.active {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border-color: var(--primary);
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #e2e8f0;
            color: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .progress-step.active .step-number {
            background: var(--primary);
            color: white;
        }

        .step-content {
            flex: 1;
        }

        .step-name {
            font-weight: 500;
            color: var(--dark);
            font-size: 0.9rem;
        }

        .step-status {
            font-size: 0.75rem;
            color: var(--secondary);
        }

        .bp-chart {
            background: #f8fafc;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.75rem 0;
            border: 1px solid #e2e8f0;
        }

        .bp-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 0.5rem;
            padding: 0.5rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .bp-row:hover {
            background: #f1f5f9;
        }

        .bp-row:last-child {
            border-bottom: none;
        }

        .bp-category {
            font-weight: 500;
        }

        .bp-values {
            text-align: center;
            font-family: 'Courier New', monospace;
            font-weight: 500;
        }

        .treatment-step {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.75rem 0;
            border-left: 4px solid var(--primary);
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }

        .treatment-step:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow-md);
        }

        .step-header {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .drug-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
            margin: 0.5rem 0;
        }

        .drug-item {
            background: #f8fafc;
            padding: 0.5rem;
            border-radius: 6px;
            font-size: 0.85rem;
            border: 1px solid #e2e8f0;
            transition: var(--transition);
        }

        .drug-item:hover {
            background: #e0f2fe;
            border-color: var(--primary);
        }

        .monitoring-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 0.75rem 0;
        }

        .monitoring-item {
            background: #f8fafc;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--success);
            transition: var(--transition);
        }

        .monitoring-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .monitoring-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .monitoring-content {
            font-size: 0.85rem;
            color: var(--secondary);
        }

        .alert-box {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border: 1px solid #fecaca;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.75rem 0;
            display: flex;
            gap: 0.75rem;
            align-items: flex-start;
            transition: var(--transition);
        }

        .alert-box:hover {
            transform: translateX(4px);
        }

        .alert-icon {
            color: var(--danger);
            font-size: 1.25rem;
            margin-top: 0.1rem;
        }

        .alert-content {
            flex: 1;
        }

        .alert-title {
            font-weight: 600;
            color: #991b1b;
            margin-bottom: 0.25rem;
        }

        .alert-text {
            font-size: 0.9rem;
            color: #92400e;
        }

        .interactive-checklist {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.75rem 0;
            border: 1px solid #e2e8f0;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
        }

        .checklist-item:hover {
            background: #f8fafc;
        }

        .checklist-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .checklist-item label {
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--dark);
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        .fade-text {
            color: var(--secondary);
            font-style: italic;
        }

        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: relative;
                top: 0;
            }
            
            .algorithm-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 640px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 1.75rem;
            }
            
            .card-header {
                padding: 1.25rem;
            }
            
            .card-icon {
                width: 48px;
                height: 48px;
                font-size: 1.5rem;
            }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e2e8f0;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <div class="container">
        <div class="header">
            <h1><i class="fas fa-heartbeat"></i> Hypertension Management</h1>
            <p>Interactive Clinical Decision Support Tool | NICE CKS Guidelines (October 2025)</p>
        </div>

        <div class="algorithm-grid">
            <!-- Assessment Card -->
            <div class="stage-card" data-stage="assessment">
                <div class="card-header assessment-header">
                    <div class="card-icon">
                        <i class="fas fa-stethoscope"></i>
                    </div>
                    <div class="card-title">
                        <h2>Assessment</h2>
                        <p>Initial evaluation and risk stratification</p>
                    </div>
                    <div class="expand-icon">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
                <div class="card-content">
                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-tachometer-alt"></i>
                            Blood Pressure Measurement
                        </div>
                        <div class="section-content">
                            <div class="bp-chart">
                                <div class="bp-row">
                                    <div class="bp-category"><strong>Category</strong></div>
                                    <div class="bp-values"><strong>Clinic BP</strong></div>
                                    <div class="bp-values"><strong>ABPM/HBPM</strong></div>
                                </div>
                                <div class="bp-row">
                                    <div class="bp-category">Stage 1 Hypertension</div>
                                    <div class="bp-values">140/90 - 159/99</div>
                                    <div class="bp-values">135/85 - 149/94</div>
                                </div>
                                <div class="bp-row">
                                    <div class="bp-category">Stage 2 Hypertension</div>
                                    <div class="bp-values">160/100 - 179/119</div>
                                    <div class="bp-values">≥150/95</div>
                                </div>
                                <div class="bp-row">
                                    <div class="bp-category">Stage 3 (Severe)</div>
                                    <div class="bp-values">≥180/120</div>
                                    <div class="bp-values">-</div>
                                </div>
                            </div>
                            <ul style="margin-top: 0.75rem; padding-left: 1.5rem; color: var(--secondary);">
                                <li>Measure BP in both arms; use higher reading for subsequent measurements</li>
                                <li>Palpate radial/brachial pulse before measurement</li>
                                <li>If irregular pulse, measure BP manually via auscultation</li>
                                <li>For suspected postural hypotension: measure supine/seated then standing (≥1 min)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            Urgent Assessment Criteria
                        </div>
                        <div class="severity-badges">
                            <span class="badge badge-danger">
                                <i class="fas fa-ambulance"></i> Same-day referral
                            </span>
                        </div>
                        <div class="alert-box">
                            <div class="alert-icon">
                                <i class="fas fa-exclamation-circle"></i>
                            </div>
                            <div class="alert-content">
                                <div class="alert-title">Accelerated/Malignant Hypertension</div>
                                <div class="alert-text">
                                    BP ≥180/120 mmHg WITH signs of retinal hemorrhage/papilledema OR life-threatening symptoms (confusion, chest pain, heart failure, AKI)
                                </div>
                            </div>
                        </div>
                        <div class="alert-box">
                            <div class="alert-icon">
                                <i class="fas fa-eye"></i>
                            </div>
                            <div class="alert-content">
                                <div class="alert-title">Suspected Phaeochromocytoma</div>
                                <div class="alert-text">
                                    Labile/postural hypertension, headaches, palpitations, pallor, abdominal pain, diaphoresis
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-user-check"></i>
                            Assess for Target Organ Damage
                        </div>
                        <div class="section-content">
                            <div class="interactive-checklist">
                                <div class="checklist-item">
                                    <input type="checkbox" id="urine-albumin">
                                    <label for="urine-albumin">Urine albumin:creatinine ratio (ACR)</label>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" id="blood-tests">
                                    <label for="blood-tests">HbA1c, electrolytes, creatinine, eGFR</label>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" id="fundoscopy">
                                    <label for="fundoscopy">Fundoscopy for hypertensive retinopathy</label>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" id="ecg">
                                    <label for="ecg">12-lead ECG (left ventricular hypertrophy)</label>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" id="lipids">
                                    <label for="lipids">Serum total cholesterol & HDL</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-search"></i>
                            When to Suspect Secondary Hypertension
                        </div>
                        <div class="section-content">
                            <div class="severity-badges">
                                <span class="badge badge-warning">
                                    <i class="fas fa-user-md"></i> Age <40 years
                                </span>
                                <span class="badge badge-warning">
                                    <i class="fas fa-chart-line"></i> Sudden onset/worsening
                                </span>
                                <span class="badge badge-warning">
                                    <i class="fas fa-exclamation"></i> Accelerated hypertension
                                </span>
                            </div>
                            <ul style="margin-top: 0.75rem; padding-left: 1.5rem; color: var(--secondary);">
                                <li>Renal disease: CKD, glomerulonephritis, polycystic kidneys, renal artery stenosis</li>
                                <li>Endocrine: Primary aldosteronism, Cushing's, phaeochromocytoma, thyroid disorders</li>
                                <li>Vascular: Coarctation of aorta</li>
                                <li>Drugs: NSAIDs, COCP, steroids, decongestants, stimulants, alcohol, ciclosporin</li>
                            </ul>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-calculator"></i>
                            CVD Risk Assessment
                        </div>
                        <div class="section-content">
                            <p style="margin-bottom: 0.75rem;">Estimate 10-year CVD risk using QRISK® assessment tool</p>
                            <div class="severity-badges">
                                <span class="badge badge-danger">CVD Risk ≥10%: Treat Stage 1 HTN</span>
                                <span class="badge badge-warning">CVD Risk <10%: Consider treatment if <60 years</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Diagnosis Card -->
            <div class="stage-card" data-stage="diagnosis">
                <div class="card-header diagnosis-header">
                    <div class="card-icon">
                        <i class="fas fa-diagnoses"></i>
                    </div>
                    <div class="card-title">
                        <h2>Diagnosis</h2>
                        <p>Confirm hypertension and classify severity</p>
                    </div>
                    <div class="expand-icon">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
                <div class="card-content">
                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-microscope"></i>
                            Confirming the Diagnosis
                        </div>
                        <div class="section-content">
                            <p>For clinic BP 140/90-180/120 mmHg, confirm with <strong>ABPM or HBPM</strong>:</p>
                            <div class="monitoring-grid">
                                <div class="monitoring-item">
                                    <div class="monitoring-title">
                                        <i class="fas fa-walking"></i> ABPM (Ambulatory)
                                    </div>
                                    <div class="monitoring-content">
                                        • ≥2 measurements/hour during waking hours<br>
                                        • Use average of ≥14 measurements<br>
                                        • Confirm if average ≥135/85 mmHg
                                    </div>
                                </div>
                                <div class="monitoring-item">
                                    <div class="monitoring-title">
                                        <i class="fas fa-home"></i> HBPM (Home)
                                    </div>
                                    <div class="monitoring-content">
                                        • 2 consecutive measurements, 1 minute apart<br>
                                        • Twice daily (morning & evening) for 4-7 days<br>
                                        • Discard day 1, average remaining readings<br>
                                        • Confirm if average ≥135/85 mmHg
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-layer-group"></i>
                            Classification of Confirmed Hypertension
                        </div>
                        <div class="bp-chart">
                            <div class="bp-row">
                                <div class="bp-category"><strong>Stage</strong></div>
                                <div class="bp-values"><strong>Clinic BP</strong></div>
                                <div class="bp-values"><strong>ABPM/HBPM</strong></div>
                            </div>
                            <div class="bp-row" style="background: #fef3c7;">
                                <div class="bp-category">Stage 1</div>
                                <div class="bp-values">140/90 - 159/99</div>
                                <div class="bp-values">135/85 - 149/94</div>
                            </div>
                            <div class="bp-row" style="background: #fed7aa;">
                                <div class="bp-category">Stage 2</div>
                                <div class="bp-values">160/100 - 179/119</div>
                                <div class="bp-values">≥150/95</div>
                            </div>
                            <div class="bp-row" style="background: #fecaca;">
                                <div class="bp-category">Stage 3 (Severe)</div>
                                <div class="bp-values">≥180/120</div>
                                <div class="bp-values">-</div>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-mask"></i>
                            Special Phenomena
                        </div>
                        <div class="section-content">
                            <div class="severity-badges">
                                <span class="badge badge-warning">
                                    <i class="fas fa-user-md"></i> White-coat HTN: >20/10 mmHg clinic-home difference
                                </span>
                                <span class="badge badge-warning">
                                    <i class="fas fa-eye"></i> Masked HTN: Normal clinic, high home BP
                                </span>
                            </div>
                            <p style="margin-top: 0.75rem; color: var(--secondary);">
                                <strong>White-coat effect:</strong> 15-30% of population. Persistent discrepancy between clinic and home/ambulatory readings.
                            </p>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-user-clock"></i>
                            If Hypertension NOT Diagnosed
                        </div>
                        <div class="section-content">
                            <ul style="padding-left: 1.5rem; color: var(--secondary);">
                                <li><strong>With target organ damage:</strong> Investigate alternative causes (CKD, heart failure)</li>
                                <li><strong>Without target organ damage:</strong> Measure clinic BP at least every 5 years (more frequently if close to 140/90 mmHg)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-info-circle"></i>
                            Key Points
                        </div>
                        <div class="section-content">
                            <div class="alert-box">
                                <div class="alert-icon">
                                    <i class="fas fa-lightbulb"></i>
                                </div>
                                <div class="alert-content">
                                    <div class="alert-title">Diagnostic Thresholds</div>
                                    <div class="alert-text">
                                        ABPM/HBPM thresholds are 5 mmHg lower than clinic measurements (135/85 vs 140/90)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Treatment Card -->
            <div class="stage-card" data-stage="treatment">
                <div class="card-header treatment-header">
                    <div class="card-icon">
                        <i class="fas fa-pills"></i>
                    </div>
                    <div class="card-title">
                        <h2>Treatment</h2>
                        <p>Lifestyle & pharmacological management</p>
                    </div>
                    <div class="expand-icon">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
                <div class="card-content">
                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-apple-alt"></i>
                            Lifestyle Advice (For ALL patients)
                        </div>
                        <div class="section-content">
                            <div class="monitoring-grid">
                                <div class="monitoring-item">
                                    <div class="monitoring-title">
                                        <i class="fas fa-weight"></i> Diet & Exercise
                                    </div>
                                    <div class="monitoring-content">
                                        • Healthy diet & regular exercise reduce BP<br>
                                        • If overweight/obese: offer weight loss advice<br>
                                        • Limit caffeine intake
                                    </div>
                                </div>
                                <div class="monitoring-item">
                                    <div class="monitoring-title">
                                        <i class="fas fa-shaker"></i> Sodium
                                    </div>
                                    <div class="monitoring-content">
                                        • Keep dietary sodium low<br>
                                        • <strong>Caution:</strong> Avoid potassium-based salt substitutes in elderly, diabetes, pregnancy, CKD, ACEi/ARB users
                                    </div>
                                </div>
                                <div class="monitoring-item">
                                    <div class="monitoring-title">
                                        <i class="fas fa-smoking"></i> Smoking & Alcohol
                                    </div>
                                    <div class="monitoring-content">
                                        • Offer smoking cessation support<br>
                                        • Reduce excessive alcohol intake<br>
                                        • Provide patient information leaflets
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-thermometer-half"></i>
                            Treatment Thresholds by Stage
                        </div>
                        <div class="section-content">
                            <div class="treatment-step">
                                <div class="step-header">
                                    <i class="fas fa-exclamation-circle"></i> Stage 2 Hypertension
                                </div>
                                <div class="severity-badges">
                                    <span class="badge badge-danger">Treat ALL adults regardless of age</span>
                                </div>
                                <p style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--secondary);">
                                    Clinic BP 160/100-179/119 mmHg AND ABPM/HBPM ≥150/95 mmHg
                                </p>
                            </div>
                            <div class="treatment-step">
                                <div class="step-header">
                                    <i class="fas fa-user-clock"></i> Stage 1 Hypertension
                                </div>
                                <div class="severity-badges">
                                    <span class="badge badge-warning">Aged <80 years + TOD/CVD/diabetes/CKD or 10-year CVD risk ≥10%</span>
                                    <span class="badge badge-info">Consider if <60 years even if CVD risk <10%</span>
                                    <span class="badge badge-info">Aged ≥80 years if clinic BP >150/90 mmHg</span>
                                </div>
                                <p style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--secondary);">
                                    Clinic BP 140/90-159/99 mmHg AND ABPM/HBPM 135/85-149/94 mmHg
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-layer-group"></i>
                            Stepwise Treatment Algorithm
                        </div>
                        <div class="section-content">
                            <div class="treatment-step">
                                <div class="step-header">
                                    <i class="fas fa-1"></i> Step 1 Treatment
                                </div>
                                <div class="drug-list">
                                    <div class="drug-item">
                                        <strong>Aged <55 years</strong><br>
                                        <small>Not black African/Caribbean:</small><br>
                                        ACE inhibitor (or ARB if ACEi not tolerated)
                                    </div>
                                    <div class="drug-item">
                                        <strong>Aged ≥55 years</strong><br>
                                        <small>Or black African/Caribbean:</small><br>
                                        Calcium-channel blocker
                                    </div>
                                    <div class="drug-item">
                                        <strong>Type 2 Diabetes</strong><br>
                                        <small>Any age/origin:</small><br>
                                        ACE inhibitor (ARB if black African/Caribbean)
                                    </div>
                                </div>
                                <p style="margin-top: 0.5rem; font-size: 0.8rem; color: var(--secondary);">
                                    <strong>Note:</strong> If CCB not tolerated (edema) → Thiazide-like diuretic (indapamide)<br>
                                    If heart failure → Thiazide-like diuretic
                                </p>
                            </div>

                            <div class="treatment-step">
                                <div class="step-header">
                                    <i class="fas fa-2"></i> Step 2 Treatment
                                </div>
                                <div class="drug-list">
                                    <div class="drug-item">
                                        <strong>ACEi/ARB + CCB</strong><br>
                                        <small>Add CCB to ACEi/ARB</small>
                                    </div>
                                    <div class="drug-item">
                                        <strong>ACEi/ARB + Thiazide</strong><br>
                                        <small>Add thiazide-like diuretic to ACEi/ARB</small>
                                    </div>
                                    <div class="drug-item">
                                        <strong>CCB + ACEi/ARB</strong><br>
                                        <small>Add ACEi/ARB to CCB</small>
                                    </div>
                                    <div class="drug-item">
                                        <strong>CCB + Thiazide</strong><br>
                                        <small>Add thiazide-like diuretic to CCB</small>
                                    </div>
                                </div>
                            </div>

                            <div class="treatment-step">
                                <div class="step-header">
                                    <i class="fas fa-3"></i> Step 3 Treatment
                                </div>
                                <div class="drug-list">
                                    <div class="drug-item" style="grid-column: span 2;">
                                        <strong>ACEi/ARB + CCB + Thiazide-like diuretic</strong><br>
                                        <small>Triple therapy combination</small>
                                    </div>
                                </div>
                            </div>

                            <div class="treatment-step">
                                <div class="step-header">
                                    <i class="fas fa-4"></i> Step 4 Treatment (Resistant Hypertension)
                                </div>
                                <div class="severity-badges">
                                    <span class="badge badge-danger">Confirmed resistant if uncontrolled on 3 drugs</span>
                                </div>
                                <div class="drug-list" style="margin-top: 0.5rem;">
                                    <div class="drug-item" style="background: #fef2f2; border-color: #fecaca;">
                                        <strong>If K⁺ ≤4.5 mmol/L:</strong><br>
                                        <small>Add low-dose spironolactone 25mg daily<br>
                                        Monitor renal function & electrolytes within 1 month</small>
                                    </div>
                                    <div class="drug-item" style="background: #fefce8; border-color: #fef3c7;">
                                        <strong>If K⁺ >4.5 mmol/L:</strong><br>
                                        <small>Consider alpha-blocker OR beta-blocker</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-info-circle"></i>
                            Key Treatment Principles
                        </div>
                        <div class="section-content">
                            <div class="alert-box">
                                <div class="alert-icon">
                                    <i class="fas fa-lightbulb"></i>
                                </div>
                                <div class="alert-content">
                                    <div class="alert-title">Important Considerations</div>
                                    <div class="alert-text">
                                        • Titrate to optimum/highest tolerated dose before adding next step<br>
                                        • ACEi + ARB combination is <strong>NOT recommended</strong><br>
                                        • Use generic drugs where appropriate to minimize cost<br>
                                        • Monitor renal function & electrolytes when using RAS antagonists
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Follow-up Card -->
            <div class="stage-card" data-stage="followup">
                <div class="card-header followup-header">
                    <div class="card-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="card-title">
                        <h2>Follow-up</h2>
                        <p>Monitoring and long-term management</p>
                    </div>
                    <div class="expand-icon">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
                <div class="card-content">
                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-bullseye"></i>
                            Treatment Targets
                        </div>
                        <div class="section-content">
                            <div class="bp-chart">
                                <div class="bp-row">
                                    <div class="bp-category"><strong>Age Group</strong></div>
                                    <div class="bp-values"><strong>Clinic Target</strong></div>
                                    <div class="bp-values"><strong>ABPM/HBPM</strong></div>
                                </div>
                                <div class="bp-row" style="background: #d1fae5;">
                                    <div class="bp-category"><65 years</div>
                                    <div class="bp-values">&lt;140/90 mmHg</div>
                                    <div class="bp-values">&lt;135/85 mmHg</div>
                                </div>
                                <div class="bp-row" style="background: #dcfce7;">
                                    <div class="bp-category">65-79 years</div>
                                    <div class="bp-values">&lt;140/90 mmHg</div>
                                    <div class="bp-values">&lt;135/85 mmHg</div>
                                </div>
                                <div class="bp-row" style="background: #ecfccb;">
                                    <div class="bp-category">≥80 years</div>
                                    <div class="bp-values">&lt;150/90 mmHg</div>
                                    <div class="bp-values">&lt;145/85 mmHg</div>
                                </div>
                                <div class="bp-row" style="background: #fef3c7;">
                                    <div class="bp-category">Frailty/Multimorbidity</div>
                                    <div class="bp-values" style="grid-column: span 2;">Use clinical judgement</div>
                                </div>
                            </div>
                            <div class="severity-badges" style="margin-top: 0.75rem;">
                                <span class="badge badge-info">
                                    <i class="fas fa-ruler-vertical"></i> ABPM/HBPM targets are 5 mmHg lower than clinic
                                </span>
                                <span class="badge badge-warning">
                                    <i class="fas fa-user-friends"></i> Same targets for with/without CVD
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-calendar-check"></i>
                            Annual Review
                        </div>
                        <div class="section-content">
                            <div class="monitoring-grid">
                                <div class="monitoring-item">
                                    <div class="monitoring-title">
                                        <i class="fas fa-pills"></i> Medication Adherence
                                    </div>
                                    <div class="monitoring-content">
                                        • Discuss medication-taking behavior<br>
                                        • Consider pill boxes, blister packs, dosing charts<br>
                                        • Simplify regimen if polypharmacy
                                    </div>
                                </div>
                                <div class="monitoring-item">
                                    <div class="monitoring-title">
                                        <i class="fas fa-heartbeat"></i> Blood Pressure Check
                                    </div>
                                    <div class="monitoring-content">
                                        • Check BP vs. target range<br>
                                        • If above target: recheck 2-3 times over weeks/months<br>
                                        • Consider ABPM/HBPM for white-coat effect
                                    </div>
                                </div>
                                <div class="monitoring-item">
                                    <div class="monitoring-title">
                                        <i class="fas fa-apple-alt"></i> Lifestyle Review
                                    </div>
                                    <div class="monitoring-content">
                                        • Smoking, weight, diet, activity<br>
                                        • Alcohol consumption<br>
                                        • Sodium intake
                                    </div>
                                </div>
                                <div class="monitoring-item">
                                    <div class="monitoring-title">
                                        <i class="fas fa-vial"></i> Renal Function
                                    </div>
                                    <div class="monitoring-content">
                                        • Serum creatinine, eGFR<br>
                                        • Urine ACR<br>
                                        • If eGFR <60 or ACR ≥3: CKD pathway
                                    </div>
                                </div>
                            </div>

                            <div class="alert-box" style="margin-top: 1rem;">
                                <div class="alert-icon">
                                    <i class="fas fa-lightbulb"></i>
                                </div>
                                <div class="alert-content">
                                    <div class="alert-title">Consider De-intensification</div>
                                    <div class="alert-text">
                                        For those with well-controlled BP for years AND favorable factors (single drug, younger age, lower BP, white-coat effect, successful lifestyle changes) → consider gradual withdrawal
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-tint"></i>
                            Monitoring Requirements for Drug Classes
                        </div>
                        <div class="section-content">
                            <div class="drug-list">
                                <div class="drug-item" style="background: #fef2f2; border-color: #fecaca;">
                                    <strong>ACE inhibitors & ARBs</strong><br>
                                    <small>• Baseline: Renal function, electrolytes<br>
                                    • 1-2 weeks after start/titration<br>
                                    • Annually thereafter<br>
                                    • Monitor potassium (hyperkalaemia)</small>
                                </div>
                                <div class="drug-item" style="background: #fefce8; border-color: #fef3c7;">
                                    <strong>Thiazide-like diuretics</strong><br>
                                    <small>• Baseline & 4 weeks: Sodium, potassium<br>
                                    • Regular electrolyte monitoring<br>
                                    • Contraindicated if CrCl <30 mL/min</small>
                                </div>
                                <div class="drug-item" style="background: #ecfccb; border-color: #d9f99d;">
                                    <strong>Calcium-channel blockers</strong><br>
                                    <small>• Blood pressure monitoring<br>
                                    • Check for peripheral edema<br>
                                    • Caution in heart failure</small>
                                </div>
                                <div class="drug-item" style="background: #f0f9ff; border-color: #bae6fd;">
                                    <strong>Spironolactone</strong><br>
                                    <small>• Baseline K⁺ must be ≤4.5 mmol/L<br>
                                    • Check renal function & electrolytes within 1 month<br>
                                    • Monitor for hyperkalaemia</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            When to Seek Specialist Advice
                        </div>
                        <div class="section-content">
                            <div class="severity-badges">
                                <span class="badge badge-danger">
                                    <i class="fas fa-hospital"></i> Resistant hypertension (uncontrolled on 4 drugs)
                                </span>
                                <span class="badge badge-warning">
                                    <i class="fas fa-user-md"></i> Age <40 years with hypertension
                                </span>
                                <span class="badge badge-warning">
                                    <i class="fas fa-stethoscope"></i> Suspected secondary hypertension
                                </span>
                            </div>
                            <div class="alert-box" style="margin-top: 0.75rem;">
                                <div class="alert-icon">
                                    <i class="fas fa-info-circle"></i>
                                </div>
                                <div class="alert-content">
                                    <div class="alert-title">Resistant Hypertension Definition</div>
                                    <div class="alert-text">
                                        BP remains uncontrolled despite optimal/tolerated doses of ACEi/ARB + CCB + Thiazide-like diuretic (3 drugs)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-section fade-in">
                        <div class="section-title">
                            <i class="fas fa-users"></i>
                            Special Populations
                        </div>
                        <div class="section-content">
                            <div class="drug-list">
                                <div class="drug-item" style="background: #fef3c7; border-color: #fbbf24;">
                                    <strong>Black African/Caribbean</strong><br>
                                    <small>• Better response to CCBs & thiazides<br>
                                    • ARB preferred over ACEi<br>
                                    • May require higher doses</small>
                                </div>
                                <div class="drug-item" style="background: #fecaca; border-color: #f87171;">
                                    <strong>Pregnancy/Planning</strong><br>
                                    <small>• STOP ACEi & ARBs<br>
                                    • Use labetalol, nifedipine, methyldopa<br>
                                    • See Hypertension in Pregnancy topic</small>
                                </div>
                                <div class="drug-item" style="background: #ecfccb; border-color: #d9f99d;">
                                    <strong>Diabetes</strong><br>
                                    <small>• ACEi/ARB first line<br>
                                    • Monitor renal function & potassium<br>
                                    • BP target typically <130/80 mmHg</small>
                                </div>
                                <div class="drug-item" style="background: #f0f9ff; border-color: #bae6fd;">
                                    <strong>Chronic Kidney Disease</strong><br>
                                    <small>• ACEi/ARB first line<br>
                                    • Monitor eGFR & potassium<br>
                                    • See CKD topic for specific targets</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="progress-card">
                <div class="progress-title">
                    <i class="fas fa-tasks"></i> Progress Tracking
                </div>
                <div class="progress-steps">
                    <div class="progress-step active" data-target="assessment">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-name">Assessment</div>
                            <div class="step-status">In Progress</div>
                        </div>
                    </div>
                    <div class="progress-step" data-target="diagnosis">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-name">Diagnosis</div>
                            <div class="step-status">Not Started</div>
                        </div>
                    </div>
                    <div class="progress-step" data-target="treatment">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-name">Treatment</div>
                            <div class="step-status">Not Started</div>
                        </div>
                    </div>
                    <div class="progress-step" data-target="followup">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <div class="step-name">Follow-up</div>
                            <div class="step-status">Not Started</div>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                    <div class="severity-badges">
                        <span class="badge badge-danger">
                            <i class="fas fa-ambulance"></i> Urgent
                        </span>
                        <span class="badge badge-warning">
                            <i class="fas fa-exclamation"></i> Caution
                        </span>
                        <span class="badge badge-success">
                            <i class="fas fa-check"></i> Stable
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class HypertensionGuidelines {
            constructor() {
                this.currentStage = 'assessment';
                this.completedStages = new Set();
                this.init();
            }

            init() {
                this.setupCardInteractions();
                this.setupProgressNavigation();
                this.setupChecklistHandling();
                this.initializeAnimations();
                this.setupKeyboardNavigation();
                this.setupPrintFunctionality();
            }

            setupCardInteractions() {
                const cards = document.querySelectorAll('.stage-card');
                
                cards.forEach(card => {
                    const header = card.querySelector('.card-header');
                    
                    header.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.toggleCard(card);
                    });

                    // Prevent content clicks from closing card
                    const content = card.querySelector('.card-content');
                    content.addEventListener('click', (e) => {
                        e.stopPropagation();
                    });
                });
            }

            toggleCard(card) {
                const isActive = card.classList.contains('active');
                const stage = card.dataset.stage;

                // Close all cards
                document.querySelectorAll('.stage-card').forEach(c => {
                    c.classList.remove('active');
                });

                // Open clicked card if it wasn't active
                if (!isActive) {
                    card.classList.add('active');
                    this.currentStage = stage;
                    this.completedStages.add(stage);
                    this.updateProgress();
                    this.scrollToCard(card);
                    this.animateCardContent(card);
                }
            }

            scrollToCard(card) {
                setTimeout(() => {
                    card.scrollIntoView({
                        behavior: 'smooth',
                        block: 'nearest'
                    });
                }, 300);
            }

            animateCardContent(card) {
                const contentSections = card.querySelectorAll('.content-section');
                contentSections.forEach((section, index) => {
                    setTimeout(() => {
                        section.classList.add('fade-in');
                    }, index * 100);
                });
            }

            setupProgressNavigation() {
                const progressSteps = document.querySelectorAll('.progress-step');
                
                progressSteps.forEach(step => {
                    step.addEventListener('click', () => {
                        const target = step.dataset.target;
                        const targetCard = document.querySelector(`[data-stage="${target}"]`);
                        
                        if (targetCard) {
                            this.toggleCard(targetCard);
                        }
                    });
                });
            }

            updateProgress() {
                const progressSteps = document.querySelectorAll('.progress-step');
                const stages = ['assessment', 'diagnosis', 'treatment', 'followup'];
                
                progressSteps.forEach((step, index) => {
                    const stage = stages[index];
                    const isCompleted = this.completedStages.has(stage);
                    const isCurrent = this.currentStage === stage;
                    
                    step.classList.toggle('active', isCurrent);
                    
                    const statusElement = step.querySelector('.step-status');
                    if (isCurrent) {
                        statusElement.textContent = 'In Progress';
                        statusElement.style.color = '#2563eb';
                    } else if (isCompleted) {
                        statusElement.textContent = 'Completed';
                        statusElement.style.color = '#059669';
                        step.style.opacity = '0.7';
                    } else {
                        statusElement.textContent = 'Not Started';
                        statusElement.style.color = '#64748b';
                    }
                });
            }

            setupChecklistHandling() {
                const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        const item = e.target.closest('.checklist-item');
                        if (item) {
                            if (e.target.checked) {
                                item.style.opacity = '0.7';
                                item.style.textDecoration = 'line-through';
                            } else {
                                item.style.opacity = '1';
                                item.style.textDecoration = 'none';
                            }
                        }
                        
                        this.updateChecklistProgress();
                    });
                });
            }

            updateChecklistProgress() {
                const checklists = document.querySelectorAll('.interactive-checklist');
                
                checklists.forEach(checklist => {
                    const items = checklist.querySelectorAll('input[type="checkbox"]');
                    const checkedItems = checklist.querySelectorAll('input[type="checkbox"]:checked');
                    const progress = (checkedItems.length / items.length) * 100;
                    
                    // Add visual progress indicator
                    const progressBar = checklist.querySelector('.checklist-progress');
                    if (!progressBar) {
                        const progressDiv = document.createElement('div');
                        progressDiv.className = 'checklist-progress';
                        progressDiv.style.cssText = `
                            height: 4px;
                            background: #e2e8f0;
                            border-radius: 2px;
                            margin-top: 0.75rem;
                            overflow: hidden;
                        `;
                        
                        const progressFill = document.createElement('div');
                        progressFill.style.cssText = `
                            height: 100%;
                            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
                            width: ${progress}%;
                            transition: width 0.5s ease;
                        `;
                        
                        progressDiv.appendChild(progressFill);
                        checklist.appendChild(progressDiv);
                    } else {
                        const progressFill = progressBar.querySelector('div');
                        progressFill.style.width = `${progress}%`;
                    }
                });
            }

            initializeAnimations() {
                // Add staggered animation to cards on load
                const cards = document.querySelectorAll('.stage-card');
                cards.forEach((card, index) => {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    
                    setTimeout(() => {
                        card.style.transition = 'all 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, index * 200);
                });

                // Add pulse animation to urgent alerts
                const urgentAlerts = document.querySelectorAll('.badge-danger');
                urgentAlerts.forEach(alert => {
                    alert.classList.add('pulse');
                });
            }

            setupKeyboardNavigation() {
                document.addEventListener('keydown', (e) => {
                    const cards = Array.from(document.querySelectorAll('.stage-card'));
                    const activeCard = document.querySelector('.stage-card.active');
                    const currentIndex = cards.indexOf(activeCard);
                    
                    switch(e.key) {
                        case 'ArrowRight':
                        case 'ArrowDown':
                            e.preventDefault();
                            const nextIndex = (currentIndex + 1) % cards.length;
                            this.toggleCard(cards[nextIndex]);
                            break;
                        case 'ArrowLeft':
                        case 'ArrowUp':
                            e.preventDefault();
                            const prevIndex = currentIndex <= 0 ? cards.length - 1 : currentIndex - 1;
                            this.toggleCard(cards[prevIndex]);
                            break;
                        case 'Escape':
                            if (activeCard) {
                                activeCard.classList.remove('active');
                            }
                            break;
                    }
                });
            }

            setupPrintFunctionality() {
                // Add print button to header
                const header = document.querySelector('.header');
                const printButton = document.createElement('button');
                printButton.innerHTML = '<i class="fas fa-print"></i> Print Guidelines';
                printButton.style.cssText = `
                    background: rgba(255, 255, 255, 0.2);
                    border: 1px solid rgba(255, 255, 255, 0.3);
                    color: white;
                    padding: 0.5rem 1rem;
                    border-radius: 6px;
                    cursor: pointer;
                    margin-left: 1rem;
                    transition: all 0.3s ease;
                    backdrop-filter: blur(10px);
                `;
                
                printButton.addEventListener('click', () => {
                    this.showLoadingOverlay();
                    setTimeout(() => {
                        window.print();
                        this.hideLoadingOverlay();
                    }, 500);
                });
                
                printButton.addEventListener('mouseenter', () => {
                    printButton.style.background = 'rgba(255, 255, 255, 0.3)';
                });
                
                printButton.addEventListener('mouseleave', () => {
                    printButton.style.background = 'rgba(255, 255, 255, 0.2)';
                });
                
                header.appendChild(printButton);
            }

            showLoadingOverlay() {
                const overlay = document.getElementById('loadingOverlay');
                overlay.classList.add('active');
            }

            hideLoadingOverlay() {
                const overlay = document.getElementById('loadingOverlay');
                overlay.classList.remove('active');
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            new HypertensionGuidelines();
            
            // Add smooth scrolling for all internal links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            // Add click-to-copy functionality for BP values
            const bpValues = document.querySelectorAll('.bp-values');
            bpValues.forEach(value => {
                value.style.cursor = 'pointer';
                value.title = 'Click to copy';
                
                value.addEventListener('click', () => {
                    const text = value.textContent;
                    navigator.clipboard.writeText(text).then(() => {
                        const originalContent = value.innerHTML;
                        value.innerHTML = '<i class="fas fa-check" style="color: #10b981;"></i> Copied!';
                        setTimeout(() => {
                            value.innerHTML = originalContent;
                        }, 1000);
                    });
                });
            });

            // Add hover effects for drug items
            const drugItems = document.querySelectorAll('.drug-item');
            drugItems.forEach(item => {
                item.addEventListener('mouseenter', () => {
                    item.style.transform = 'translateY(-2px)';
                });
                
                item.addEventListener('mouseleave', () => {
                    item.style.transform = 'translateY(0)';
                });
            });

            // Add search functionality
            const searchInput = document.createElement('input');
            searchInput.type = 'text';
            searchInput.placeholder = 'Search guidelines...';
            searchInput.style.cssText = `
                position: fixed;
                top: 1rem;
                right: 1rem;
                padding: 0.5rem 1rem;
                border: 1px solid #e2e8f0;
                border-radius: 6px;
                font-size: 0.9rem;
                width: 250px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                z-index: 100;
            `;
            
            searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                const contentSections = document.querySelectorAll('.content-section');
                
                contentSections.forEach(section => {
                    const text = section.textContent.toLowerCase();
                    const isVisible = text.includes(searchTerm);
                    section.style.display = isVisible ? 'block' : 'none';
                    
                    if (isVisible && searchTerm.length > 0) {
                        section.style.background = '#fef3c7';
                        section.style.border = '1px solid #fbbf24';
                    } else {
                        section.style.background = '';
                        section.style.border = '';
                    }
                });
                
                // Highlight matching cards
                const cards = document.querySelectorAll('.stage-card');
                cards.forEach(card => {
                    const text = card.textContent.toLowerCase();
                    const hasMatch = text.includes(searchTerm);
                    card.style.opacity = hasMatch || searchTerm.length === 0 ? '1' : '0.5';
                });
            });
            
            document.body.appendChild(searchInput);
        });

        // Add service worker for offline capability
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:text/javascript;base64,' + btoa(`
                self.addEventListener('install', event => {
                    event.waitUntil(
                        caches.open('hypertension-guidelines-v1').then(cache => {
                            return cache.addAll([
                                '/',
                                '/style.css',
                                '/script.js'
                            ]);
                        })
                    );
                });
                
                self.addEventListener('fetch', event => {
                    event.respondWith(
                        caches.match(event.request).then(response => {
                            return response || fetch(event.request);
                        })
                    );
                });
            `)).then(() => {
                console.log('Service Worker registered for offline access');
            }).catch((error) => {
                console.log('Service Worker registration failed:', error);
            });
        }
    </script>
</body>
</html>