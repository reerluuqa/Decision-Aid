<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IUC Quick Reference Algorithm</title>
  <style>
    /* CSS Variables for theming */
    :root {
      --bg: #0b0c0f;           /* used in dark mode */
      --panel: #11131a;
      --fg: #eaeef6;
      --muted: #9aa4b2;
      --brand: #4f46e5;
      --accent: #06b6d4;
      --ok: #16a34a;
      --warn: #f59e0b;
      --bad: #ef4444;
      --card: #0f1219;
      --border: #1e2430;
      --shadow: 0 10px 30px rgba(0,0,0,.25);
    }

    [data-theme="light"] {
      --bg: #f7f8fb;
      --panel: #ffffff;
      --fg: #0b1220;
      --muted: #5b6472;
      --brand: #3b82f6;
      --accent: #0891b2;
      --ok: #15803d;
      --warn: #b45309;
      --bad: #b91c1c;
      --card: #ffffff;
      --border: #e6e9f2;
      --shadow: 0 6px 20px rgba(82,96,112,.12);
    }

    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--fg); background: linear-gradient(180deg, var(--bg), color-mix(in srgb, var(--bg) 92%, #ffffff 8%));
      -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility;
    }

    .wrap { max-width: 1200px; margin: 0 auto; padding: clamp(16px, 2vw, 28px); }

    /* Header */
    .header { position: sticky; top: 0; z-index: 30; backdrop-filter: saturate(140%) blur(8px);
      background: color-mix(in srgb, var(--bg) 75%, rgba(255,255,255,.2)); border-bottom: 1px solid var(--border); }
    .header-inner { display: flex; align-items: center; justify-content: space-between; gap: 12px; padding: 14px 0; }

    .brand { display: flex; align-items: center; gap: 12px; }
    .brand .logo { width: 36px; height: 36px; display: grid; place-items: center; border-radius: 12px; background: linear-gradient(135deg, var(--brand), var(--accent)); box-shadow: var(--shadow); }
    .brand h1 { font-size: clamp(18px, 3vw, 24px); margin: 0; letter-spacing: .3px; }
    .brand .sub { font-size: 12px; color: var(--muted); margin-left: 6px; }

    .tools { display: flex; gap: 8px; align-items: center; }
    .btn { appearance: none; border: 1px solid var(--border); background: var(--panel); color: var(--fg); padding: 10px 14px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: .2s ease; box-shadow: var(--shadow); }
    .btn:hover { transform: translateY(-1px); }
    .btn.primary { background: linear-gradient(135deg, var(--brand), var(--accent)); border: none; color: white; }

    .search { display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--panel); border: 1px solid var(--border); border-radius: 12px; min-width: 300px; }
    .search input { flex: 1; border: none; outline: none; background: transparent; color: var(--fg); font-size: 14px; }

    /* Hero strip */
    .hero { margin: 18px 0 12px; display: grid; grid-template-columns: 1.2fr .8fr; gap: 16px; }
    .hero-card { background: var(--card); border: 1px solid var(--border); border-radius: 18px; padding: clamp(16px, 2.5vw, 22px); box-shadow: var(--shadow); }
    .hero h2 { margin: 0 0 8px; font-size: clamp(18px, 2.5vw, 22px); }
    .kpis { display: grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap: 10px; margin-top: 10px; }
    .kpi { background: color-mix(in srgb, var(--panel) 70%, rgba(255,255,255,.07)); border: 1px dashed var(--border); border-radius: 12px; padding: 12px; }
    .kpi b { display: block; font-size: 18px; }
    .kpi small { color: var(--muted); }

    /* Grid */
    .grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 16px; }
    .card { grid-column: span 6; background: var(--card); border: 1px solid var(--border); border-radius: 18px; padding: 18px; box-shadow: var(--shadow); }
    .card.full { grid-column: 1 / -1; }
    .card.third { grid-column: span 4; }
    .card h3 { margin: 0 0 10px; display: flex; align-items: center; gap: 8px; font-size: clamp(16px, 2vw, 18px); }
    .card p, .card li { line-height: 1.5; }
    .pill { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 999px; background: color-mix(in srgb, var(--brand) 15%, transparent); border: 1px solid var(--border); color: var(--brand); font-weight: 700; font-size: 12px; letter-spacing: .2px; }

    ul.clean { margin: 8px 0 0 0; padding: 0 0 0 18px; }
    ul.tight > li { margin: 4px 0; }

    /* Details blocks */
    details { border: 1px solid var(--border); border-radius: 12px; padding: 12px 14px; background: color-mix(in srgb, var(--panel) 70%, rgba(255,255,255,.06)); }
    details + details { margin-top: 10px; }
    summary { font-weight: 700; cursor: pointer; }

    .bad { color: var(--bad); }
    .warn { color: var(--warn); }
    .ok { color: var(--ok); }

    .footer { margin: 24px 0 10px; color: var(--muted); font-size: 12px; text-align: center; }

    /* Print styles: compress to one A4 page */
    @media print {
      @page { size: A4 portrait; margin: 12mm; }
      body { background: white; }
      .header, .tools { display: none !important; }
      .hero { grid-template-columns: 1fr; }
      .grid { gap: 10px; }
      .card { padding: 12px; border-radius: 10px; }
      .card.third { grid-column: span 4; }
      .card { box-shadow: none; }
      .wrap { padding: 0; }
    }

    /* Responsive */
    @media (max-width: 980px) {
      .hero { grid-template-columns: 1fr; }
      .grid { grid-template-columns: repeat(6, 1fr); }
      .card.third { grid-column: span 6; }
      .search { min-width: 0; flex: 1; }
    }
    @media (max-width: 640px) {
      .grid { grid-template-columns: repeat(1, 1fr); }
      .card { grid-column: 1 / -1; }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="wrap header-inner">
      <div class="brand" aria-label="App brand">
        <div class="logo" aria-hidden="true">
          <!-- Simple spiral SVG icon -->
          <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 6a6 6 0 1 1-6 6"/>
            <path d="M12 2a10 10 0 1 1-10 10" opacity=".5"/>
          </svg>
        </div>
        <div>
          <h1>IUC Quick Reference Algorithm</h1>
          <div class="sub">Levonorgestrel & Copper Intrauterine Contraception – concise clinical aide</div>
        </div>
      </div>
      <div class="tools">
        <label class="search" aria-label="Filter content">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="11" cy="11" r="8"/><path d="m21 21-3.5-3.5"/></svg>
          <input id="q" placeholder="Filter… e.g. \"postpartum\", \"EC\"" />
        </label>
        <button class="btn" id="themeToggle" aria-pressed="false" aria-label="Toggle dark mode">Toggle theme</button>
        <button class="btn primary" onclick="window.print()" aria-label="Print this page">Print</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- HERO STRIP: micro-algorithm + key durations -->
    <section class="hero" aria-label="Overview">
      <div class="hero-card" aria-label="Algorithm strip">
        <h2>Fast Pathway</h2>
        <ol class="tight" style="margin:8px 0 0 18px;">
          <li><b>Assess</b>: UKMEC, history, STI risk, <em>exclude pregnancy</em>, obtain consent, pelvic exam.</li>
          <li><b>Choose</b>: <span class="pill">LNG‑IUD</span> for HMB/dysmenorrhoea benefits; <span class="pill">Cu‑IUD</span> for non‑hormonal or EC.</li>
          <li><b>Insert</b>: <span class="pill">Anytime if not pregnant</span> → <b>LNG</b> needs <u>7d extra protection</u> unless day 1–5; <b>Cu</b> immediate.</li>
          <li><b>Aftercare</b>: no routine check; threads at 4–6w; counsel on red flags; plan replacement/removal.</li>
        </ol>
      </div>
      <div class="hero-card" aria-label="Key durations">
        <h2>Durations & Highlights</h2>
        <div class="kpis">
          <div class="kpi"><small>LNG‑IUD (device‑dependent)</small><b>3–8 years</b></div>
          <div class="kpi"><small>Cu‑IUD</small><b>5–10 years</b></div>
          <div class="kpi"><small>Post‑partum</small><b>≤48h or ≥4w</b></div>
          <div class="kpi"><small>Post‑abortion</small><b>Immediate</b></div>
        </div>
      </div>
    </section>

    <!-- GRID CONTENT -->
    <section class="grid" id="content">
      <article class="card third" data-tags="assessment ukmec sti exam consent pregnancy">
        <h3>
          <span class="pill">1</span> Initial Assessment
        </h3>
        <ul class="clean tight">
          <li>Confirm <b>UKMEC</b> eligibility and full medical & sexual history.</li>
          <li>Assess <b>STI risk</b>; offer testing/cervical screening where appropriate.</li>
          <li><b>Exclude pregnancy</b> (history ± high‑sensitivity urine test when indicated).</li>
          <li>Provide informed consent: effectiveness, side‑effects, risks (bleeding, pain, perforation, expulsion, infection), procedure.</li>
          <li>Perform <b>bimanual pelvic exam</b> immediately prior to insertion.</li>
        </ul>
      </article>

      <article class="card third" data-tags="device choice LNG Mirena Levosert Jaydess Kyleena copper non hormonal HMB dysmenorrhoea EC">
        <h3>
          <span class="pill">2</span> Device Choice
        </h3>
        <details open>
          <summary>Levonorgestrel IUD (LNG‑IUD)</summary>
          <ul class="clean tight">
            <li>Brands include 52 mg (e.g., Mirena®, Levosert®, Benilexa®), 19.5 mg (Kyleena®), 13.5 mg (Jaydess®).</li>
            <li><b>3–8 years</b> use depending on device; fertility returns on removal.</li>
            <li>Helps <b>HMB</b>, may improve <b>dysmenorrhoea</b>; endometrial protection with HRT.</li>
          </ul>
        </details>
        <details>
          <summary>Copper IUD (Cu‑IUD)</summary>
          <ul class="clean tight">
            <li>Non‑hormonal, ≥300 mm² copper; various shapes/sizes.</li>
            <li><b>5–10 years</b> use; if inserted ≥40y, can remain until menopause.</li>
            <li><b>First‑line EC</b>; immediate contraceptive effect.</li>
          </ul>
        </details>
      </article>

      <article class="card third" data-tags="timing insertion postpartum postabortion day 1-5 cycle immediate protection 7 days">
        <h3>
          <span class="pill">3</span> Timing of Insertion
        </h3>
        <ul class="clean tight">
          <li><b>LNG‑IUD</b>: insert any time if not pregnant → <u>extra protection for 7 days</u> unless inserted day 1–5 of natural cycle.</li>
          <li><b>Cu‑IUD</b>: insert any time if not pregnant → <b>immediate</b> protection.</li>
          <li><b>Post‑partum</b>: within <b>48h</b> of birth or from <b>4 weeks</b> onward.</li>
          <li><b>Post‑abortion/miscarriage</b>: usually immediate after completion of pregnancy tissue expulsion/procedure.</li>
        </ul>
      </article>

      <article class="card third" data-tags="switching replacement overlap condoms CHC POP implant injection UPSI pregnancy test EC">
        <h3>
          <span class="pill">4</span> Switching & Replacement
        </h3>
        <ul class="clean tight">
          <li>From <b>hormonal methods</b> (CHC/POP/implant/injectable): time insertion to active use windows or use <b>condoms ×7d</b> if not perfectly aligned.</li>
          <li><b>Replacing</b> IUD within licensed duration: immediate swap usually acceptable once pregnancy is excluded.</li>
          <li>If out of licence or UPSI in last 21d, follow pregnancy testing/EC pathways before inserting.</li>
        </ul>
      </article>

      <article class="card third" data-tags="aftercare threads check review red flags stis condoms">
        <h3>
          <span class="pill">5</span> Aftercare
        </h3>
        <ul class="clean tight">
          <li>No routine post‑insertion check required.</li>
          <li>Advise thread check at <b>4–6 weeks</b>, then periodically (e.g., monthly or post‑menses).</li>
          <li>No STI protection → use <b>condoms</b> if risk.</li>
          <li><b>Urgent review</b> for pelvic pain, fever, abnormal bleeding, lost threads, or positive pregnancy test.</li>
        </ul>
      </article>

      <article class="card third" data-tags="removal menopause planned pregnancy EC UPSI 7 days fertility returns">
        <h3>
          <span class="pill">6</span> Removal
        </h3>
        <ul class="clean tight">
          <li>Remove at any time; <b>fertility returns immediately</b>.</li>
          <li>If <b>UPSI in last 7 days</b>: defer if possible or consider <b>EC</b> and <b>pregnancy test at 21d</b> after last UPSI.</li>
          <li><b>Menopause</b>: contraception not required ≥55y; for Cu‑IUD users ≥50y, may stop after ≥12 months amenorrhoea (then remove device).</li>
        </ul>
      </article>

      <article class="card full" data-tags="complications infection pid malposition expulsion non visible threads pregnancy perforation bleeding">
        <h3>
          <span class="pill">7</span> Complications – What to Do</h3>
        <div class="grid" style="gap:12px; grid-template-columns: repeat(12,1fr);">
          <div class="card" style="grid-column: span 4;">
            <h4 class="warn" style="margin:0 0 6px;">Infection / PID</h4>
            <ul class="clean tight">
              <li>Start appropriate <b>antibiotics</b>; review at 48–72h.</li>
              <li>Consider <b>removal</b> if not improving or patient preference.</li>
              <li>If removed and UPSI within 7d → consider <b>EC</b> + plan <b>pregnancy testing</b>.</li>
            </ul>
          </div>
          <div class="card" style="grid-column: span 4;">
            <h4 class="warn" style="margin:0 0 6px;">Malposition / Expulsion</h4>
            <ul class="clean tight">
              <li>Manage case‑by‑case; typically <b>remove & replace</b> if >2 cm from fundus, in cervix, or symptomatic (pain/bleeding).</li>
              <li>Assess UPSI → need for EC/pregnancy testing; consider imaging accuracy.</li>
            </ul>
          </div>
          <div class="card" style="grid-column: span 4;">
            <h4 class="warn" style="margin:0 0 6px;">Non‑visible Threads</h4>
            <ul class="clean tight">
              <li>Exclude <b>expulsion</b>; consider <b>TVUS</b> ± hysteroscopy where needed.</li>
            </ul>
          </div>
          <div class="card" style="grid-column: span 4;">
            <h4 class="bad" style="margin:0 0 6px;">Pregnancy with IUD in situ</h4>
            <ul class="clean tight">
              <li>Follow early pregnancy pathways to confirm location.</li>
              <li>If intrauterine and <b>&lt;12 weeks</b> with visible threads → usually <b>remove</b> device to improve outcomes.</li>
            </ul>
          </div>
          <div class="card" style="grid-column: span 4;">
            <h4 class="bad" style="margin:0 0 6px;">Suspected Perforation</h4>
            <ul class="clean tight">
              <li>At insertion: stop, remove, observe vitals.</li>
              <li>Later: arrange <b>US ± X‑ray</b> urgently; avoid intercourse or use condoms; consider EC/testing.</li>
              <li>Wait <b>≥6 weeks</b> before re‑insertion; consider specialist setting with ultrasound.</li>
            </ul>
          </div>
          <div class="card" style="grid-column: span 4;">
            <h4 class="warn" style="margin:0 0 6px;">Unscheduled Bleeding</h4>
            <ul class="clean tight">
              <li>Exclude <b>pregnancy, STI, pathology</b> (speculum exam if persistent/new change; consider TVUS/hysteroscopy).</li>
              <li>If benign: reassure; consider <b>NSAIDs</b>, <b>tranexamic acid</b> or short course <b>COC</b> if suitable.</li>
              <li>Refer if cause unclear or anaemia/persistent heavy bleeding.</li>
            </ul>
          </div>
        </div>
      </article>

      <article class="card full" data-tags="tips cues remember EC HMB threads stis">
        <h3>
          <span class="pill">✓</span> Quick Tips
        </h3>
        <ul class="clean tight">
          <li><b>Cu‑IUD</b> doubles as the most effective <b>emergency contraception</b> and can be left for ongoing use.</li>
          <li><b>LNG‑IUD</b> offers additional benefit for <b>heavy menstrual bleeding</b> and painful periods.</li>
          <li><b>No drug interactions</b> affect IUC effectiveness; BMI does not reduce efficacy.</li>
          <li>Thread check at 4–6 weeks; no routine clinic visit required unless concerns.</li>
        </ul>
      </article>
    </section>

    <p class="footer">Designed for rapid point‑of‑care use. Based on national guidance current to 2024. Use clinical judgement and local pathways where applicable.</p>
  </main>

  <script>
    // Theme toggle
    const toggle = document.getElementById('themeToggle');
    const setTheme = (t) => document.documentElement.setAttribute('data-theme', t);
    const getTheme = () => document.documentElement.getAttribute('data-theme') || 'light';
    toggle.addEventListener('click', () => {
      const next = getTheme() === 'light' ? 'dark' : 'light';
      setTheme(next);
      toggle.setAttribute('aria-pressed', next === 'dark');
    });

    // Simple content filter
    const q = document.getElementById('q');
    const cards = [...document.querySelectorAll('#content .card')];
    q.addEventListener('input', () => {
      const term = q.value.trim().toLowerCase();
      cards.forEach(c => {
        if (!term) { c.style.display = ''; return; }
        const text = (c.innerText + ' ' + (c.getAttribute('data-tags')||'')).toLowerCase();
        c.style.display = text.includes(term) ? '' : 'none';
      });
    });

    // Respect prefers-color-scheme
    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (prefersDark) setTheme('dark');
  </script>
</body>
</html>
