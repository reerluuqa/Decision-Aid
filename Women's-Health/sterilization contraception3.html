<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sterilization — One‑Page Clinical Algorithm (NICE CKS 2024)</title>
  <style>
    :root{
      --bg: #0b1020;            /* deep navy */
      --panel: #11162a;         /* card background */
      --ink: #e7ecf7;           /* primary text */
      --muted: #b7c0d9;         /* secondary text */
      --accent: #5ee1ad;        /* mint */
      --accent-2: #8aa2ff;      /* cornflower */
      --danger: #ff7a7a;        /* soft red */
      --warn: #ffd166;          /* warm yellow */
      --ok: #56e39f;            /* green */
      --chip: rgba(255,255,255,0.06);
      --hair: rgba(255,255,255,0.08);
      --ring: rgba(142, 197, 255, 0.35);
    }

    @media (prefers-color-scheme: light) {
      :root{
        --bg: #f7f9fc;
        --panel: #ffffff;
        --ink: #0e1225;
        --muted: #475070;
        --accent: #0ea5e9;
        --accent-2: #7c3aed;
        --danger: #e11d48;
        --warn: #b45309;
        --ok: #059669;
        --chip: rgba(15,23,42,0.06);
        --hair: rgba(15,23,42,0.08);
        --ring: rgba(14,165,233,0.25);
      }
    }

    [data-theme="light"]:root{ /* optional manual light mode */ }

    html, body{
      height:100%;
      background: radial-gradient(1200px 600px at 90% -10%, rgba(142,197,255,0.12), transparent 60%),
                  radial-gradient(900px 500px at -10% 10%, rgba(94,225,173,0.12), transparent 60%),
                  var(--bg);
      color: var(--ink);
      font: 500 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .wrap{
      max-width: 1100px;
      margin: 24px auto 96px;
      padding: 0 20px;
    }

    /* Header */
    .appbar{
      position: sticky;
      top: 0;
      backdrop-filter: saturate(140%) blur(10px);
      -webkit-backdrop-filter: saturate(140%) blur(10px);
      background: color-mix(in hsl, var(--bg), transparent 65%);
      border-bottom: 1px solid var(--hair);
      z-index: 50;
    }
    .appbar-inner{ display:flex; align-items:center; justify-content:space-between; gap:14px; padding: 14px 20px; }
    .title{
      display:flex; align-items:center; gap:12px;
    }
    .title h1{ font-size: clamp(18px, 3.2vw, 28px); margin:0; letter-spacing: 0.2px; }
    .subtitle{ color: var(--muted); font-size: 13px; }

    .controls{ display:flex; gap:8px; align-items:center; }
    .btn{
      appearance:none; border:1px solid var(--hair); background: var(--panel); color: var(--ink);
      padding: 8px 12px; border-radius: 12px; font-weight: 600; cursor:pointer; transition: transform .05s ease, border-color .2s ease, background .2s ease; display:inline-flex; gap:8px; align-items:center; box-shadow: 0 1px 0 var(--hair) inset, 0 0 0 0 rgba(0,0,0,0);
    }
    .btn:hover{ border-color: var(--ring); }
    .btn:active{ transform: translateY(1px); }

    /* Hero */
    .hero{ margin-top: 28px; display:grid; grid-template-columns: 1.1fr .9fr; gap: 18px; }
    .card{
      background: color-mix(in hsl, var(--panel), transparent 0%);
      border: 1px solid var(--hair);
      border-radius: 16px;
      padding: 18px 18px 14px;
      box-shadow: 0 0 0 1px rgba(255,255,255,0.02) inset, 0 8px 20px -10px rgba(0,0,0,.35);
    }
    .card h2{ margin:0 0 12px; font-size: clamp(16px, 2.6vw, 22px); letter-spacing:.2px; }
    .lead{ color: var(--muted); margin-top:6px; }

    .chips{ display:flex; flex-wrap:wrap; gap:8px; margin-top: 10px; }
    .chip{ font-size: 13px; padding: 6px 10px; border-radius: 999px; background: var(--chip); border:1px solid var(--hair); }
    .kpi-row{ display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:10px; }
    .kpi{
      background: linear-gradient(180deg, color-mix(in hsl, var(--panel), transparent 0%), color-mix(in hsl, var(--panel), transparent 10%));
      border:1px solid var(--hair); border-radius:14px; padding:12px; display:flex; flex-direction:column; gap:4px; min-height:70px; justify-content: center;
    }
    .kpi .v{ font-size: 18px; font-weight:800; letter-spacing:.2px; }
    .kpi .t{ color: var(--muted); font-size: 12px; }

    /* Algorithm Columns */
    .grid{ display:grid; grid-template-columns: repeat(12, 1fr); gap:14px; margin-top: 18px; }
    .col{ grid-column: span 6; }
    .col-4{ grid-column: span 4; }
    .col-8{ grid-column: span 8; }

    .step{ position:relative; padding-top:10px; }
    .step .num{ width:26px; height:26px; border-radius:50%; background: var(--accent-2); color:#fff; display:inline-grid; place-items:center; font-weight:800; font-size:13px; box-shadow: 0 4px 12px -6px var(--accent-2); }
    .step h3{ margin:10px 0 8px; font-size: 16px; letter-spacing:.2px; }
    .step ul{ margin:0; padding-left: 20px; }
    .step li{ margin:4px 0; }

    .callout{ border-left: 4px solid var(--accent); padding: 10px 12px; border-radius: 12px; background: linear-gradient(90deg, rgba(94,225,173,0.08), transparent 60%); }
    .callout.warn{ border-left-color: var(--warn); background: linear-gradient(90deg, rgba(255,209,102,0.12), transparent 60%); }
    .callout.danger{ border-left-color: var(--danger); background: linear-gradient(90deg, rgba(255,122,122,0.1), transparent 60%); }

    /* Footer */
    footer { margin-top: 22px; color: var(--muted); font-size: 12px; display:flex; align-items:center; gap:8px; }

    /* Utilities */
    .muted{ color: var(--muted); }
    .flex{ display:flex; gap:8px; align-items:center; }
    .icon{ width:18px; height:18px; opacity:.9; }
    .spacer{ height: 16px; }

    /* Responsive */
    @media (max-width: 980px){ .hero{ grid-template-columns: 1fr; } .kpi-row{ grid-template-columns: repeat(2,minmax(0,1fr)); } .col{ grid-column: span 12; } .col-4{ grid-column: span 12;} .col-8{ grid-column: span 12;} }

    /* Print — aims to fit on one A4 page */
    @media print {
      @page { size: A4; margin: 10mm; }
      .appbar, .controls { display:none !important; }
      body { background: #fff !important; }
      .wrap { margin: 0; }
      .card { break-inside: avoid; box-shadow: none; border-color: #e5e7eb; }
      .kpi-row { grid-template-columns: repeat(4,minmax(0,1fr)); }
      .step h3 { font-size: 13pt; }
      body{ font-size: 11pt; }
    }

    /* Compact mode toggles slightly tighter rhythm */
    body.compact .card{ padding:14px 14px 10px; }
    body.compact .kpi .v{ font-size: 16px; }
    body.compact .kpi{ min-height:60px; }
    body.compact .step li{ margin:2px 0; }
  </style>
</head>
<body>
  <header class="appbar">
    <div class="appbar-inner wrap">
      <div class="title">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M3 4h18M3 10h18M3 16h18M3 22h18" opacity=".25"/><rect x="4" y="5" width="6" height="3" rx="1.2"/><rect x="14" y="11" width="6" height="3" rx="1.2"/><rect x="4" y="17" width="6" height="3" rx="1.2"/></svg>
        <div>
          <h1>Sterilization — One‑Page Clinical Algorithm</h1>
          <div class="subtitle">NICE CKS (Feb 2024) • For rapid reference during consultations</div>
        </div>
      </div>
      <div class="controls" aria-label="page controls">
        <button class="btn" onclick="document.body.classList.toggle('compact')" title="Toggle compact mode">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2h-4"/><path d="M3 9V5a2 2 0 0 1 2-2h4"/><path d="M3 3l7 7"/><path d="M14 14l7 7"/></svg>
          Compact
        </button>
        <button class="btn" onclick="window.print()" title="Print (P)">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8" rx="2"/></svg>
          Print
        </button>
      </div>
    </div>
  </header>

  <main class="wrap" id="main">
    <section class="hero">
      <div class="card">
        <h2 class="flex">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 20l9-5-9-5-9 5 9 5z"/><path d="M12 12l9-5-9-5-9 5 9 5z"/></svg>
          Scope & Core Principles
        </h2>
        <p class="lead">Permanent contraception for adults (18–60). Either partner may undergo the procedure. Provide unbiased counselling and written information; sterilization does not protect against STIs.</p>
        <div class="chips" aria-label="quick tags">
          <span class="chip">Permanent</span>
          <span class="chip">Informed consent</span>
          <span class="chip">Offer LARC alternatives</span>
          <span class="chip">No STI protection</span>
        </div>
      </div>
      <div class="card">
        <h2 class="flex">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
          Quick Stats
        </h2>
        <div class="kpi-row" role="list">
          <div class="kpi" role="listitem"><div class="v">0.05%</div><div class="t">Vasectomy lifetime failure (≈1/2000)</div></div>
          <div class="kpi" role="listitem"><div class="v">0.5%</div><div class="t">Tubal occlusion lifetime failure (≈1/200)</div></div>
          <div class="kpi" role="listitem"><div class="v">2.4–7.3 / 1000</div><div class="t">10‑yr ectopic after failure</div></div>
          <div class="kpi" role="listitem"><div class="v">2 / 1000</div><div class="t">Laparotomy after laparoscopy complication</div></div>
        </div>
        <div class="chips" style="margin-top:10px">
          <span class="chip">Laparoscopy mortality ~1/12,000</span>
          <span class="chip">Filshie clip 10‑yr failure ≈1/333–500</span>
          <span class="chip">CPVP 1–14%</span>
        </div>
      </div>
    </section>

    <div class="spacer"></div>

    <section class="grid" aria-label="Algorithm">
      <div class="card col step">
        <span class="num" aria-hidden="true">1</span>
        <h3>Confirm Suitability</h3>
        <ul>
          <li>Apply WHO MEC; confirm age & capacity to consent.</li>
          <li>Assess understanding of permanence & <em>regret risk</em>.</li>
          <li>Consider partner suitability; either may proceed.</li>
          <li>Discuss LARC options (IUD/IUS/implant/injection) and relative efficacy.</li>
        </ul>
        <div class="callout" style="margin-top:8px"><strong>Document:</strong> risks, benefits, alternatives, and provision of written info.</div>
      </div>

      <div class="card col step">
        <span class="num" aria-hidden="true">2</span>
        <h3>Shared Counselling — Key Messages (Both)</h3>
        <ul>
          <li><strong>Permanent</strong>; NHS does not routinely offer reversal.</li>
          <li>Failure can occur; pregnancy may be ectopic (female).</li>
          <li><strong>No STI protection</strong> — advise condoms if risk.</li>
          <li>Explain specific risks: surgical complications; CPVP (1–14%) post‑vasectomy.</li>
        </ul>
      </div>

      <div class="card col-6 step">
        <span class="num" aria-hidden="true">3</span>
        <h3>Male Sterilization (Vasectomy)</h3>
        <ul>
          <li>Technique: vas deferens interruption (scalpel or no‑scalpel) under local anaesthesia.</li>
          <li class="muted">Failure ≈ 1/2000 after negative semen testing.</li>
        </ul>
        <div class="callout" style="margin-top:8px"><strong>Aftercare</strong>
          <ul>
            <li>NSAIDs for discomfort; supportive underwear × 48h.</li>
            <li>Avoid strenuous activity until comfortable; no sex for 2–7 days.</li>
            <li><strong>Contraception until PVSA clearance</strong> — optimal PVSA at 12 weeks.</li>
            <li>Special clearance possible if &lt;100,000 non‑motile sperm/mL at ≥7 months.</li>
          </ul>
        </div>
        <div class="callout danger" style="margin-top:8px"><strong>Seek help if:</strong> persistent bleeding, infection, ongoing pain, rapidly enlarging unilateral scrotal haematoma.</div>
      </div>

      <div class="card col-6 step">
        <span class="num" aria-hidden="true">4</span>
        <h3>Female Sterilization (Tubal Occlusion)</h3>
        <ul>
          <li>Approaches: laparoscopic (clips/rings/diathermy), mini‑lap (rare), hysteroscopic (Essure® withdrawn).</li>
          <li class="muted">Failure ≈ 1/200 overall; <em>Filshie clip</em> 10‑yr ≈ 1/333–500.</li>
        </ul>
        <div class="callout" style="margin-top:8px"><strong>Aftercare</strong>
          <ul>
            <li>Analgesia; keep wounds clean/dry 1–2 days.</li>
            <li>Avoid strenuous activity & sex for ~1 week.</li>
            <li>Laparoscopic: continue CHC/POP/non‑hormonal contraception for ≥7 days; omit CHC hormone‑free interval if due peri‑procedure.</li>
            <li>Hysteroscopic: use backup until imaging confirms occlusion at ≥3 months.</li>
          </ul>
        </div>
        <div class="callout warn" style="margin-top:8px"><strong>Red flags:</strong> severe abdominal pain ± fever/LOA/vomiting (possible bowel injury); pain with missed period (possible ectopic); red swollen calf (DVT); dysuria/frequency (UTI); erythematous painful scars (infection).</div>
        <p class="muted" style="margin-top:8px">Laparoscopy risks: injuries requiring laparotomy (~2/1000), mortality ~1/12,000.</p>
      </div>

      <div class="card col-4 step">
        <span class="num" aria-hidden="true">5</span>
        <h3>Documentation Checklist</h3>
        <ul>
          <li>Indication, eligibility (WHO MEC), capacity & consent.</li>
          <li>Discussion of alternatives (LARC) & information leaflets provided.</li>
          <li>Risks incl. failure, ectopic (female), CPVP (male), surgical/anaesthetic risks.</li>
          <li>Post‑procedure contraception plan & PVSA instructions (if male).</li>
        </ul>
      </div>

      <div class="card col-8 step">
        <span class="num" aria-hidden="true">6</span>
        <h3>Patient‑facing Phrases (to streamline consult)</h3>
        <ul>
          <li>“Sterilization is intended to be permanent. The NHS usually doesn’t fund reversal.”</li>
          <li>“You’ll need to use contraception until your semen test at ~12 weeks confirms no sperm.”</li>
          <li>“Failure is uncommon, but if pregnancy occurs after female sterilization, please test early due to ectopic risk.”</li>
          <li>“We can also discuss very effective reversible options like IUDs or implants.”</li>
        </ul>
      </div>
    </section>

    <footer class="wrap" aria-label="meta">
      <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 20h9"/><path d="M12 4h9"/><path d="M4 9h16"/><path d="M4 15h16"/></svg>
      <span>Source: NICE Clinical Knowledge Summaries (CKS), Contraception – sterilization, last revised Feb 2024. For professional use.</span>
    </footer>
  </main>

  <script>
    // Keyboard shortcuts: P to print, C to toggle compact
    document.addEventListener('keydown', (e)=>{
      if ((e.key === 'p' || e.key === 'P') && !e.metaKey && !e.ctrlKey && !e.altKey){ e.preventDefault(); window.print(); }
      if (e.key === 'c' || e.key === 'C'){ document.body.classList.toggle('compact'); }
    });
  </script>
</body>
</html>