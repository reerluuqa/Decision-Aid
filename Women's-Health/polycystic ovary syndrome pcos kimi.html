<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PCOS Interactive Management Algorithm | BMJ Best Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2c3e50;
            --assessment: #3498db;
            --diagnosis: #9b59b6;
            --treatment: #27ae60;
            --followup: #e67e22;
            --danger: #e74c3c;
            --warning: #f39c12;
            --success: #27ae60;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --gray: #7f8c8d;
            --border: #ecf0f1;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            display: flex;
            max-width: 1600px;
            margin: 0 auto;
            min-height: 100vh;
            background: white;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
        }

        .progress-sidebar {
            width: 80px;
            background: var(--primary);
            position: sticky;
            top: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            z-index: 100;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .progress-dot.active {
            background: white;
            transform: scale(1.5);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .progress-dot:hover {
            background: rgba(255, 255, 255, 0.7);
            transform: scale(1.3);
        }

        .progress-dot::after {
            content: attr(data-step);
            position: absolute;
            left: 25px;
            top: -5px;
            width: 120px;
            color: white;
            font-size: 12px;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.3s ease;
            white-space: nowrap;
        }

        .progress-dot:hover::after {
            opacity: 1;
        }

        .main-content {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            max-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary) 0%, #34495e 100%);
            color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px var(--shadow);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .guideline-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.9em;
        }

        .step-card {
            background: white;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px var(--shadow);
            overflow: hidden;
            transition: all 0.3s ease;
            border-left: 8px solid;
        }

        .step-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .step-card.assessment {
            border-left-color: var(--assessment);
        }

        .step-card.diagnosis {
            border-left-color: var(--diagnosis);
        }

        .step-card.treatment {
            border-left-color: var(--treatment);
        }

        .step-card.followup {
            border-left-color: var(--followup);
        }

        .card-header {
            padding: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--light);
            transition: all 0.3s ease;
        }

        .step-card.assessment .card-header {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.1) 0%, rgba(52, 152, 219, 0.05) 100%);
        }

        .step-card.diagnosis .card-header {
            background: linear-gradient(135deg, rgba(155, 89, 182, 0.1) 0%, rgba(155, 89, 182, 0.05) 100%);
        }

        .step-card.treatment .card-header {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.1) 0%, rgba(39, 174, 96, 0.05) 100%);
        }

        .step-card.followup .card-header {
            background: linear-gradient(135deg, rgba(230, 126, 34, 0.1) 0%, rgba(230, 126, 34, 0.05) 100%);
        }

        .card-header:hover {
            background: white !important;
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            font-weight: bold;
        }

        .step-card.assessment .card-icon {
            background: var(--assessment);
        }

        .step-card.diagnosis .card-icon {
            background: var(--diagnosis);
        }

        .step-card.treatment .card-icon {
            background: var(--treatment);
        }

        .step-card.followup .card-icon {
            background: var(--followup);
        }

        .card-title h2 {
            font-size: 1.8em;
            color: var(--dark);
        }

        .expand-icon {
            font-size: 24px;
            color: var(--gray);
            transition: transform 0.3s ease;
        }

        .step-card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .step-card.expanded .card-content {
            max-height: 3000px;
        }

        .content-inner {
            padding: 0 25px 25px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section h3 {
            color: var(--dark);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
            font-size: 1.3em;
        }

        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            text-transform: uppercase;
            margin: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .badge-danger {
            background: var(--danger);
            color: white;
        }

        .badge-warning {
            background: var(--warning);
            color: white;
        }

        .badge-success {
            background: var(--success);
            color: white;
        }

        .badge-info {
            background: var(--assessment);
            color: white;
        }

        .sub-section {
            background: var(--light);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid var(--border);
        }

        .sub-section.critical {
            border-left-color: var(--danger);
            background: rgba(231, 76, 60, 0.05);
        }

        .sub-section.caution {
            border-left-color: var(--warning);
            background: rgba(243, 156, 18, 0.05);
        }

        .sub-section.stable {
            border-left-color: var(--success);
            background: rgba(39, 174, 96, 0.05);
        }

        .drug-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 2px 5px var(--shadow);
        }

        .drug-name {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1em;
        }

        .drug-dose {
            color: var(--gray);
            font-style: italic;
            margin: 5px 0;
        }

        .criteria-box {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid var(--primary);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .criteria-box h4 {
            color: var(--primary);
            margin-bottom: 15px;
        }

        .criteria-list {
            list-style: none;
            padding-left: 0;
        }

        .criteria-list li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .criteria-list li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--success);
            font-weight: bold;
        }

        .algorithm-path {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--light);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px dashed var(--border);
        }

        .arrow {
            color: var(--gray);
            font-size: 20px;
        }

        .complication-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .complication-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid var(--warning);
            box-shadow: 0 3px 10px var(--shadow);
        }

        .complication-card.high-risk {
            border-left-color: var(--danger);
        }

        .complication-card.moderate-risk {
            border-left-color: var(--warning);
        }

        .complication-card.low-risk {
            border-left-color: var(--success);
        }

        .floating-actions {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .fab {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .fab:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        .fab-print {
            background: var(--primary);
        }

        .fab-reset {
            background: var(--danger);
        }

        @media print {
            body {
                background: white;
            }
            
            .container {
                box-shadow: none;
            }
            
            .progress-sidebar,
            .floating-actions {
                display: none;
            }
            
            .step-card {
                box-shadow: none;
                border: 1px solid #ddd;
            }
            
            .card-content {
                max-height: none !important;
            }
            
            .expand-icon {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .progress-sidebar {
                width: 100%;
                height: auto;
                flex-direction: row;
                justify-content: center;
                padding: 10px;
                position: relative;
            }
            
            .progress-dot {
                margin: 0 10px;
            }
            
            .progress-dot::after {
                left: 50%;
                top: 30px;
                transform: translateX(-50%);
            }
            
            .main-content {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .card-title h2 {
                font-size: 1.4em;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .highlight {
            background: rgba(52, 152, 219, 0.1);
            border: 2px solid var(--assessment);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(52, 152, 219, 0); }
            100% { box-shadow: 0 0 0 0 rgba(52, 152, 219, 0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="progress-sidebar">
            <div class="progress-dot active" data-step="Assessment" onclick="scrollToSection('assessment')"></div>
            <div class="progress-dot" data-step="Diagnosis" onclick="scrollToSection('diagnosis')"></div>
            <div class="progress-dot" data-step="Treatment" onclick="scrollToSection('treatment')"></div>
            <div class="progress-dot" data-step="Follow-up" onclick="scrollToSection('followup')"></div>
        </div>

        <div class="main-content">
            <div class="header">
                <h1>PCOS Management Algorithm</h1>
                <p>Interactive Clinical Decision Support Tool</p>
                <div class="guideline-info">
                    Based on BMJ Best Practice Guidelines for Polycystic Ovary Syndrome (Last updated: Oct 16, 2025)
                </div>
            </div>

            <!-- Assessment Section -->
            <div class="step-card assessment" id="assessment">
                <div class="card-header" onclick="toggleSection('assessment')">
                    <div class="card-title">
                        <div class="card-icon">üìã</div>
                        <h2>Assessment</h2>
                    </div>
                    <span class="expand-icon">‚ñº</span>
                </div>
                <div class="card-content">
                    <div class="content-inner">
                        <div class="section">
                            <h3>History & Examination</h3>
                            <div class="sub-section">
                                <h4>Key Features to Assess</h4>
                                <ul style="margin-left: 20px;">
                                    <li><strong>Menstrual History:</strong> Irregular/infrequent periods (&lt;8 cycles/year), oligomenorrhea, amenorrhea</li>
                                    <li><strong>Hyperandrogenism:</strong> Hirsutism (60%), acne (20%), scalp hair loss (5%)</li>
                                    <li><strong>Weight:</strong> BMI, waist circumference (30-80% overweight/obese)</li>
                                    <li><strong>Infertility:</strong> Difficulty conceiving (common presenting complaint)</li>
                                    <li><strong>Psychological:</strong> Depression, anxiety, body image concerns</li>
                                </ul>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Risk Factors <span class="badge badge-info">Screening</span></h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                                <div class="sub-section critical">
                                    <strong>Strong Risk Factors:</strong>
                                    <ul style="margin-left: 20px; margin-top: 10px;">
                                        <li>Family history of PCOS (20-40% in first-degree relatives)</li>
                                        <li>Premature adrenarche (50% develop PCOS)</li>
                                        <li>Obesity (causal relationship)</li>
                                    </ul>
                                </div>
                                <div class="sub-section caution">
                                    <strong>Moderate Risk Factors:</strong>
                                    <ul style="margin-left: 20px; margin-top: 10px;">
                                        <li>Low birth weight / small for gestational age</li>
                                        <li>Environmental endocrine disruptors (e.g., bisphenol A)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Initial Investigations <span class="badge badge-warning">First-line</span></h3>
                            <div class="complication-grid">
                                <div class="drug-card">
                                    <div class="drug-name">Androgen Levels</div>
                                    <div class="drug-dose">Total/free testosterone, DHEAS, androstenedione</div>
                                    <span class="badge badge-warning">Follicular phase, morning</span>
                                    <span class="badge badge-warning">‚â•3 months off hormonal therapy</span>
                                </div>
                                <div class="drug-card">
                                    <div class="drug-name">Exclusion Tests</div>
                                    <div class="drug-dose">TSH, Prolactin, 17-hydroxyprogesterone</div>
                                    <span class="badge badge-success">Rules out mimics</span>
                                </div>
                                <div class="drug-card">
                                    <div class="drug-name">Metabolic Assessment</div>
                                    <div class="drug-dose">Oral glucose tolerance test, fasting lipids</div>
                                    <span class="badge badge-danger">40% have abnormal glucose</span>
                                </div>
                                <div class="drug-card">
                                    <div class="drug-name">Pelvic Ultrasound</div>
                                    <div class="drug-dose">‚â•20 follicles 2-9mm or ovarian volume ‚â•10mL</div>
                                    <span class="badge badge-info">Early follicular phase (day 3-5)</span>
                                    <span class="badge badge-warning">Adults: AMH may substitute</span>
                                </div>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Adolescent Considerations <span class="badge badge-warning">Special Population</span></h3>
                            <div class="sub-section caution">
                                <strong>Diagnostic Challenges:</strong>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li>Irregular cycles normal for 1-2 years post-menarche</li>
                                    <li>Ultrasound/AMH not recommended (poor specificity)</li>
                                    <li><strong>Diagnose if:</strong> Both oligo-anovulation AND hyperandrogenism present for ‚â•2 years</li>
                                    <li>Consider "at risk" if only one criterion met, reassess later</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Diagnosis Section -->
            <div class="step-card diagnosis" id="diagnosis">
                <div class="card-header" onclick="toggleSection('diagnosis')">
                    <div class="card-title">
                        <div class="card-icon">üî¨</div>
                        <h2>Diagnosis</h2>
                    </div>
                    <span class="expand-icon">‚ñº</span>
                </div>
                <div class="card-content">
                    <div class="content-inner">
                        <div class="section">
                            <h3>Diagnostic Criteria <span class="badge badge-info">Select One</span></h3>
                            
                            <div class="criteria-box">
                                <h4>üü¢ Rotterdam Criteria (2003) - Most Used</h4>
                                <p><strong>Requires 2 of 3, excluding other disorders:</strong></p>
                                <ul class="criteria-list">
                                    <li>Hyperandrogenism (clinical and/or biochemical)</li>
                                    <li>Oligo-/anovulation</li>
                                    <li>Polycystic ovaries on ultrasound</li>
                                </ul>
                                <span class="badge badge-success">Diagnosis of exclusion</span>
                            </div>

                            <div class="criteria-box">
                                <h4>üî¥ NIH Criteria (1990) - More Restrictive</h4>
                                <p><strong>Requires ALL 3:</strong></p>
                                <ul class="criteria-list">
                                    <li>Hyperandrogenism and/or hyperandrogenemia</li>
                                    <li>Oligo- or anovulation</li>
                                    <li>Exclusion of other disorders</li>
                                </ul>
                                <span class="badge badge-warning">Excludes ovulatory PCOS</span>
                            </div>

                            <div class="criteria-box">
                                <h4>üü° Androgen Excess Society (2006)</h4>
                                <p><strong>Requires ALL 3:</strong></p>
                                <ul class="criteria-list">
                                    <li>Hyperandrogenism (hirsutism) and/or hyperandrogenemia</li>
                                    <li>Ovarian dysfunction (oligo-anovulation and/or PCO morphology)</li>
                                    <li>Exclusion of other androgen excess disorders</li>
                                </ul>
                                <span class="badge badge-info">Emphasizes androgen excess</span>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Differential Diagnosis <span class="badge badge-danger">Exclude These</span></h3>
                            <div class="complication-grid">
                                <div class="complication-card high-risk">
                                    <strong>21-Hydroxylase Deficiency</strong>
                                    <div class="drug-dose">17-OHP &gt;24 nmol/L rules in; 6-24 nmol/L needs ACTH stimulation</div>
                                    <span class="badge badge-danger">Indicated by: Rapid virilization, ethnic risk</span>
                                </div>
                                <div class="complication-card">
                                    <strong>Thyroid Dysfunction</strong>
                                    <div class="drug-dose">TSH abnormal, no hyperandrogenism</div>
                                    <span class="badge badge-success">TSH screening required</span>
                                </div>
                                <div class="complication-card">
                                    <strong>Hyperprolactinemia</strong>
                                    <div class="drug-dose">Prolactin elevated, may have mild hyperandrogenism</div>
                                    <span class="badge badge-success">Prolactin screening required</span>
                                </div>
                                <div class="complication-card high-risk">
                                    <strong>Cushing's Syndrome</strong>
                                    <div class="drug-dose">24h urinary free cortisol, dexamethasone suppression test</div>
                                    <span class="badge badge-danger">Moon facies, central obesity, hypertension</span>
                                </div>
                                <div class="complication-card high-risk">
                                    <strong>Androgen-Secreting Tumors</strong>
                                    <div class="drug-dose">Testosterone &gt;6.9 nmol/L warrants ultrasound; DHEAS &gt;7000 ng/mL needs CT</div>
                                    <span class="badge badge-danger">Rapid onset virilization, clitoromegaly</span>
                                </div>
                                <div class="complication-card">
                                    <strong>Severe Insulin Resistance Syndromes</strong>
                                    <div class="drug-dose">Fasting insulin &gt;556 pmol/L or peak &gt;2084 pmol/L</div>
                                    <span class="badge badge-warning">HAIR-AN syndrome</span>
                                </div>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Diagnostic Algorithm <span class="badge badge-info">Stepwise Approach</span></h3>
                            <div class="algorithm-path">
                                <div>
                                    <strong>1. Hirsutism Present?</strong>
                                    <span class="badge badge-success">Yes ‚Üí Check cycles</span>
                                </div>
                                <div class="arrow">‚ûî</div>
                                <div>
                                    <strong>2. Irregular/Infrequent Menses?</strong>
                                    <span class="badge badge-success">Yes ‚Üí Diagnose PCOS*</span>
                                    <span class="badge badge-warning">No ‚Üí Check ovulation</span>
                                </div>
                                <div class="arrow">‚ûî</div>
                                <div>
                                    <strong>3. Anovulation Confirmed?</strong>
                                    <span class="badge badge-success">Yes ‚Üí Diagnose PCOS*</span>
                                    <span class="badge badge-warning">No ‚Üí Ultrasound/AMH</span>
                                </div>
                                <div class="arrow">‚ûî</div>
                                <div>
                                    <strong>4. PCO Morphology?</strong>
                                    <span class="badge badge-success">Yes ‚Üí Diagnose PCOS*</span>
                                </div>
                            </div>
                            <p style="font-size: 0.9em; color: var(--gray); margin-top: 15px;">
                                *After excluding other disorders with TSH, prolactin, 17-OHP
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Treatment Section -->
            <div class="step-card treatment" id="treatment">
                <div class="card-header" onclick="toggleSection('treatment')">
                    <div class="card-title">
                        <div class="card-icon">üíä</div>
                        <h2>Treatment</h2>
                    </div>
                    <span class="expand-icon">‚ñº</span>
                </div>
                <div class="card-content">
                    <div class="content-inner">
                        <div class="section">
                            <h3>Treatment Approach <span class="badge badge-info">Goal-Oriented</span></h3>
                            <p>Therapy focused on patient's primary goals: fertility, hyperandrogenism, or menstrual irregularity. <strong>Lifestyle management recommended for ALL.</strong></p>
                            
                            <div class="sub-section stable">
                                <h4>üü¢ Lifestyle Management (First-line for ALL)</h4>
                                <ul style="margin-left: 20px;">
                                    <li><strong>Healthy diet:</strong> Caloric restriction most important</li>
                                    <li><strong>Physical activity:</strong> Regular exercise</li>
                                    <li><strong>Weight loss:</strong> 5-7% can restore ovulation in 80% of overweight women</li>
                                    <li><strong>Benefits:</strong> Improves metabolic health, fertility outcomes, pregnancy health</li>
                                </ul>
                                <span class="badge badge-success">No pharmacological side effects</span>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Infertility Management <span class="badge badge-warning">Fertility Desired</span></h3>
                            
                            <div class="algorithm-path">
                                <div>
                                    <strong>1st Line</strong>
                                    <span class="badge badge-success">Weight Loss</span>
                                    <span class="badge badge-success">Letrozole</span>
                                    <span class="badge badge-warning">Clomifene</span>
                                </div>
                                <div class="arrow">‚ûî</div>
                                <div>
                                    <strong>2nd Line</strong>
                                    <span class="badge badge-warning">Gonadotrophins</span>
                                </div>
                                <div class="arrow">‚ûî</div>
                                <div>
                                    <strong>3rd Line</strong>
                                    <span class="badge badge-danger">IVF</span>
                                    <span class="badge badge-warning">Laparoscopic Drilling</span>
                                </div>
                            </div>

                            <div class="drug-card">
                                <div class="drug-name">Letrozole (Aromatase Inhibitor)</div>
                                <div class="drug-dose">2.5 mg orally once daily for 5 consecutive days; increase by 2.5 mg/day increments until ovulation; max 7.5 mg/day</div>
                                <span class="badge badge-success">First-line recommended</span>
                                <span class="badge badge-success">Superior to clomifene for live birth</span>
                                <span class="badge badge-warning">May be off-label in some countries</span>
                            </div>

                            <div class="drug-card">
                                <div class="drug-name">Clomifene (Anti-estrogen)</div>
                                <div class="drug-dose">50 mg orally once daily for 5 consecutive days; increase by 50 mg/day increments; max 150 mg/day</div>
                                <span class="badge badge-warning">Alternative first-line</span>
                                <span class="badge badge-danger">5-10% multiple pregnancy risk</span>
                                <span class="badge badge-warning">25% clomifene resistance</span>
                            </div>

                            <div class="drug-card">
                                <div class="drug-name">Metformin (Insulin Sensitizer)</div>
                                <div class="drug-dose">500 mg TID or 850-1000 mg BID (immediate-release); 1500-2000 mg daily (extended-release)</div>
                                <span class="badge badge-info">Adjunct to ovulation induction</span>
                                <span class="badge badge-success">Reduces multiple pregnancy risk</span>
                                <span class="badge badge-warning">May continue in pregnancy</span>
                            </div>

                            <div class="sub-section caution">
                                <strong>Gonadotrophins (FSH/hMG):</strong> Second-line, requires specialist monitoring
                                <div style="margin-top: 10px;">
                                    <span class="badge badge-danger">High multiple pregnancy risk (20-30% twins)</span>
                                    <span class="badge badge-danger">OHSS risk - requires careful monitoring</span>
                                </div>
                            </div>

                            <div class="sub-section caution">
                                <strong>IVF / Laparoscopic Ovarian Drilling:</strong> Third-line options
                                <div style="margin-top: 10px;">
                                    <span class="badge badge-warning">IVF: High OHSS risk but good pregnancy rates</span>
                                    <span class="badge badge-warning">Drilling: No OHSS/multiples, risk of adhesions</span>
                                </div>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Non-Fertility Management <span class="badge badge-info">No Immediate Pregnancy Desired</span></h3>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                                <div class="sub-section">
                                    <h4>Hyperandrogenism (Hirsutism/Acne)</h4>
                                    <div class="drug-card">
                                        <div class="drug-name">Oral Contraceptive Pills</div>
                                        <div class="drug-dose">Cyclic estrogen + progestin (avoid androgenic progestins)</div>
                                        <span class="badge badge-success">First-line</span>
                                        <span class="badge badge-warning">6 months to see effect</span>
                                    </div>
                                    <div class="drug-card">
                                        <div class="drug-name">Anti-androgens</div>
                                        <div class="drug-dose">Spironolactone 50-100 mg BID; Finasteride 5 mg daily</div>
                                        <span class="badge badge-warning">Second-line</span>
                                        <span class="badge badge-danger">TERATOGENIC - Must use contraception</span>
                                    </div>
                                </div>

                                <div class="sub-section">
                                    <h4>Menstrual Irregularity</h4>
                                    <div class="drug-card">
                                        <div class="drug-name">Cyclic Progestin</div>
                                        <div class="drug-dose">Progesterone 200-400 mg or medroxyprogesterone 5-10 mg for 10 days/month</div>
                                        <span class="badge badge-success">Protects endometrium</span>
                                        <span class="badge badge-info">If OCPs contraindicated</span>
                                    </div>
                                    <div class="drug-card">
                                        <div class="drug-name">Metformin</div>
                                        <div class="drug-dose">Same doses as above</div>
                                        <span class="badge badge-info">May improve cycles</span>
                                        <span class="badge badge-success">Metabolic benefits</span>
                                    </div>
                                </div>
                            </div>

                            <div class="sub-section caution">
                                <h4>Refractory Cases</h4>
                                <p><strong>Long-acting GnRH analogue + estrogen/progestin:</strong> For severe hyperandrogenism</p>
                                <span class="badge badge-danger">Risk of bone loss without estrogen</span>
                                <span class="badge badge-warning">Specialist supervision required</span>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Adjunctive Therapies <span class="badge badge-info">Symptom Control</span></h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                                <div class="drug-card">
                                    <div class="drug-name">Eflornithine Topical</div>
                                    <div class="drug-dose">13.9% cream applied twice daily</div>
                                    <span class="badge badge-success">Facial hirsutism</span>
                                    <span class="badge badge-warning">20-40% response by 8 weeks</span>
                                </div>
                                <div class="drug-card">
                                    <div class="drug-name">Minoxidil Topical</div>
                                    <div class="drug-dose">2-5% solution to scalp twice daily</div>
                                    <span class="badge badge-success">Androgenic alopecia</span>
                                    <span class="badge badge-warning">Requires months of use</span>
                                </div>
                                <div class="drug-card">
                                    <div class="drug-name">Mechanical Hair Removal</div>
                                    <div class="drug-dose">Electrolysis, laser (after ‚â•6 months hormonal therapy)</div>
                                    <span class="badge badge-info">Destroys terminal follicles</span>
                                </div>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Emerging Therapies <span class="badge badge-warning">Experimental</span></h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                                <span class="badge badge-info">GLP-1 Receptor Agonists</span>
                                <span class="badge badge-info">Statins</span>
                                <span class="badge badge-info">Alpha-glucosidase Inhibitors</span>
                                <span class="badge badge-info">Bariatric Surgery</span>
                                <span class="badge badge-info">Inositols</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Follow-up Section -->
            <div class="step-card followup" id="followup">
                <div class="card-header" onclick="toggleSection('followup')">
                    <div class="card-title">
                        <div class="card-icon">üìà</div>
                        <h2>Follow-up & Complications</h2>
                    </div>
                    <span class="expand-icon">‚ñº</span>
                </div>
                <div class="card-content">
                    <div class="content-inner">
                        <div class="section">
                            <h3>Monitoring Schedule <span class="badge badge-info">Regular Assessment</span></h3>
                            <div class="algorithm-path">
                                <div>
                                    <strong>Every 3 months</strong>
                                    <span class="badge badge-warning">Treatment response</span>
                                    <span class="badge badge-warning">Adverse effects</span>
                                </div>
                                <div class="arrow">‚ûî</div>
                                <div>
                                    <strong>Every 6 months</strong>
                                    <span class="badge badge-success">Stable patients</span>
                                </div>
                                <div class="arrow">‚ûî</div>
                                <div>
                                    <strong>Annually</strong>
                                    <span class="badge badge-info">Metabolic screening</span>
                                    <span class="badge badge-info">CVD risk assessment</span>
                                </div>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Long-term Complications <span class="badge badge-danger">High Risk</span></h3>
                            
                            <div class="complication-grid">
                                <div class="complication-card high-risk">
                                    <h4>üî¥ Type 2 Diabetes</h4>
                                    <p><strong>3x increased risk</strong></p>
                                    <div class="drug-dose">20-40% of obese women have glucose intolerance by age 40</div>
                                    <span class="badge badge-danger">Screen with OGTT every 1-2 years</span>
                                    <span class="badge badge-warning">More frequent if impaired</span>
                                </div>

                                <div class="complication-card high-risk">
                                    <h4>üî¥ Cardiovascular Disease</h4>
                                    <p><strong>1.3x increased risk composite CVD</strong></p>
                                    <div class="drug-dose">Increased risk factors: obesity, dyslipidemia, hypertension, insulin resistance</div>
                                    <span class="badge badge-danger">Assess all CVD risk factors</span>
                                    <span class="badge badge-warning">Increased with age</span>
                                </div>

                                <div class="complication-card high-risk">
                                    <h4>üî¥ Metabolic Dysfunction-Associated Steatotic Liver Disease (MASLD)</h4>
                                    <p><strong>40-55% prevalence</strong></p>
                                    <div class="drug-dose">Independent of obesity; correlates with androgen levels</div>
                                    <span class="badge badge-danger">Screen high-risk patients</span>
                                </div>

                                <div class="complication-card">
                                    <h4>üü° Endometrial Hyperplasia/Cancer</h4>
                                    <p><strong>3x increased risk</strong></p>
                                    <div class="drug-dose">9% lifetime risk vs 3% in general population</div>
                                    <span class="badge badge-warning">Protect endometrium with progestins</span>
                                </div>

                                <div class="complication-card">
                                    <h4>üü° Psychological Disorders</h4>
                                    <p><strong>High prevalence</strong></p>
                                    <div class="drug-dose">Depression (3.8x), anxiety (5.6x), eating disorders (3.9x)</div>
                                    <span class="badge badge-warning">Screen all patients</span>
                                </div>

                                <div class="complication-card">
                                    <h4>üü° Obstructive Sleep Apnea</h4>
                                    <p><strong>20-45% prevalence</strong></p>
                                    <div class="drug-dose">Especially with obesity</div>
                                    <span class="badge badge-warning">Screen symptomatic patients</span>
                                </div>

                                <div class="complication-card">
                                    <h4>üü° Pregnancy Complications</h4>
                                    <p><strong>Increased risk</strong></p>
                                    <div class="drug-dose">Gestational diabetes, pregnancy-induced hypertension, pre-eclampsia, preterm delivery</div>
                                    <span class="badge badge-danger">Offer OGTT preconception and early pregnancy</span>
                                </div>

                                <div class="complication-card">
                                    <h4>üü° Metabolic Syndrome</h4>
                                    <p><strong>30% prevalence</strong></p>
                                    <div class="drug-dose">2-3x increased odds; worse with obesity</div>
                                    <span class="badge badge-warning">Lifestyle intervention critical</span>
                                </div>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Prognosis <span class="badge badge-info">Long-term Outlook</span></h3>
                            <div class="sub-section stable">
                                <h4>üü¢ Chronic but Manageable</h4>
                                <ul style="margin-left: 20px;">
                                    <li><strong>No cure:</strong> Symptoms recur if therapy stopped</li>
                                    <li><strong>Improvement with age:</strong> Hyperandrogenism may improve as ovarian function declines</li>
                                    <li><strong>Prevention key:</strong> Weight loss and metformin may prevent diabetes/CVD</li>
                                    <li><strong>Lifelong monitoring:</strong> Especially metabolic health</li>
                                </ul>
                            </div>
                        </div>

                        <div class="section">
                            <h3>Patient Education <span class="badge badge-success">Essential</span></h3>
                            <div class="sub-section">
                                <ul style="margin-left: 20px;">
                                    <li>Explain chronic nature and need for continued therapy</li>
                                    <li>Emphasize lifestyle modifications (diet, exercise)</li>
                                    <li>Discuss fertility options and timing</li>
                                    <li>Address psychological support needs</li>
                                    <li>Provide resources: PCOS societies, support groups</li>
                                    <li>Screen family members (20-40% risk in first-degree relatives)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 40px; padding: 20px; color: var(--gray);">
                <p>End of Algorithm | Always consult local guidelines and specialist opinion</p>
                <p style="font-size: 0.9em;">Based on BMJ Best Practice Polycystic Ovary Syndrome (Oct 16, 2025)</p>
            </div>
        </div>
    </div>

    <div class="floating-actions">
        <button class="fab fab-print" onclick="window.print()" title="Print View">üñ®Ô∏è</button>
        <button class="fab fab-reset" onclick="resetView()" title="Reset View">üîÑ</button>
    </div>

    <script>
        // State management
        const state = {
            expandedSections: JSON.parse(localStorage.getItem('pcosExpandedSections') || '[]'),
            currentSection: localStorage.getItem('pcosCurrentSection') || 'assessment',
            searchTerm: ''
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            restoreState();
            setupIntersectionObserver();
            setupSearch();
            addSmoothScrolling();
        });

        // Section toggle
        function toggleSection(sectionId) {
            const card = document.getElementById(sectionId);
            const isExpanded = card.classList.contains('expanded');
            
            if (isExpanded) {
                card.classList.remove('expanded');
                state.expandedSections = state.expandedSections.filter(id => id !== sectionId);
            } else {
                card.classList.add('expanded');
                if (!state.expandedSections.includes(sectionId)) {
                    state.expandedSections.push(sectionId);
                }
            }
            
            localStorage.setItem('pcosExpandedSections', JSON.stringify(state.expandedSections));
            
            // Add animation
            card.classList.add('fade-in');
            setTimeout(() => card.classList.remove('fade-in'), 500);
        }

        // Scroll to section
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                element.classList.add('highlight');
                setTimeout(() => element.classList.remove('highlight'), 2000);
            }
        }

        // Progress tracking
        function setupIntersectionObserver() {
            const observer = new IntersectionObserver(
                (entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const sectionId = entry.target.id;
                            state.currentSection = sectionId;
                            localStorage.setItem('pcosCurrentSection', sectionId);
                            updateProgressDots(sectionId);
                        }
                    });
                },
                { threshold: 0.3 }
            );

            document.querySelectorAll('.step-card').forEach(card => {
                observer.observe(card);
            });
        }

        function updateProgressDots(activeSectionId) {
            document.querySelectorAll('.progress-dot').forEach(dot => {
                dot.classList.remove('active');
                if (dot.getAttribute('onclick').includes(activeSectionId)) {
                    dot.classList.add('active');
                }
            });
        }

        // Search functionality
        function setupSearch() {
            // Add search bar
            const searchBar = document.createElement('div');
            searchBar.innerHTML = `
                <div style="position: sticky; top: 20px; margin-bottom: 30px; z-index: 50;">
                    <input type="text" 
                           id="searchInput" 
                           placeholder="Search algorithm (e.g., hirsutism, letrozole, diabetes)..." 
                           style="width: 100%; padding: 15px 20px; font-size: 16px; border: 2px solid var(--border); border-radius: 30px; outline: none; box-shadow: 0 3px 10px var(--shadow);">
                    <button onclick="clearSearch()" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; font-size: 20px; cursor: pointer; color: var(--gray);">‚úï</button>
                </div>
            `;
            document.querySelector('.main-content').insertBefore(searchBar.firstElementChild, document.querySelector('.header').nextSibling);

            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', handleSearch);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleSearch();
            });
        }

        function handleSearch() {
            const term = document.getElementById('searchInput').value.toLowerCase().trim();
            state.searchTerm = term;

            if (!term) {
                clearSearchHighlights();
                return;
            }

            clearSearchHighlights();
            
            const content = document.querySelector('.main-content');
            const elements = content.querySelectorAll('.drug-card, .sub-section, .criteria-box, .complication-card, p, li, h3, h4');
            let matchFound = false;

            elements.forEach(element => {
                const text = element.textContent.toLowerCase();
                if (text.includes(term)) {
                    element.classList.add('highlight');
                    matchFound = true;
                    
                    // Auto-expand parent section
                    const parentCard = element.closest('.step-card');
                    if (parentCard && !parentCard.classList.contains('expanded')) {
                        toggleSection(parentCard.id);
                    }
                }
            });

            if (matchFound) {
                const firstMatch = document.querySelector('.highlight');
                if (firstMatch) {
                    setTimeout(() => firstMatch.scrollIntoView({ behavior: 'smooth', block: 'center' }), 300);
                }
            }
        }

        function clearSearchHighlights() {
            document.querySelectorAll('.highlight').forEach(el => el.classList.remove('highlight'));
            document.getElementById('searchInput').value = '';
            state.searchTerm = '';
        }

        function clearSearch() {
            clearSearchHighlights();
            document.getElementById('searchInput').focus();
        }

        // Smooth scrolling
        function addSmoothScrolling() {
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });
        }

        // Reset view
        function resetView() {
            // Collapse all sections
            document.querySelectorAll('.step-card.expanded').forEach(card => {
                card.classList.remove('expanded');
            });
            
            // Clear search
            clearSearchHighlights();
            
            // Reset state
            state.expandedSections = [];
            state.currentSection = 'assessment';
            localStorage.setItem('pcosExpandedSections', JSON.stringify(state.expandedSections));
            localStorage.setItem('pcosCurrentSection', state.currentSection);
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Reset progress dots
            updateProgressDots('assessment');
            
            // Expand assessment section
            setTimeout(() => {
                document.getElementById('assessment').classList.add('expanded');
                state.expandedSections.push('assessment');
                localStorage.setItem('pcosExpandedSections', JSON.stringify(state.expandedSections));
            }, 500);
        }

        // Restore state from localStorage
        function restoreState() {
            // Expand previously expanded sections
            state.expandedSections.forEach(sectionId => {
                const card = document.getElementById(sectionId);
                if (card) {
                    card.classList.add('expanded');
                }
            });

            // Scroll to last viewed section
            if (state.currentSection) {
                updateProgressDots(state.currentSection);
                setTimeout(() => {
                    const element = document.getElementById(state.currentSection);
                    if (element) {
                        element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }, 500);
            }

            // If no saved state, expand assessment by default
            if (state.expandedSections.length === 0) {
                document.getElementById('assessment').classList.add('expanded');
                state.expandedSections.push('assessment');
                localStorage.setItem('pcosExpandedSections', JSON.stringify(state.expandedSections));
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + F to focus search
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                e.preventDefault();
                document.getElementById('searchInput').focus();
            }
            
            // Escape to clear search
            if (e.key === 'Escape') {
                clearSearch();
            }
            
            // Arrow keys to navigate sections
            const sections = ['assessment', 'diagnosis', 'treatment', 'followup'];
            const currentIndex = sections.indexOf(state.currentSection);
            
            if (e.key === 'ArrowDown' && currentIndex < sections.length - 1) {
                scrollToSection(sections[currentIndex + 1]);
            } else if (e.key === 'ArrowUp' && currentIndex > 0) {
                scrollToSection(sections[currentIndex + 1]);
            }
        });

        // Print optimization
        window.addEventListener('beforeprint', () => {
            document.querySelectorAll('.step-card').forEach(card => {
                card.classList.add('expanded');
            });
        });

        window.addEventListener('afterprint', () => {
            restoreState();
        });

        // Add visual feedback for interactions
        document.querySelectorAll('.card-header, .drug-card, .complication-card').forEach(element => {
            element.addEventListener('mouseenter', () => {
                element.style.transform = 'translateY(-2px)';
                element.style.transition = 'transform 0.2s ease';
            });
            
            element.addEventListener('mouseleave', () => {
                element.style.transform = 'translateY(0)';
            });
        });

        // Auto-save scroll position
        let scrollTimeout;
        window.addEventListener('scroll', () => {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                localStorage.setItem('pcosScrollPosition', window.pageYOffset);
            }, 100);
        });

        // Restore scroll position on load
        window.addEventListener('load', () => {
            const savedPosition = localStorage.getItem('pcosScrollPosition');
            if (savedPosition) {
                setTimeout(() => {
                    window.scrollTo(0, parseInt(savedPosition));
                }, 500);
            }
        });

        console.log('üéØ PCOS Management Algorithm loaded successfully!');
        console.log('üí° Keyboard shortcuts:');
        console.log('   ‚Ä¢ Ctrl/Cmd + F: Search');
        console.log('   ‚Ä¢ Escape: Clear search');
        console.log('   ‚Ä¢ Arrow keys: Navigate sections');
        console.log('   ‚Ä¢ Click progress dots: Jump to section');
    </script>
</body>
</html>