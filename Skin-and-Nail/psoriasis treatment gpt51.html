<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Psoriasis GP Quick Reference</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #ffffff;
      --text-main: #111827;
      --text-muted: #6b7280;
      --border-subtle: #e5e7eb;
      --chip-bg: #f3f4f6;
      --chip-border: #d1d5db;
      --shadow-soft: 0 10px 25px rgba(0, 0, 0, 0.05);

      /* Class colours */
      --c-emollients: #0891b2;
      --c-vitd: #2563eb;
      --c-steroids: #f97316;
      --c-coaltar: #7c3aed;
      --c-dithranol: #ec4899;
      --c-uvb: #22c55e;
      --c-puva: #eab308;
      --c-systemic: #ef4444;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text-main);
    }

    .app {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem 1.25rem 2rem;
    }

    header {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    header h1 {
      font-size: 1.4rem;
      margin: 0;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    header .subtitle {
      font-size: 0.82rem;
      color: var(--text-muted);
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 260px) minmax(0, 1fr);
      gap: 1rem;
      align-items: flex-start;
    }

    @media (max-width: 840px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .panel {
      background: #ffffff;
      border-radius: 0.75rem;
      border: 1px solid var(--border-subtle);
      padding: 0.75rem;
      box-shadow: var(--shadow-soft);
    }

    .panel-title {
      font-size: 0.85rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #374151;
    }

    /* Search bar & top controls */
    .top-controls {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }

    .search-row {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      align-items: center;
    }

    .search-input {
      flex: 1 1 200px;
      min-width: 0;
      position: relative;
    }

    .search-input input {
      width: 100%;
      padding: 0.4rem 0.6rem;
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      font-size: 0.85rem;
      padding-left: 2rem;
    }

    .search-input span.icon {
      position: absolute;
      left: 0.6rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .pill-row-label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
    }

    .pill {
      border-radius: 999px;
      border: 1px solid var(--chip-border);
      padding: 0.25rem 0.6rem;
      font-size: 0.75rem;
      background: var(--chip-bg);
      color: #374151;
      cursor: pointer;
      white-space: nowrap;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      transition: background 0.15s, color 0.15s, border-color 0.15s, transform 0.05s;
    }

    .pill span.dot {
      width: 0.5rem;
      height: 0.5rem;
      border-radius: 999px;
      background: currentColor;
    }

    .pill:hover {
      transform: translateY(-1px);
    }

    .pill.active {
      color: #ffffff;
      border-color: transparent;
    }

    .pill-class-emollients.active { background: var(--c-emollients); }
    .pill-class-vitd.active { background: var(--c-vitd); }
    .pill-class-steroids.active { background: var(--c-steroids); }
    .pill-class-coaltar.active { background: var(--c-coaltar); }
    .pill-class-dithranol.active { background: var(--c-dithranol); }
    .pill-class-uvb.active { background: var(--c-uvb); }
    .pill-class-puva.active { background: var(--c-puva); }
    .pill-class-systemic.active { background: var(--c-systemic); }

    .pill-scenario.active {
      background: #111827;
      color: #ffffff;
      border-color: #111827;
    }

    .pill-all {
      border-style: dashed;
    }

    /* Legend / cheat sheet */
    .legend {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.4rem;
      margin-top: 0.5rem;
    }

    @media (max-width: 480px) {
      .legend {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .legend-color {
      width: 0.6rem;
      height: 0.6rem;
      border-radius: 0.3rem;
    }

    .legend-emollients { background: var(--c-emollients); }
    .legend-vitd { background: var(--c-vitd); }
    .legend-steroids { background: var(--c-steroids); }
    .legend-coaltar { background: var(--c-coaltar); }
    .legend-dithranol { background: var(--c-dithranol); }
    .legend-uvb { background: var(--c-uvb); }
    .legend-puva { background: var(--c-puva); }
    .legend-systemic { background: var(--c-systemic); }

    /* Treatment cards */
    .results-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }

    .results-header-title {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .results-header-meta {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .card-list {
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }

    .card {
      border-radius: 0.75rem;
      border: 1px solid var(--border-subtle);
      padding: 0.6rem 0.75rem;
      background: #ffffff;
      position: relative;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(15, 23, 42, 0.04);
    }

    .card::before {
      content: "";
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 0.2rem;
      background: #e5e7eb;
    }

    .card-emollients::before { background: var(--c-emollients); }
    .card-vitd::before { background: var(--c-vitd); }
    .card-steroids::before { background: var(--c-steroids); }
    .card-coaltar::before { background: var(--c-coaltar); }
    .card-dithranol::before { background: var(--c-dithranol); }
    .card-uvb::before { background: var(--c-uvb); }
    .card-puva::before { background: var(--c-puva); }
    .card-systemic::before { background: var(--c-systemic); }

    .card-top-row {
      display: flex;
      justify-content: space-between;
      gap: 0.4rem;
      align-items: flex-start;
      margin-bottom: 0.25rem;
    }

    .card-title {
      font-size: 0.9rem;
      font-weight: 600;
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      align-items: center;
    }

    .card-class-label {
      font-size: 0.7rem;
      font-weight: 600;
      padding: 0.1rem 0.4rem;
      border-radius: 999px;
      color: #ffffff;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .card-class-emollients { background: var(--c-emollients); }
    .card-class-vitd { background: var(--c-vitd); }
    .card-class-steroids { background: var(--c-steroids); }
    .card-class-coaltar { background: var(--c-coaltar); }
    .card-class-dithranol { background: var(--c-dithranol); }
    .card-class-uvb { background: var(--c-uvb); }
    .card-class-puva { background: var(--c-puva); }
    .card-class-systemic { background: var(--c-systemic); }

    .card-line-label {
      font-size: 0.7rem;
      padding: 0.1rem 0.4rem;
      border-radius: 999px;
      background: #f3f4f6;
      color: #4b5563;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .card-body {
      font-size: 0.8rem;
      color: #374151;
      display: grid;
      grid-template-columns: minmax(0, 1.25fr) minmax(0, 1fr);
      column-gap: 0.8rem;
      row-gap: 0.25rem;
      margin-top: 0.2rem;
    }

    @media (max-width: 720px) {
      .card-body {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card-section-title {
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      margin-bottom: 0.1rem;
    }

    .card-section ul {
      margin: 0;
      padding-left: 1rem;
      list-style: disc;
    }

    .card-section li {
      margin-bottom: 0.12rem;
    }

    .card-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem;
      margin-top: 0.3rem;
    }

    .tag {
      font-size: 0.7rem;
      border-radius: 999px;
      padding: 0.12rem 0.35rem;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      color: #4b5563;
      white-space: nowrap;
    }

    .tag-highlight {
      background: #111827;
      color: #ffffff;
      border-color: #111827;
    }

    .empty-state {
      padding: 1.25rem;
      text-align: center;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .empty-state strong {
      display: block;
      margin-bottom: 0.25rem;
      color: #111827;
    }

    footer {
      margin-top: 1rem;
      font-size: 0.7rem;
      color: var(--text-muted);
      text-align: right;
    }
  </style>
</head>
<body>
<div class="app">
  <header>
    <h1>Psoriasis Treatment ‚Äì GP Rapid Reference</h1>
    <div class="subtitle">
      Designed for fast lookup by class / scenario. All info is contained in this page ‚Äì no network required.
    </div>
  </header>

  <div class="layout">
    <!-- LEFT: Filters & legend -->
    <aside class="panel">
      <div class="panel-title">Filters</div>
      <div class="top-controls">
        <div class="search-row">
          <div class="search-input">
            <span class="icon">üîç</span>
            <input id="searchInput" type="text" placeholder="Search (e.g. ‚Äòscalp‚Äô, ‚ÄòDovobet‚Äô, ‚Äòflexural‚Äô)‚Ä¶" />
          </div>
        </div>

        <div>
          <div class="pill-row-label">Treatment class</div>
          <div class="pill-row" id="classFilterRow">
            <button class="pill pill-all pill-class-all active" data-class="all">
              All classes
            </button>
            <button class="pill pill-class-emollients" data-class="emollients">
              <span class="dot"></span> Emollients
            </button>
            <button class="pill pill-class-vitd" data-class="vitd">
              <span class="dot"></span> Vit D analogues
            </button>
            <button class="pill pill-class-steroids" data-class="steroids">
              <span class="dot"></span> Topical steroids
            </button>
            <button class="pill pill-class-coaltar" data-class="coaltar">
              <span class="dot"></span> Coal tar
            </button>
            <button class="pill pill-class-dithranol" data-class="dithranol">
              <span class="dot"></span> Dithranol
            </button>
            <button class="pill pill-class-uvb" data-class="uvb">
              <span class="dot"></span> Narrowband UVB
            </button>
            <button class="pill pill-class-puva" data-class="puva">
              <span class="dot"></span> PUVA
            </button>
            <button class="pill pill-class-systemic" data-class="systemic">
              <span class="dot"></span> Systemic & biologics
            </button>
          </div>
        </div>

        <div>
          <div class="pill-row-label">Scenario / site</div>
          <div class="pill-row" id="scenarioFilterRow">
            <button class="pill pill-all pill-scenario active" data-scenario="all">
              All scenarios
            </button>
            <button class="pill pill-scenario" data-scenario="localised">
              Localised plaque
            </button>
            <button class="pill pill-scenario" data-scenario="scalp">
              Scalp
            </button>
            <button class="pill pill-scenario" data-scenario="flexural">
              Flexural / genital
            </button>
            <button class="pill pill-scenario" data-scenario="widespread">
              Widespread / guttate
            </button>
            <button class="pill pill-scenario" data-scenario="palmoplantar">
              Palmoplantar
            </button>
            <button class="pill pill-scenario" data-scenario="thick">
              Thick plaques (limbs / trunk)
            </button>
            <button class="pill pill-scenario" data-scenario="child">
              Child
            </button>
            <button class="pill pill-scenario" data-scenario="maintenance">
              Maintenance
            </button>
            <button class="pill pill-scenario" data-scenario="refer">
              When to refer
            </button>
          </div>
        </div>
      </div>

      <div class="panel-title" style="margin-top:0.75rem;">Colour legend</div>
      <div class="legend">
        <div class="legend-item">
          <span class="legend-color legend-emollients"></span> Emollients / moisturisers
        </div>
        <div class="legend-item">
          <span class="legend-color legend-vitd"></span> Vitamin D topicals
        </div>
        <div class="legend-item">
          <span class="legend-color legend-steroids"></span> Topical steroids
        </div>
        <div class="legend-item">
          <span class="legend-color legend-coaltar"></span> Coal tar
        </div>
        <div class="legend-item">
          <span class="legend-color legend-dithranol"></span> Dithranol
        </div>
        <div class="legend-item">
          <span class="legend-color legend-uvb"></span> Narrowband UVB
        </div>
        <div class="legend-item">
          <span class="legend-color legend-puva"></span> PUVA
        </div>
        <div class="legend-item">
          <span class="legend-color legend-systemic"></span> Systemic / biologics (refer)
        </div>
      </div>
    </aside>

    <!-- RIGHT: Results -->
    <main class="panel">
      <div class="results-header">
        <div class="results-header-title">Treatment options</div>
        <div class="results-header-meta" id="resultsMeta">Showing all treatments</div>
      </div>
      <div id="cardList" class="card-list"></div>
    </main>
  </div>

  <footer>
    Tip: use the class & scenario chips first, and the search box for specifics (e.g. ‚Äúsilkis‚Äù, ‚Äúpustulosis‚Äù).
  </footer>
</div>

<script>
  const treatments = [
    {
      id: "emollients-core",
      name: "Emollients / moisturisers",
      classKey: "emollients",
      line: "Core for all patients",
      brands: ["E45 lotion", "Diprobase", "Epaderm", "50/50 white soft paraffin/liquid paraffin"],
      scenarios: ["localised", "widespread", "scalp", "flexural", "palmoplantar", "thick", "child", "maintenance"],
      bestFor: [
        "Baseline for all psoriasis types",
        "Dry, itchy, cracked plaques",
        "Improving comfort and enhancing absorption of active treatments"
      ],
      how: [
        "Use at least twice daily; more often if possible",
        "Apply after washing with a soap substitute and before active therapy (allow ~30 minutes to absorb)",
        "Lighter lotions/creams AM; greasier ointments PM or when off work"
      ],
      pros: [
        "Symptom relief (dryness, itch, cracking)",
        "Enhances penetration of vitamin D, tars, steroids, dithranol",
        "Safe long-term, useful in children and during other modalities (UV, systemic, biologic)"
      ],
      cautions: [
        "Can make skin and bathroom surfaces slippery (warn re falls)",
        "Antimicrobial-containing products only if infection suspected",
        "Keratolytics (e.g. salicylic acid) ‚Äì avoid on broken or very inflamed skin"
      ]
    },
    {
      id: "vitd-mono",
      name: "Vitamin D analogues (monotherapy)",
      classKey: "vitd",
      line: "First-line topical",
      brands: ["Calcipotriol (Dovonex)", "Calcitriol (Silkis)"],
      scenarios: ["localised", "scalp", "widespread", "child", "maintenance"],
      bestFor: [
        "Mild‚Äìmoderate localised plaque psoriasis",
        "When steroid-sparing desired (face and flexures with caution ‚Äì calcitriol better tolerated)",
        "Maintenance after steroid course"
      ],
      how: [
        "Apply once or twice daily to plaques on well-moisturised skin",
        "If once daily, evening application often preferred for better contact time",
        "Review at 4 weeks (2 weeks in children)"
      ],
      pros: [
        "Good efficacy for many patients, steroid-sparing",
        "Anti-inflammatory and antiproliferative",
        "Useful in combination with intermittent steroids"
      ],
      cautions: [
        "Do not exceed recommended maximum weekly amount (hypercalcaemia risk theoretical)",
        "May increase photosensitivity ‚Äì check plan before starting phototherapy",
        "Avoid on very inflamed or broken skin"
      ]
    },
    {
      id: "vitd-steroid-combo",
      name: "Vit D + potent steroid combinations",
      classKey: "vitd",
      line: "First-line topical (often most effective)",
      brands: ["Calcipotriol + betamethasone: Dovobet (gel/ointment)", "Enstilar (foam)"],
      scenarios: ["localised", "scalp", "thick", "maintenance"],
      bestFor: [
        "Localised chronic plaque psoriasis on trunk/limbs",
        "Scalp psoriasis (gel or foam formulations)",
        "Patients needing rapid improvement with a simple regimen"
      ],
      how: [
        "Usually once daily to affected plaques for 4 weeks; then intermittent or step down to Vit D alone",
        "Apply to dry, well-moisturised skin (allow emollient to absorb first)",
        "Avoid face, flexures, genitals ‚Äì use milder options there"
      ],
      pros: [
        "High efficacy with convenient once-daily application",
        "Combines anti-inflammatory and antiproliferative effects",
        "Useful ‚Äòtrial‚Äô of topical response before considering referral"
      ],
      cautions: [
        "Potent steroid component ‚Äì limit duration and area, avoid occlusion",
        "Risk of skin atrophy, striae, rebound if overused",
        "Check for correct use and limit repeated long courses"
      ]
    },
    {
      id: "steroids-general",
      name: "Topical corticosteroids (general)",
      classKey: "steroids",
      line: "First-line topical",
      brands: [
        "Very potent: Dermovate, Nerisone Forte, Etrivex (scalp)",
        "Potent: Betnovate, Elocon, Diprosalic, Fucibet, Bettamousse",
        "Moderate: Eumovate, Alphaderm, Trimovate",
        "Mild: Hydrocortisone 0.1‚Äì2.5%, Eurax HC, Daktacort"
      ],
      scenarios: ["localised", "scalp", "flexural", "child"],
      bestFor: [
        "Localised plaque psoriasis not controlled by emollients and Vit D alone",
        "Short courses on sensitive areas using mild‚Äìmoderate potency",
        "Scalp psoriasis (foams/gels/mousses)"
      ],
      how: [
        "Apply thinly once or twice daily depending on product; usually for up to 4 weeks (2 weeks on face/flexures/children)",
        "Choose potency and formulation based on site (milder for face/flexures, more potent for thick plaques or scalp)",
        "Consider weekend-only maintenance in recurrent localised disease"
      ],
      pros: [
        "Rapid symptom relief (itch, erythema, scaling)",
        "Wide range of strengths and vehicles for different sites",
        "Can be combined with Vit D or tar preparations"
      ],
      cautions: [
        "Skin atrophy, telangiectasia, striae, steroid rosacea, perioral dermatitis with prolonged use",
        "Avoid long-term use of potent/very potent steroids on face, genitals, flexures",
        "Systemic absorption rare but possible with large areas, occlusion, or in children ‚Äì limit duration and total dose"
      ]
    },
    {
      id: "steroids-sensitive",
      name: "Mild / moderate steroids for sensitive areas",
      classKey: "steroids",
      line: "First-line for sensitive sites",
      brands: ["Hydrocortisone 1‚Äì2.5%", "Eumovate", "Trimovate (with antimicrobials)"],
      scenarios: ["flexural", "child", "localised"],
      bestFor: [
        "Face, flexural and genital psoriasis",
        "Short-term rescue for flares on sensitive sites",
        "Paediatric psoriasis on face/flexures"
      ],
      how: [
        "Use once daily if possible, usually for up to 1‚Äì2 weeks then stop or switch to non-steroid maintenance",
        "Combine with emollients; consider adding Vit D analogue suitable for sensitive sites (e.g. calcitriol) for maintenance",
        "Reassess quickly if poor response ‚Äì consider misdiagnosis or superadded infection"
      ],
      pros: [
        "Faster control on delicate skin than non-steroidal options alone",
        "Well tolerated short-term",
        "Simple for patients to understand"
      ],
      cautions: [
        "Very high risk of atrophy and striae with prolonged use even at mild potency",
        "Consider steroid-sparing strategies (Vit D, calcineurin inhibitors ‚Äì dermatologist) if repeated courses needed",
        "Avoid chronic daily use ‚Äì plan a clear stop/review date"
      ]
    },
    {
      id: "coaltar-scalp",
      name: "Coal tar ‚Äì scalp & plaque",
      classKey: "coaltar",
      line: "Adjunct or second-line topical",
      brands: ["Various coal tar shampoos, lotions, creams, bath additives"],
      scenarios: ["scalp", "localised", "maintenance"],
      bestFor: [
        "Scalp psoriasis (shampoos and leave-on lotions)",
        "Mild‚Äìmoderate plaque psoriasis where patient accepts smell/mess",
        "Longer-term maintenance where steroids undesirable"
      ],
      how: [
        "For scalp: massage shampoo into scalp, leave for recommended contact time, then rinse; combine with leave-on agents",
        "For plaques: apply tar cream/ointment to plaques once or twice daily as directed",
        "Often used after other topicals have been tried, or as a step-down"
      ],
      pros: [
        "Long history of use; relatively safe for long-term use",
        "Anti-scaling and anti-inflammatory properties",
        "Can reduce steroid requirement"
      ],
      cautions: [
        "Can irritate inflamed or broken skin ‚Äì avoid use there",
        "Smell, mess, staining of clothes and bedding; may reduce adherence",
        "Photosensitivity ‚Äì advise avoiding unnecessary sunbeds and excessive sun"
      ]
    },
    {
      id: "dithranol-plaques",
      name: "Dithranol (short-contact therapy)",
      classKey: "dithranol",
      line: "Second-line topical (special order)",
      brands: ["Special-order dithranol ointment (various strengths)"],
      scenarios: ["thick", "localised"],
      bestFor: [
        "Well-defined thick plaques on limbs/trunk in motivated patients",
        "When steroid-sparing approach for stubborn plaques is needed"
      ],
      how: [
        "Start with lowest strength; apply carefully to plaques only once daily for 10‚Äì60 minutes then wash off",
        "Increase strength or contact time gradually if tolerated, until clearance or irritation",
        "Continue daily until plaques are flat and feel like normal skin; often 4‚Äì6 weeks"
      ],
      pros: [
        "Effective for some patients with chronic thick plaques",
        "No significant long-term systemic side effects when used appropriately",
        "Useful in specialist-supervised regimens"
      ],
      cautions: [
        "Stains skin (temporary) and permanently stains fabrics/surfaces ‚Äì advise gloves and old/dark clothing",
        "Can irritate and burn non-psoriatic skin; apply precisely and consider barrier ointment around plaques",
        "Not suitable for face, genitals, flexures, guttate or pustular psoriasis"
      ]
    },
    {
      id: "uvb-narrowband",
      name: "Narrowband UVB (NB-UVB) phototherapy",
      classKey: "uvb",
      line: "Dermatology ‚Äì second line",
      brands: ["Hospital-based TL-01 narrowband UVB units"],
      scenarios: ["widespread", "localised", "child"],
      bestFor: [
        "Widespread plaque psoriasis not controlled with topicals",
        "Guttate psoriasis",
        "Patients preferring non-systemic options with appropriate monitoring"
      ],
      how: [
        "Delivered in dermatology phototherapy unit, typically 2‚Äì3 times per week for up to 10 weeks",
        "Dose is individually calculated and gradually increased",
        "Often combined with emollients and sometimes selected topical agents"
      ],
      pros: [
        "Effective in many patients with extensive disease",
        "Non-systemic; remission can last months",
        "Children and adults can be treated with careful dosing"
      ],
      cautions: [
        "Cumulative UV exposure increases skin cancer risk ‚Äì lifetime treatment limits",
        "Erythema/burning can occur; report burns promptly",
        "Dryness and pruritus common ‚Äì liberal moisturisers needed"
      ]
    },
    {
      id: "puva",
      name: "PUVA (Psoralen + UVA) phototherapy",
      classKey: "puva",
      line: "Dermatology ‚Äì second / third line",
      brands: ["Psoralen (oral/topical/bath) + UVA in phototherapy unit"],
      scenarios: ["widespread", "palmoplantar", "thick"],
      bestFor: [
        "Moderate‚Äìsevere plaque psoriasis unresponsive to UVB and topicals",
        "Palmoplantar pustulosis or thick palmoplantar plaques",
        "Thicker plaques where deeper penetration is advantageous"
      ],
      how: [
        "Psoralen given orally, topically, or in bath, followed by UVA exposure in phototherapy unit",
        "Typically twice weekly for 5‚Äì8 weeks",
        "Eye protection during and for ~24 hours after oral psoralen"
      ],
      pros: [
        "Can be more effective than UVB for thick plaques / palmoplantar disease",
        "Non-systemic in the traditional sense (though psoralen is systemic when oral)"
      ],
      cautions: [
        "Higher long-term risk of skin cancer compared with UVB ‚Äì strict session limits",
        "Oral psoralen can cause nausea; photosensitivity of skin and eyes",
        "Requires strict adherence to eye protection and sun avoidance after treatment"
      ]
    },
    {
      id: "systemic-refer",
      name: "Systemic agents & biologics (refer)",
      classKey: "systemic",
      line: "Dermatology ‚Äì advanced",
      brands: [
        "Systemics: methotrexate, ciclosporin, acitretin, apremilast",
        "Biologics: TNF-Œ±, IL-17, IL-23 inhibitors (specialist-initiated)"
      ],
      scenarios: ["widespread", "thick", "palmoplantar", "flexural", "refer"],
      bestFor: [
        "Severe, extensive psoriasis (high BSA / PASI / DLQI)",
        "Failure/contraindication to adequate topical and phototherapy trials",
        "Psoriatic arthritis or major quality-of-life impact"
      ],
      how: [
        "Initiated and monitored by dermatology / rheumatology teams",
        "Often in conjunction with ongoing emollient and targeted topical therapy",
        "Requires baseline and ongoing bloods / safety monitoring"
      ],
      pros: [
        "High efficacy for moderate‚Äìsevere psoriasis",
        "Can significantly improve quality of life and joint disease",
        "Multiple options to tailor to comorbidities and patient preference"
      ],
      cautions: [
        "Immunosuppression, organ toxicity, teratogenicity depending on agent",
        "Vaccination and infection risk counselling required",
        "Follow local and national guidelines for eligibility and monitoring"
      ]
    }
  ];

  let activeClass = "all";
  let activeScenario = "all";
  let searchTerm = "";

  const cardListEl = document.getElementById("cardList");
  const resultsMetaEl = document.getElementById("resultsMeta");
  const searchInputEl = document.getElementById("searchInput");

  function renderCards() {
    const trimmedSearch = searchTerm.trim().toLowerCase();

    const filtered = treatments.filter(t => {
      if (activeClass !== "all" && t.classKey !== activeClass) return false;
      if (activeScenario !== "all" && !t.scenarios.includes(activeScenario)) return false;

      if (!trimmedSearch) return true;

      const haystack = [
        t.name,
        t.classKey,
        t.line,
        ...(t.brands || []),
        ...(t.bestFor || []),
        ...(t.how || []),
        ...(t.pros || []),
        ...(t.cautions || []),
        ...(t.scenarios || [])
      ]
        .join(" ")
        .toLowerCase();

      return haystack.includes(trimmedSearch);
    });

    cardListEl.innerHTML = "";

    if (!filtered.length) {
      const scenLabel =
        activeScenario === "all"
          ? "any scenario"
          : activeScenario.replace(/^[a-z]/, c => c.toUpperCase());
      const classLabel =
        activeClass === "all"
          ? "any class"
          : activeClass.replace(/^[a-z]/, c => c.toUpperCase());

      resultsMetaEl.textContent = "No matches ‚Äì adjust filters or clear search.";

      const empty = document.createElement("div");
      empty.className = "empty-state";
      empty.innerHTML =
        "<strong>No treatments match your current filters.</strong>" +
        `<div>Class: <b>${classLabel}</b>; Scenario: <b>${scenLabel}</b>${trimmedSearch ? "; Search: <b>" + trimmedSearch + "</b>" : ""}.</div>` +
        "<div>Try clearing the search box or switching to ‚ÄúAll classes / All scenarios‚Äù.</div>";
      cardListEl.appendChild(empty);
      return;
    }

    const classLabel =
      activeClass === "all"
        ? "all classes"
        : treatments.find(t => t.classKey === activeClass)?.name.split(" ‚Äì ")[0] || activeClass;

    const scenLabel =
      activeScenario === "all"
        ? "all scenarios"
        : activeScenario.replace(/^[a-z]/, c => c.toUpperCase());

    resultsMetaEl.textContent = `Showing ${filtered.length} treatment${filtered.length > 1 ? "s" : ""} ¬∑ ${classLabel} ¬∑ ${scenLabel}${trimmedSearch ? " ¬∑ search: ‚Äú" + trimmedSearch + "‚Äù" : ""}`;

    filtered.forEach(t => {
      const card = document.createElement("article");
      card.className = `card card-${t.classKey}`;

      const topRow = document.createElement("div");
      topRow.className = "card-top-row";

      const titleEl = document.createElement("div");
      titleEl.className = "card-title";
      const titleText = document.createElement("span");
      titleText.textContent = t.name;
      titleEl.appendChild(titleText);

      const classLabelSpan = document.createElement("span");
      classLabelSpan.className = `card-class-label card-class-${t.classKey}`;
      classLabelSpan.textContent = t.classKey.toUpperCase();
      titleEl.appendChild(classLabelSpan);

      topRow.appendChild(titleEl);

      const lineLabel = document.createElement("span");
      lineLabel.className = "card-line-label";
      lineLabel.textContent = t.line;
      topRow.appendChild(lineLabel);

      card.appendChild(topRow);

      const body = document.createElement("div");
      body.className = "card-body";

      const leftSection = document.createElement("div");
      leftSection.className = "card-section";

      const bfTitle = document.createElement("div");
      bfTitle.className = "card-section-title";
      bfTitle.textContent = "Best for";
      leftSection.appendChild(bfTitle);

      const bfList = document.createElement("ul");
      (t.bestFor || []).forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        bfList.appendChild(li);
      });
      leftSection.appendChild(bfList);

      const howTitle = document.createElement("div");
      howTitle.className = "card-section-title";
      howTitle.style.marginTop = "0.25rem";
      howTitle.textContent = "How to use";
      leftSection.appendChild(howTitle);

      const howList = document.createElement("ul");
      (t.how || []).forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        howList.appendChild(li);
      });
      leftSection.appendChild(howList);

      const rightSection = document.createElement("div");
      rightSection.className = "card-section";

      if (t.brands && t.brands.length) {
        const brandsTitle = document.createElement("div");
        brandsTitle.className = "card-section-title";
        brandsTitle.textContent = "Examples / brands";
        rightSection.appendChild(brandsTitle);

        const brandsList = document.createElement("ul");
        t.brands.forEach(b => {
          const li = document.createElement("li");
          li.textContent = b;
          brandsList.appendChild(li);
        });
        rightSection.appendChild(brandsList);
      }

      const prosTitle = document.createElement("div");
      prosTitle.className = "card-section-title";
      prosTitle.style.marginTop = "0.25rem";
      prosTitle.textContent = "Pros";
      rightSection.appendChild(prosTitle);

      const prosList = document.createElement("ul");
      (t.pros || []).forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        prosList.appendChild(li);
      });
      rightSection.appendChild(prosList);

      const cautTitle = document.createElement("div");
      cautTitle.className = "card-section-title";
      cautTitle.style.marginTop = "0.25rem";
      cautTitle.textContent = "Cautions";
      rightSection.appendChild(cautTitle);

      const cautList = document.createElement("ul");
      (t.cautions || []).forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        cautList.appendChild(li);
      });
      rightSection.appendChild(cautList);

      body.appendChild(leftSection);
      body.appendChild(rightSection);

      card.appendChild(body);

      const tagsRow = document.createElement("div");
      tagsRow.className = "card-tags";

      t.scenarios.forEach(s => {
        const tag = document.createElement("span");
        tag.className = "tag";
        if (activeScenario !== "all" && s === activeScenario) {
          tag.classList.add("tag-highlight");
        }
        tag.textContent = scenarioLabel(s);
        tagsRow.appendChild(tag);
      });

      card.appendChild(tagsRow);

      cardListEl.appendChild(card);
    });
  }

  function scenarioLabel(key) {
    switch (key) {
      case "localised":
        return "Localised plaque";
      case "scalp":
        return "Scalp";
      case "flexural":
        return "Flexural / genital";
      case "widespread":
        return "Widespread / guttate";
      case "palmoplantar":
        return "Palmoplantar";
      case "thick":
        return "Thick plaques (limbs / trunk)";
      case "child":
        return "Child";
      case "maintenance":
        return "Maintenance";
      case "refer":
        return "Consider referral";
      default:
        return key;
    }
  }

  // Event handlers
  document.getElementById("classFilterRow").addEventListener("click", e => {
    const btn = e.target.closest("button[data-class]");
    if (!btn) return;
    activeClass = btn.getAttribute("data-class");

    document
      .querySelectorAll("#classFilterRow .pill")
      .forEach(el => el.classList.remove("active"));

    btn.classList.add("active");
    renderCards();
  });

  document.getElementById("scenarioFilterRow").addEventListener("click", e => {
    const btn = e.target.closest("button[data-scenario]");
    if (!btn) return;
    activeScenario = btn.getAttribute("data-scenario");

    document
      .querySelectorAll("#scenarioFilterRow .pill")
      .forEach(el => el.classList.remove("active"));

    btn.classList.add("active");
    renderCards();
  });

  searchInputEl.addEventListener("input", e => {
    searchTerm = e.target.value || "";
    renderCards();
  });

  // Keyboard quick clear (Esc)
  searchInputEl.addEventListener("keydown", e => {
    if (e.key === "Escape") {
      searchInputEl.value = "";
      searchTerm = "";
      renderCards();
      e.preventDefault();
    }
  });

  // Initial render
  renderCards();
</script>
</body>
</html>
