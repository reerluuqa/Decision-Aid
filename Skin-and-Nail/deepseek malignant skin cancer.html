<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malignant Skin Ulcer Management Algorithm</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --assessment-color: #3498db;
            --diagnosis-color: #9b59b6;
            --treatment-color: #2ecc71;
            --followup-color: #f39c12;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --success-color: #27ae60;
            --light-bg: #f8f9fa;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition-speed: 0.3s;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding-top: 20px;
            padding-bottom: 60px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            gap: 30px;
            position: relative;
        }
        
        .main-content {
            flex: 1;
        }
        
        /* Header Styles */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .header h1 {
            color: var(--primary-color);
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            max-width: 800px;
            margin: 0 auto;
            font-size: 1.1rem;
        }
        
        .last-updated {
            background-color: #e8f4fc;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #2c3e50;
        }
        
        /* Algorithm Progress Sidebar */
        .algorithm-sidebar {
            width: 280px;
            position: sticky;
            top: 20px;
            height: fit-content;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            display: none;
        }
        
        .sidebar-title {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .progress-steps {
            list-style: none;
        }
        
        .progress-step {
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all var(--transition-speed);
            border-left: 4px solid transparent;
        }
        
        .progress-step:hover {
            background-color: #f0f7ff;
        }
        
        .progress-step.active {
            background-color: #e8f4fc;
            border-left-color: var(--secondary-color);
            font-weight: 600;
        }
        
        .step-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        /* Card Styles */
        .algorithm-card {
            background-color: white;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
            transition: transform var(--transition-speed);
        }
        
        .algorithm-card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            padding: 20px 25px;
            display: flex;
            align-items: center;
            color: white;
            cursor: pointer;
        }
        
        .card-header i {
            font-size: 1.5rem;
            margin-right: 15px;
        }
        
        .card-header h2 {
            font-size: 1.6rem;
            flex: 1;
        }
        
        .expand-icon {
            transition: transform var(--transition-speed);
        }
        
        .card-header.expanded .expand-icon {
            transform: rotate(180deg);
        }
        
        .card-content {
            padding: 0 25px;
            max-height: 0;
            overflow: hidden;
            transition: max-height var(--transition-speed), padding var(--transition-speed);
        }
        
        .card-content.expanded {
            padding: 25px;
            max-height: 2000px;
        }
        
        /* Section-specific colors */
        .assessment-card .card-header {
            background-color: var(--assessment-color);
        }
        
        .diagnosis-card .card-header {
            background-color: var(--diagnosis-color);
        }
        
        .treatment-card .card-header {
            background-color: var(--treatment-color);
        }
        
        .followup-card .card-header {
            background-color: var(--followup-color);
        }
        
        .assessment-card .step-icon {
            background-color: var(--assessment-color);
        }
        
        .diagnosis-card .step-icon {
            background-color: var(--diagnosis-color);
        }
        
        .treatment-card .step-icon {
            background-color: var(--treatment-color);
        }
        
        .followup-card .step-icon {
            background-color: var(--followup-color);
        }
        
        /* Card Content Styles */
        .card-section {
            margin-bottom: 25px;
        }
        
        .card-section:last-child {
            margin-bottom: 0;
        }
        
        .card-section h3 {
            font-size: 1.3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
        }
        
        .card-section p {
            margin-bottom: 15px;
        }
        
        .card-section ul, .card-section ol {
            padding-left: 20px;
            margin-bottom: 15px;
        }
        
        .card-section li {
            margin-bottom: 8px;
        }
        
        /* Badge Styles */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        
        .badge-urgent {
            background-color: rgba(231, 76, 60, 0.15);
            color: var(--danger-color);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .badge-caution {
            background-color: rgba(243, 156, 18, 0.15);
            color: var(--warning-color);
            border: 1px solid rgba(243, 156, 18, 0.3);
        }
        
        .badge-stable {
            background-color: rgba(39, 174, 96, 0.15);
            color: var(--success-color);
            border: 1px solid rgba(39, 174, 96, 0.3);
        }
        
        /* Highlight Boxes */
        .highlight-box {
            background-color: #f8f9fa;
            border-left: 4px solid var(--secondary-color);
            padding: 18px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }
        
        .highlight-box h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        /* Clinical Score Box */
        .clinical-score {
            background-color: #e8f4fc;
            border: 2px dashed var(--secondary-color);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .clinical-score h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
        }
        
        .clinical-score h4 i {
            margin-right: 10px;
            color: var(--secondary-color);
        }
        
        .score-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(52, 152, 219, 0.2);
        }
        
        .score-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 12px 20px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all var(--transition-speed);
        }
        
        .action-btn i {
            margin-right: 8px;
        }
        
        .btn-primary {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-secondary {
            background-color: #ecf0f1;
            color: var(--primary-color);
        }
        
        .btn-secondary:hover {
            background-color: #d5dbdb;
        }
        
        /* Responsive Design */
        @media (min-width: 992px) {
            .algorithm-sidebar {
                display: block;
            }
        }
        
        @media (max-width: 991px) {
            .container {
                flex-direction: column;
            }
            
            .algorithm-sidebar {
                width: 100%;
                position: static;
                margin-bottom: 30px;
            }
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .card-header h2 {
                font-size: 1.4rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .action-btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* Print Styles */
        @media print {
            .algorithm-sidebar, .action-buttons {
                display: none;
            }
            
            .card-content {
                max-height: none !important;
                padding: 25px !important;
            }
        }
        
        .footer-note {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eaeaea;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-procedures"></i> Malignant Skin Ulcer Management</h1>
        <p>Interactive algorithm based on NICE CKS Palliative Care Guidelines (Last revised April 2025)</p>
        <div class="last-updated">
            <i class="fas fa-calendar-alt"></i> Last updated: April 2025
        </div>
    </div>
    
    <div class="container">
        <!-- Algorithm Progress Sidebar -->
        <aside class="algorithm-sidebar">
            <h3 class="sidebar-title">Algorithm Progress</h3>
            <ul class="progress-steps">
                <li class="progress-step active" data-target="assessment-card">
                    <div class="step-icon">1</div>
                    <span>Assessment</span>
                </li>
                <li class="progress-step" data-target="diagnosis-card">
                    <div class="step-icon">2</div>
                    <span>Diagnosis & Complications</span>
                </li>
                <li class="progress-step" data-target="treatment-card">
                    <div class="step-icon">3</div>
                    <span>Treatment & Management</span>
                </li>
                <li class="progress-step" data-target="followup-card">
                    <div class="step-icon">4</div>
                    <span>Follow-up & End-of-Life Care</span>
                </li>
            </ul>
            
            <div class="clinical-score" style="margin-top: 25px;">
                <h4><i class="fas fa-clipboard-check"></i> Key Clinical Points</h4>
                <div class="score-item">
                    <span>Target Audience:</span>
                    <span>Healthcare professionals (age 16+)</span>
                </div>
                <div class="score-item">
                    <span>Healing Expectation:</span>
                    <span>Unlikely - focus on QoL</span>
                </div>
                <div class="score-item">
                    <span>Key Specialist:</span>
                    <span>Wound management expert</span>
                </div>
            </div>
        </aside>
        
        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Assessment Card -->
            <section class="algorithm-card assessment-card" id="assessment-card">
                <div class="card-header">
                    <i class="fas fa-stethoscope"></i>
                    <h2>Assessment of Malignant Skin Ulcer</h2>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-section">
                        <h3>Initial Assessment</h3>
                        <p>Ensure a professional with expertise in wound management is involved (e.g., district nurse, palliative care or tissue viability nurse).</p>
                        
                        <div class="highlight-box">
                            <h4>Assessment Checklist</h4>
                            <ul>
                                <li><strong>Discuss with the person:</strong> Treatment priorities, concerns about the ulcer, and impact on daily functioning/quality of life</li>
                                <li><strong>Set realistic expectations:</strong> Explain that healing is unlikely; aim is to maintain or improve quality of life</li>
                                <li><strong>Assess the skin ulcer:</strong> Location, size, and type (ulcerative or proliferative)</li>
                                <li><strong>Evaluate necrotic tissue:</strong> Amount affects need for cleansing/debridement</li>
                                <li><strong>Check surrounding skin:</strong> Condition affects dressing choice and frequency of changes</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card-section">
                        <h3>Complication Screening</h3>
                        <p>Assess for the following complications:</p>
                        
                        <div class="action-buttons">
                            <span class="badge badge-urgent">Pain</span>
                            <span class="badge badge-caution">Bleeding</span>
                            <span class="badge badge-urgent">Infection</span>
                            <span class="badge badge-caution">Exudate</span>
                            <span class="badge badge-caution">Odour</span>
                            <span class="badge badge-stable">Itch</span>
                            <span class="badge badge-caution">Psychological Issues</span>
                        </div>
                        
                        <div class="clinical-score">
                            <h4><i class="fas fa-exclamation-triangle"></i> Referral Indicators</h4>
                            <div class="score-item">
                                <span>Oncology/Palliative Care Referral:</span>
                                <span class="badge badge-urgent">Urgent if present</span>
                            </div>
                            <p style="margin-top: 10px; font-size: 0.95rem;">Refer if complications require specialist management (e.g., vessel compression, airway obstruction, significant necrotic tissue for larval therapy) or if further cancer treatment may be possible (radiotherapy, chemotherapy, hormone therapy, surgery).</p>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="action-btn btn-primary" onclick="expandCard('diagnosis-card')">
                            <i class="fas fa-arrow-right"></i> Continue to Diagnosis
                        </button>
                        <button class="action-btn btn-secondary" onclick="printAlgorithm()">
                            <i class="fas fa-print"></i> Print Algorithm
                        </button>
                    </div>
                </div>
            </section>
            
            <!-- Diagnosis & Complications Card -->
            <section class="algorithm-card diagnosis-card" id="diagnosis-card">
                <div class="card-header">
                    <i class="fas fa-diagnoses"></i>
                    <h2>Diagnosis & Complications</h2>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-section">
                        <h3>What is a Malignant Skin Ulcer?</h3>
                        <p>A cavitating or proliferative primary or secondary cancer in the skin. Two processes can be involved:</p>
                        <ul>
                            <li><strong>Ulcerative process:</strong> Crater-like wound development</li>
                            <li><strong>Proliferative process:</strong> Nodular lesion development</li>
                        </ul>
                    </div>
                    
                    <div class="card-section">
                        <h3>Common Complications</h3>
                        
                        <div class="highlight-box">
                            <h4><span class="badge badge-urgent">Pain</span></h4>
                            <p>May depend on location, depth of tissue invasion, nerve involvement, local skin inflammation, and dressing changes. Can last an hour or more after dressing change.</p>
                        </div>
                        
                        <div class="highlight-box">
                            <h4><span class="badge badge-urgent">Infection</span></h4>
                            <p>Necrotic areas act as medium for anaerobic bacterial infection. Common organisms include coliforms, anaerobes, <em>Staphylococcus aureus</em>, and group G beta-haemolytic <em>Streptococcus</em>.</p>
                        </div>
                        
                        <div class="highlight-box">
                            <h4><span class="badge badge-caution">Bleeding</span></h4>
                            <p>Due to abnormal microcirculation within tumour, erosion/compression of blood vessels, decreased platelet function, or dressing removal.</p>
                        </div>
                        
                        <div class="highlight-box">
                            <h4><span class="badge badge-caution">Odour</span></h4>
                            <p>Occurs when tissue is deprived of oxygen and nutrients, becoming necrotic with bacterial growth. Can induce nausea, reduced appetite, weight loss, and lethargy.</p>
                        </div>
                        
                        <div class="highlight-box">
                            <h4><span class="badge badge-caution">Psychosocial Problems</span></h4>
                            <p>Psychological effects include depression, anxiety, low self-esteem, inhibited sexuality/intimacy. Bulky dressings affect self-image and mobility. Isolation may occur due to disfigurement and odour.</p>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="action-btn btn-primary" onclick="expandCard('treatment-card')">
                            <i class="fas fa-arrow-right"></i> Continue to Treatment
                        </button>
                        <button class="action-btn btn-secondary" onclick="expandCard('assessment-card')">
                            <i class="fas fa-arrow-left"></i> Back to Assessment
                        </button>
                    </div>
                </div>
            </section>
            
            <!-- Treatment & Management Card -->
            <section class="algorithm-card treatment-card" id="treatment-card">
                <div class="card-header">
                    <i class="fas fa-band-aid"></i>
                    <h2>Treatment & Management</h2>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-section">
                        <h3>Wound Cleansing & Debridement</h3>
                        
                        <div class="highlight-box">
                            <h4>Cleansing Protocol</h4>
                            <ul>
                                <li><strong>When:</strong> To remove visible debris, excess slough, exudate, or dressing material</li>
                                <li><strong>Before:</strong> Taking microbiological swab (only if clinical evidence of infection)</li>
                                <li><strong>Fluid:</strong> Warm tap/shower water (clean technique) or sterile 0.9% saline (sterile technique)</li>
                                <li><strong>Method:</strong> Gently irrigate using non-woven sterile swabs with no-touch technique</li>
                                <li><strong>Avoid:</strong> Scrubbing, cotton wool/gauze swabs, topical antiseptics</li>
                            </ul>
                        </div>
                        
                        <div class="highlight-box">
                            <h4>Debridement Options</h4>
                            <ul>
                                <li><strong>Natural (autolytic):</strong> Promoted by specialist dressings</li>
                                <li><strong>Sharp debridement:</strong> Not recommended (may cause bleeding)</li>
                                <li><strong>Mechanical debridement:</strong> Not recommended (may remove granulation tissue)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card-section">
                        <h3>Dressing Selection & Management</h3>
                        <p>Choice depends on ulcer type/site/size and presence of complications:</p>
                        
                        <div class="action-buttons">
                            <span class="badge badge-urgent">Pain at dressing changes</span>
                            <span class="badge badge-caution">Infection present</span>
                            <span class="badge badge-caution">Bleeding present</span>
                            <span class="badge badge-caution">Exudate management</span>
                            <span class="badge badge-caution">Odour control</span>
                        </div>
                        
                        <div class="clinical-score">
                            <h4><i class="fas fa-capsules"></i> Special Consideration: Topical Opioids</h4>
                            <p>For painful ulcerating wounds: With specialist advice, a mixture of diamorphine (or morphine) and hydrogel can produce a 0.1% w/w solution (1 mg diamorphine per 1 g hydrogel). Apply directly onto wound bed once daily or as needed.</p>
                        </div>
                    </div>
                    
                    <div class="card-section">
                        <h3>Managing Specific Complications</h3>
                        
                        <div class="highlight-box">
                            <h4><span class="badge badge-urgent">Infection Management</span></h4>
                            <p><strong>Diagnosis:</strong> Based on clinical symptoms/signs (fever, malaise, rigors, tachycardia, wound breakdown, cellulitis, increased pain/odour).</p>
                            <p><strong>Swab:</strong> Cleanse surface first, then take swab in 'zig zag' manner while rotating.</p>
                            <p><strong>Antibiotics:</strong> If indicated (see Cellulitis - acute CKS topic). Review choice once swab result available.</p>
                        </div>
                        
                        <div class="highlight-box">
                            <h4><span class="badge badge-caution">Odour Management</span></h4>
                            <p><strong>First-line:</strong> Appropriate dressings (activated charcoal, antimicrobial dressings)</p>
                            <p><strong>Topical metronidazole (0.75%):</strong> More effective with excess necrotic tissue. Apply liberally 1-2 times daily for 7 days.</p>
                            <p><strong>Oral metronidazole:</strong> 400 mg three times daily for 5-7 days for deep tissue infections.</p>
                            <p><strong>Long-term:</strong> If odour recurs after intermittent treatment, continue metronidazole long term (topically 1-2 times daily or orally 200 mg twice daily - off-label).</p>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="action-btn btn-primary" onclick="expandCard('followup-card')">
                            <i class="fas fa-arrow-right"></i> Continue to Follow-up
                        </button>
                        <button class="action-btn btn-secondary" onclick="expandCard('diagnosis-card')">
                            <i class="fas fa-arrow-left"></i> Back to Diagnosis
                        </button>
                    </div>
                </div>
            </section>
            
            <!-- Follow-up & End-of-Life Care Card -->
            <section class="algorithm-card followup-card" id="followup-card">
                <div class="card-header">
                    <i class="fas fa-hand-holding-heart"></i>
                    <h2>Follow-up & End-of-Life Care</h2>
                    <i class="fas fa-chevron-down expand-icon"></i>
                </div>
                <div class="card-content">
                    <div class="card-section">
                        <h3>Psychosocial Support</h3>
                        
                        <div class="highlight-box">
                            <h4>Key Support Strategies</h4>
                            <ul>
                                <li>Manage exudate and odour as effectively as possible (odour is often most distressing)</li>
                                <li>Aim for good cosmetic effect with dressings:
                                    <ul>
                                        <li>Use dressings to fill any defect (e.g., cavity in an ulcer)</li>
                                        <li>Ensure dressings protect clothing</li>
                                        <li>Use less bulky dressing material when going out</li>
                                    </ul>
                                </li>
                                <li>Address social, psychological, and spiritual aspects (see Palliative care - general issues CKS topic)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card-section">
                        <h3>End-of-Life Care Considerations</h3>
                        <p>It can be difficult to be certain that a person is dying, but it is essential to recognize the signs of dying to appropriately care for people at the end of life.</p>
                        
                        <div class="highlight-box">
                            <h4>End-of-Life Care Plan</h4>
                            <ul>
                                <li>Create an individualized care plan including symptom control and anticipatory prescribing</li>
                                <li>For severe bleeding at end of life:
                                    <ul>
                                        <li>Use dark towels to absorb blood to minimize distress</li>
                                        <li>Consider sedation with a benzodiazepine</li>
                                    </ul>
                                </li>
                                <li>Refer to Palliative care - general issues CKS topic for comprehensive guidance</li>
                            </ul>
                        </div>
                        
                        <div class="clinical-score">
                            <h4><i class="fas fa-user-md"></i> Metronidazole Prescribing Notes</h4>
                            <div class="score-item">
                                <span>Contraindications:</span>
                                <span class="badge badge-urgent">Nitroimidazole hypersensitivity</span>
                            </div>
                            <div class="score-item">
                                <span>Caution with:</span>
                                <span>CNS disease, severe liver disease, prolonged use</span>
                            </div>
                            <div class="score-item">
                                <span>Key Interactions:</span>
                                <span>Alcohol, warfarin, ciclosporin, lithium</span>
                            </div>
                            <div class="score-item">
                                <span>QT prolongation:</span>
                                <span class="badge badge-caution">Reported with concurrent QT-prolonging drugs</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="action-btn btn-primary" onclick="expandCard('assessment-card')">
                            <i class="fas fa-redo"></i> Restart Algorithm
                        </button>
                        <button class="action-btn btn-secondary" onclick="expandCard('treatment-card')">
                            <i class="fas fa-arrow-left"></i> Back to Treatment
                        </button>
                    </div>
                </div>
            </section>
            
            <div class="footer-note">
                <p><i class="fas fa-info-circle"></i> This algorithm is based on the NICE CKS topic "Palliative care - malignant skin ulcer" (Last revised April 2025).</p>
                <p>For complete guidelines, contraindications, and prescribing details, refer to the full CKS topic and BNF.</p>
            </div>
        </main>
    </div>

    <script>
        // Initialize the page with first card expanded
        document.addEventListener('DOMContentLoaded', function() {
            expandCard('assessment-card');
            updateProgressSidebar();
            
            // Add event listeners to all card headers
            document.querySelectorAll('.card-header').forEach(header => {
                header.addEventListener('click', function() {
                    const card = this.parentElement;
                    const content = card.querySelector('.card-content');
                    const expandIcon = this.querySelector('.expand-icon');
                    
                    // Close all other cards
                    document.querySelectorAll('.card-content').forEach(c => {
                        if (c !== content) {
                            c.classList.remove('expanded');
                            c.parentElement.querySelector('.card-header').classList.remove('expanded');
                        }
                    });
                    
                    // Toggle current card
                    content.classList.toggle('expanded');
                    this.classList.toggle('expanded');
                    
                    // Update progress sidebar
                    updateProgressSidebar();
                    
                    // Scroll to card if it's being expanded
                    if (content.classList.contains('expanded')) {
                        setTimeout(() => {
                            card.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }, 300);
                    }
                });
            });
            
            // Add event listeners to progress sidebar steps
            document.querySelectorAll('.progress-step').forEach(step => {
                step.addEventListener('click', function() {
                    const targetCardId = this.getAttribute('data-target');
                    expandCard(targetCardId);
                });
            });
            
            // Update progress sidebar on scroll
            window.addEventListener('scroll', updateProgressSidebar);
        });
        
        // Function to expand a specific card
        function expandCard(cardId) {
            // Close all cards first
            document.querySelectorAll('.card-content').forEach(content => {
                content.classList.remove('expanded');
                content.parentElement.querySelector('.card-header').classList.remove('expanded');
            });
            
            // Expand the requested card
            const card = document.getElementById(cardId);
            const content = card.querySelector('.card-content');
            const header = card.querySelector('.card-header');
            
            content.classList.add('expanded');
            header.classList.add('expanded');
            
            // Update progress sidebar
            updateProgressSidebar();
            
            // Scroll to the card
            setTimeout(() => {
                card.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        }
        
        // Function to update the progress sidebar
        function updateProgressSidebar() {
            const cards = document.querySelectorAll('.algorithm-card');
            const progressSteps = document.querySelectorAll('.progress-step');
            
            // Remove active class from all steps
            progressSteps.forEach(step => step.classList.remove('active'));
            
            // Find the first expanded card
            let activeCardId = null;
            cards.forEach(card => {
                const content = card.querySelector('.card-content');
                if (content.classList.contains('expanded')) {
                    activeCardId = card.id;
                }
            });
            
            // If no card is expanded, default to first card
            if (!activeCardId) {
                activeCardId = 'assessment-card';
            }
            
            // Add active class to corresponding step
            const activeStep = document.querySelector(`.progress-step[data-target="${activeCardId}"]`);
            if (activeStep) {
                activeStep.classList.add('active');
            }
        }
        
        // Function to print the algorithm
        function printAlgorithm() {
            window.print();
        }
        
        // Function to simulate a clinical score calculation
        function calculateClinicalScore() {
            alert("Clinical score calculation would be implemented based on specific assessment parameters. In a full implementation, this would calculate based on user inputs.");
        }
    </script>
</body>
</html>